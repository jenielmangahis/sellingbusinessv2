"use strict";(function(){jQuery(document).ready(function(l){var e;return e=l('form[name="checkout"]'),l('form[name="checkout"]').attr("id","checkout").addClass("wc-checkout-add-ons-dropzone"),e.find(":input.select").each(function(e){var d,o;return o=l(this).closest(".form-row").hasClass("validate-required"),"function"==typeof(d=l(this)).select2&&d.select2({allowClear:!o,placeholder:l(this).attr("multiple")?wc_checkout_add_ons.select_placeholder_multi:wc_checkout_add_ons.select_placeholder_single}),l().select2}),l(function(){return l("#wc_checkout_add_ons *").on("change",function(e){return l('input[type="file"]').each(function(e){if(l(this).val())return l(this).next().val("1")}),l("body").trigger("update_checkout")}),l("#wc_checkout_add_ons .wc-checkout-add-ons-input-file-plupload").each(function(e){var t,c,i,r,s,n,d,o,a;return n=l(this),t=n.find(".wc-checkout-add-ons-dropzone"),r=n.find(".wc-checkout-add-ons-preview"),s=n.find(".wc-checkout-add-ons-progress"),c=n.find(".wc-checkout-add-ons-feedback"),i=n.find('input[type="hidden"]'),d=n.parents(".form-row").prop("id"),o={url:wc_checkout_add_ons.ajax_url,multipart_params:{action:"wc_checkout_add_on_upload_file",security:wc_checkout_add_ons.upload_nonce,field:d},browse_button:t[0],drop_element:t[0],multi_selection:1<wc_checkout_add_ons.max_files,filters:{max_file_size:wc_checkout_add_ons.max_file_size,mime_types:wc_checkout_add_ons.mime_types}},(a=new plupload.Uploader(o)).init(),a.bind("Error",function(e,d){return c.html("\nError #"+d.code+": "+d.message).removeClass("hide"),s.addClass("hide")}),a.bind("FilesAdded",function(e,d){return c.html("").addClass("hide"),t.addClass("disabled"),s.removeClass("hide"),a.start()}),a.bind("UploadProgress",function(e,d){return s.find(".bar").css("width",d.percent+"%")}),a.bind("FileUploaded",function(e,d,o){var a;return(a=l.parseJSON(o.response)).errors?(c.html(a.errors.upload_error).removeClass("hide"),s.addClass("hide"),void t.removeClass("disabled")):(i.val(a.id).trigger("change"),r.removeClass("hide").find("a.file").prop("href",a.url).text(a.title),t.addClass("hide").removeClass("disabled"),s.addClass("hide").find(".bar").css("width",0),n.find(".moxie-shim").addClass("hide"))}),n.find("a.remove-file").on("click",function(e){return e.preventDefault(),r.addClass("hide"),t.removeClass("hide disabled"),l.ajax({type:"POST",url:wc_checkout_add_ons.ajax_url,data:{action:"wc_checkout_add_on_remove_file",security:wc_checkout_add_ons.remove_nonce,file:i.val()}}),i.val("").trigger("change"),n.find(".moxie-shim").removeClass("hide")})})})})}).call(void 0);