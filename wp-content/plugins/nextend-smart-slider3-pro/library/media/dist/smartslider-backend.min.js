(function(){var t=this;t.N2_=t.N2_||{r:[],d:[]},t.N2R=t.N2R||function(){t.N2_.r.push(arguments)},t.N2D=t.N2D||function(){t.N2_.d.push(arguments)}}).call(window),N2D("ContextMenu",function(t,e){function i(e,i){this.isActive=!1,this.$el=e.data("nextendcontextmenu",this),this.parameters=t.extend({selector:!1,onShow:function(){}},i),this.$menu=t('<div class="n2-context-menu"></div>').on("mousedown",function(){N2Classes.WindowManager.get().setMouseDownArea("context-menu")}).appendTo("body"),this.parameters.selector?this.$el.on("contextmenu",this.parameters.selector,t.proxy(this.onShowContextMenu,this)):this.$el.on("contextmenu",t.proxy(this.onShowContextMenu,this))}return i.prototype.onShowContextMenu=function(e){e.preventDefault(),this.clearItems(),this.parameters.onShow.call(this,e,this),this.hasItems&&(e.stopPropagation(),this.isActive=!0,this.$menu.css({left:e.pageX,top:e.pageY}),t("html").on("mouseleave.nextendcontextmenu, click.nextendcontextmenu",t.proxy(this.onHide,this))),this.$menu.toggleClass("n2-active",this.hasItems)},i.prototype.onHide=function(){t("html").off(".nextendcontextmenu"),this.$menu.removeClass("n2-active"),this.isActive=!1},i.prototype.clearItems=function(){this.isActive&&this.onHide(),this.hasItems=!1,this.$menu.html("")},i.prototype.addItem=function(e,i,n){this.hasItems=!0,this.$menu.append(t('<div><i class="n2-i '+i+'"></i><span>'+e+"</span></div>").on("click",n))},t.fn.nextendContextMenu=function(e){return this.each(function(){new i(t(this),e)})},i}),N2D("License",["EditorAbstract"],function(t,e){function i(e,i,s,o){this.addLicenseModal=!1,this.hasKey=e,this.maybeActive=i,this.ajaxUrl=s,this.buyLicenseUrl=o,this.boxAddLicense=t(".n2-box-add-license"),this.boxDeAuthorize=t(".n2-box-license-activated"),n=this}var n;return i.get=function(){return n},i.prototype._checkLicense=function(t,e){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"check",cacheAccepted:t+0,verbose:e+0}),dataType:"json"})},i.prototype.addLicense=function(e){if(e=e||0,this._deferred=t.Deferred(),!this.addLicenseModal){var i=this,n=!1,s={show:function(){n=!1,this.controls.find(".n2-button-grey").on("click",t.proxy(function(t){t.preventDefault(),i._deferred.resolve(),this.hide(t)},this));var e=this.controls.find(".n2-button-green"),s=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),e.trigger("click")});s.append(this.createInput(n2_("License key"),"license-key","width: 440px;")),s.append('<span style="font-size:12px;margin: 0 10px;">'+n2_printf("%sGet your license key here%s or %sbuy a new%s!",'<a href="https://secure.nextendweb.com/?utm_source=smartslider3-pro&utm_medium=smartslider&utm_campaign=forgot-license" target="_blank">',"</a>",'<a href="'+i.buyLicenseUrl+'" target="_blank">',"</a>")+"</span>");var o=t("#license-key").val("").focus();e.on("click",t.proxy(function(e){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(i.ajaxUrl,{nextendaction:"add"}),data:{licenseKey:o.val().replace(/\s/g,"")},dataType:"json"}).done(t.proxy(function(t){t.data.valid&&(i.boxAddLicense.addClass("n2-ss-license-has-active-key"),i.boxDeAuthorize.removeClass("n2-ss-license-no-active-key"),i.hasKey=!0,i.maybeActive=!0,n=!0,this.hide(e),i._deferred.resolve(),N2Classes.Notification.notice(n2_("Smart Slider 3 activated!")))},this))},this))},hide:function(){n||"pending"!=i._deferred.state()||i._deferred.reject()}};this.addLicenseModal=new N2Classes.NextendModal({zero:{size:[500,240],title:n2_("Add license"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Authorize")+"</a>"],fn:s},skippable:{size:[500,240],title:n2_("Add license"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-grey n2-uc n2-h4">'+n2_("Skip")+"</a>",'<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Authorize")+"</a>"],fn:s}})}return e?this.addLicenseModal.show("skippable"):this.addLicenseModal.show(),this._deferred},i.prototype.isActiveAsync=function(e){var i=t.Deferred(),n=t.proxy(function(){this.addLicense(e).done(function(){i.resolve()}).fail(function(){i.reject()})},this);return this.hasKey?this.maybeActive?i.resolve():this._checkLicense(!0,!1).done(function(){i.resolve()}).fail(function(){n()}):n(),i.fail(t.proxy(function(){this.maybeActive=!1},this)),i},i}),N2D("Zoom",function(t,e){function i(e){this.currentContainerWidth=0,this.devices={unknownUnknown:t("<div />")},this.responsives=[],this.add(e);var i=e.parameters.sliderWidthToDevice.desktopPortrait;this.container=e.containerElement.closest(".n2-ss-container-device,.n2-ss-canvas-slider-container").add(e.containerElement.closest(".n2-ss-slider-outer-container")),this.container.width(i),this.containerWidth=i,this.initZoom();var n=t("#n2-ss-devices .n2-tr"),s=e.parameters.deviceModes;this.devices.desktopPortrait=t('<div class="n2-td n2-panel-option" data-device="desktop" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-desktop"></i></div>').prependTo(n),s.desktopLandscape?this.devices.desktopLandscape=t('<div class="n2-td n2-panel-option" data-device="desktop" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-desktop-landscape"></i></div>').prependTo(n):this.devices.desktopLandscape=this.devices.desktopPortrait,s.tabletPortrait?this.devices.tabletPortrait=t('<div class="n2-td n2-panel-option" data-device="tablet" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-tablet"></i></div>').prependTo(n):this.devices.tabletPortrait=this.devices.desktopPortrait,s.tabletLandscape?this.devices.tabletLandscape=t('<div class="n2-td n2-panel-option" data-device="tablet" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-tablet-landscape"></i></div>').prependTo(n):this.devices.tabletLandscape=this.devices.desktopLandscape,s.mobilePortrait?this.devices.mobilePortrait=t('<div class="n2-td n2-panel-option" data-device="mobile" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-mobile"></i></div>').prependTo(n):this.devices.mobilePortrait=this.devices.tabletPortrait,s.mobileLandscape?this.devices.mobileLandscape=t('<div class="n2-td n2-panel-option" data-device="mobile" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-mobile-landscape"></i></div>').prependTo(n):this.devices.mobileLandscape=this.devices.tabletLandscape,this.deviceOptions=t("#n2-ss-devices .n2-panel-option"),this.deviceOptions.each(t.proxy(function(e,i){t(i).on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"zoomDeviceClicked"),click:t.proxy(this.setDeviceMode,this)})},this)),e.sliderElement.on("SliderDeviceOrientation",t.proxy(this.onDeviceOrientationChange,this))}var n=null;return i.add=function(t){n=new i(t),i.add=function(t){n.add(t)}},i.prototype.add=function(t){this.responsives.push(t),this.setOrientation("portrait"),t.parameters.onResizeEnabled=0,t.parameters.forceFull=0,t._getDevice=t._getDeviceZoom},i.prototype.onDeviceOrientationChange=function(e,i){t("#n2-admin").removeClass("n2-ss-mode-"+i.lastDevice+i.lastOrientation).addClass("n2-ss-mode-"+i.device+i.orientation),this.devices[i.lastDevice+i.lastOrientation].removeClass("n2-active"),this.devices[i.device+i.orientation].addClass("n2-active")},i.prototype.initZoom=function(){var e=t("#n2-ss-slider-zoom");e.length>0&&("undefined"!=typeof e[0].slide&&(e[0].slide=null),this.zoom=e.removeAttr("slide").prop("slide",!1).nUISlider({step:1,value:1,min:0,max:102}),this.$handle=e.data("nUISlider").handle,this.responsives[0].sliderElement.one("SliderResize",t.proxy(function(t){var e=this.responsives[0].containerElement.width();this.setContainerWidth(t,e,!0)},this)),this.zoom.on({"slide.n2-ss-zoom":t.proxy(this.zoomChange,this),"slidechange.n2-ss-zoom":t.proxy(this.zoomChange,this)}))},i.prototype.zoomChange=function(t,i){if(t.originalEvent!==e){var n,s=i.value,o=1;50>s?o=nextend.smallestZoom/this.containerWidth+Math.max(s/50,0)*(1-nextend.smallestZoom/this.containerWidth):s>52&&(o=1+(s-52)/50),n=parseInt(o*this.containerWidth),this.setContainerWidth(t,n)}},i.prototype.setContainerWidth=function(t,e,i){if(this.currentContainerWidth!=e){this.currentContainerWidth=e,this.$handle.html(e+"px"),this.container.width(e);for(var n=0;n<this.responsives.length;n++)this.responsives[n].doResize(t);if(i){var s=e/this.containerWidth,o=50;1>s?o=(s-nextend.smallestZoom/this.containerWidth)/(1-nextend.smallestZoom/this.containerWidth)*50:s>1&&(o=50*(s-1)+52),this.zoom.nUISlider("option","value",o)}}},i.prototype.setDeviceMode=function(e){var i=t(e.currentTarget);if((e.ctrlKey||e.metaKey)&&this.responsives[0].slider.editor.fragmentEditor){var n=i.data("orientation");this.responsives[0].slider.editor.fragmentEditor.copyOrResetMode(i.data("device")+n[0].toUpperCase()+n.substr(1))}else this.setOrientation(i.data("orientation")),this.setContainerWidth(e,this.getModeWidth(i.data("device")),!0)},i.prototype.getModeWidth=function(t){var e,i=this.responsives[0];e=i.orientationMode==N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_PORTRAIT?N2Classes.SmartSliderResponsive.DeviceOrientation.PORTRAIT:N2Classes.SmartSliderResponsive.DeviceOrientation.LANDSCAPE;var n=i.parameters.sliderWidthToDevice[t+N2Classes.SmartSliderResponsive._DeviceOrientation[e]];if("mobile"==t)switch(N2Classes.SmartSliderResponsive._DeviceOrientation[e]){case"Portrait":n=Math.max(nextend.smallestZoom,320)}return n},i.prototype.setOrientation=function(t){if("portrait"==t)for(var e=0;e<this.responsives.length;e++)this.responsives[e].orientationMode=N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_PORTRAIT;else for(var e=0;e<this.responsives.length;e++)this.responsives[e].orientationMode=N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_LANDSCAPE},i}),N2D("CreateSlider",function(t,e){function i(e,i,n){this.addToGroupModal=null,this.groupID=e,this.ajaxUrl=i,this.shouldSkipLicenseModal=n,t(".n2-ss-create-slider").click(t.proxy(function(e){e.preventDefault(),e.stopImmediatePropagation(),n?this.showModal():N2Classes.License.get().isActiveAsync(!0).done(t.proxy(this.showModal,this))},this)),this.notificationStack=new N2Classes.NotificationStackModal(t("body")),t(".n2-ss-add-sample-slider").click(t.proxy(function(e){e.preventDefault(),e.stopImmediatePropagation(),N2Classes.License.get().isActiveAsync().done(t.proxy(this.showDemoSliders,this))},this)),"createslider"==window.location.hash.substring(1)&&this.showModal()}return i.prototype.showModal=function(){if(!this.createSliderModal){var e=this,i=this.ajaxUrl,n=[];n.push({key:"default",name:n2_("Default"),image:"$ss$/admin/images/sliderpresets/default.png"}),n.push({key:"fullwidth",name:n2_("Full width"),image:"$ss$/admin/images/sliderpresets/fullwidth.png"}),n.push({key:"fullpage",name:n2_("Full page"),image:"$ss$/admin/images/sliderpresets/fullpage.png"}),n.push({key:"block",name:n2_("Block"),image:"$ss$/admin/images/sliderpresets/block.png"}),n.push({key:"carousel",name:n2_("Carousel"),image:"$ss$/admin/images/sliderpresets/carousel.png"}),n.push({key:"showcase",name:n2_("Showcase"),image:"$ss$/admin/images/sliderpresets/showcase.png"}),n.push({key:"thumbnailhorizontal",name:n2_("Thumbnail - horizontal"),image:"$ss$/admin/images/sliderpresets/thumbnailhorizontal.png"}),n.push({key:"thumbnailvertical",name:n2_("Thumbnail - vertical"),image:"$ss$/admin/images/sliderpresets/thumbnailvertical.png"}),n.push({key:"caption",name:n2_("Bar"),image:"$ss$/admin/images/sliderpresets/caption.png"}),n.push({key:"horizontalaccordion",name:n2_("Horizontal accordion"),image:"$ss$/admin/images/sliderpresets/horizontalaccordion.png"}),n.push({key:"verticalaccordion",name:n2_("Vertical accordion"),image:"$ss$/admin/images/sliderpresets/verticalaccordion.png"});var s=[750,630];this.createSliderModal=new N2Classes.NextendModal({zero:{size:s,title:n2_("Create Slider"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Create")+"</a>"],fn:{show:function(){var s=this.controls.find(".n2-button-green"),o=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),s.trigger("click")});o.append(this.createInput(n2_("Slider name"),"createslidertitle","width: 240px;")),o.append(this.createInputUnit(n2_("Width"),"createsliderwidth","px","width: 30px;")),o.append(this.createInputUnit(n2_("Height"),"createsliderheight","px","width: 30px;")),new N2Classes.FormElementAutocompleteSimple("createsliderwidth",["1920","1200","1000","800","600","400"]),new N2Classes.FormElementAutocompleteSimple("createsliderheight",["800","600","500","400","300","200"]);var r=t("#createslidertitle").val(n2_("Slider")).focus(),a=t("#createsliderwidth").val(1200),l=t("#createsliderheight").val(500);a.parent().addClass("n2-form-element-autocomplete"),l.parent().addClass("n2-form-element-autocomplete"),this.createHeading(n2_("Preset")).appendTo(this.content);var d=360,h=this.createImageRadio(n).css("height",d).appendTo(this.content),p=h.find("input");s.on("click",t.proxy(function(){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(i,{nextendaction:"create"}),data:{groupID:e.groupID,sliderTitle:r.val(),sliderSizeWidth:a.val(),sliderSizeHeight:l.val(),preset:p.val()},dataType:"json"}).done(t.proxy(function(t){N2Classes.AjaxHelper.startLoading()},this))},this))}}}})}this.createSliderModal.show()},i.prototype.showDemoSliders=function(){var e=this;t("body").css("overflow","hidden");var i=0;i=1;var n=t('<iframe src="//smartslider3.com/demo-import/?pro='+i+"&version="+N2SS3VERSION+"&utm_campaign="+N2SS3C+"&utm_source=import-slider-frame&utm_medium=smartslider-"+N2PLATFORM+"-"+(i?"pro":"free")+'" frameborder="0"></iframe>').css({position:"fixed",zIndex:1e5,left:0,top:0,width:"100%",height:"100%"}).appendTo("body"),s=function(){t("body").css("overflow",""),n.remove(),window.removeEventListener("message",r,!1),e.notificationStack.popStack()},o=function(t){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(e.ajaxUrl,{nextendaction:"importDemo"}),data:{groupID:e.groupID,key:N2Classes.Base64.encode(t.replace(/^(http(s)?:)?\/\//,"//"))},dataType:"json"}).fail(function(){})},r=function(t){if("http://smartslider3.com"===t.origin||"https://smartslider3.com"===t.origin){var e=t.data;switch(e.key){case"importSlider":return void o(e.data.href);case"closeWindow":s()}}};this.notificationStack.enableStack(),N2Classes.Esc.add(t.proxy(function(){return s(),!0},this)),window.addEventListener("message",r,!1)},i}),N2D("SliderGroup",function(t,e){function i(e,i){this.addToGroupModal=null,this.manager=e,this.ajaxUrl=i,t("#n2-ss-create-group").click(t.proxy(function(t){t.preventDefault(),t.stopImmediatePropagation(),this.showModal()},this)),this.notificationStack=new N2Classes.NotificationStackModal(t("body"))}return i.prototype.showModal=function(){var e=!1;if(!this.addToGroupModal){var i=this,n=this.ajaxUrl;this.addToGroupModal=new N2Classes.NextendModal({zero:{size:[300,220],title:n2_("Create group"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Create group")+"</a>"],fn:{show:function(){var s=this.controls.find(".n2-button-green"),o=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),s.trigger("click")});o.append(this.createInput(n2_("Group name"),"grouptitle","width: 240px;"));var r=t("#grouptitle").val(n2_("Group")).focus();s.on("click",t.proxy(function(s){s.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(n,{nextendaction:"createGroup"}),data:{title:r.val()},dataType:"json"}).done(t.proxy(function(n){if(0==i.manager.groupID){var o=t(n.data).appendTo(i.manager.slidersContainer);new N2Classes.Slider(i.manager,o);i.manager.initSliders()}e=!0,this.hide(s)},this))},this))},hide:function(){e?t("body").triggerHandler("groupAdded"):t("body").triggerHandler("groupCanceled")}}}})}this.addToGroupModal.show()},i}),N2D("ManageSliders",function(t,e){function i(e,i,n){this.groupID=e,this.ajaxUrl=i,this.sliders=[],this.sliderPanel=t("#n2-ss-slider-container"),this.orderBy="ordering"==this.sliderPanel.data("orderby"),this.slidersContainer=this.sliderPanel.find(".n2-ss-sliders-container");for(var s=this.slidersContainer.find(".n2-ss-box-slider"),o=0;o<s.length;o++)this.sliders.push(new N2Classes.Slider(this,s.eq(o)));this.changed(),this.initMenu(),this.initOrderable(),this.create=new N2Classes.CreateSlider(e,i,n),this.createGroup=new N2Classes.SliderGroup(this,i),this.initBulk()}return i.prototype.changed=function(){t("html").attr("data-sliders",this.sliders.length)},i.prototype.initSliders=function(){for(var e=this.slidersContainer.find(".n2-ss-box-slider"),i=[],n=0;n<e.length;n++){var s=e.eq(n).data("slider");i.push(s)}this.sliders=i,this.changed(),t(window).triggerHandler("SmartSliderSidebarSlidersChanged")},i.prototype.initOrderable=function(){if(this.orderBy){var e={helper:"clone",items:"> .n2-ss-box-slider",stop:t.proxy(this.saveOrder,this),placeholder:"n2-box-sortable-placeholder",distance:10};e.droppables="n2-ss-box-slider-group",e.over=t.proxy(function(t,e){e.droppable.addClass("n2-active"),e.helper.addClass("n2-ss-helper-add-to-group")},this),e.out=t.proxy(function(t,e){e.helper.removeClass("n2-ss-helper-add-to-group"),e.droppable.removeClass("n2-active")},this),e.drop=t.proxy(function(t,e){this._addToGroup("move",e.droppable.data("slider").getId(),[e.item.data("slider").getId()])},this),this.slidersContainer.nUISortable(e)}},i.prototype.saveOrder=function(e,i){for(var n=this.slidersContainer.find(".n2-ss-box-slider"),s=[],o=[],r=[],a=0;a<n.length;a++){var l=n.eq(a).data("slider");s.push(l),o.push(l.getId())}for(var a=0;a<this.sliders.length;a++)r.push(this.sliders[a].getId());if(JSON.stringify(r)!=JSON.stringify(o)){t(window).triggerHandler("SmartSliderSidebarSlidersOrderChanged");var d={nextendcontroller:"sliders",nextendaction:"order"};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,d),data:{groupID:this.groupID,sliderorder:o,isReversed:"DESC"==this.sliderPanel.data("orderbydirection")?1:0}}),this.sliders=s}},i.prototype.initMenu=function(){this.slider=null,this.menu=t("#n2-ss-slider-menu").detach().addClass("n2-inited"),this.menuActions={duplicate:this.menu.find(".n2-ss-duplicate").on("click",t.proxy(function(t){this.slider.duplicate(t)},this)),"delete":this.menu.find(".n2-ss-delete").on("click",t.proxy(function(t){this.slider["delete"](t)},this)),preview:this.menu.find(".n2-ss-preview").on("click",t.proxy(function(t){this.slider.preview(t)},this))},this.menuActions.addToGroup=this.menu.find(".n2-ss-add-to-group").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.addToGroup([this.slider.getId()])},this)),this.menuActions.removeFromGroup=this.menu.find(".n2-ss-remove-from-group").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.removeFromGroup([this.slider.getId()])},this)),this.menu.find(".n2-button").on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.menu.hasClass("n2-active")?this.menu.removeClass("n2-active").off("mouseleave"):this.menu.addClass("n2-active").on("mouseleave",function(){t(this).removeClass("n2-active")})},this))},i.prototype.showMenu=function(t){this.slider=t,this.menu.appendTo(t.box)},i.prototype.hideMenu=function(){this.menu.hasClass("n2-active")&&this.menu.removeClass("n2-active").off("mouseleave"),this.menu.detach()},i.prototype.deleteSliders=function(e,i){this.hideMenu();var n=i[0].box.find(".n2-box-placeholder-title a").text();i.length>1&&(n+=" and "+(i.length-1)+" more"),N2Classes.NextendModal.deleteModal("slider-delete",n,t.proxy(function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"delete"}),type:"POST",data:{sliders:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSliders(),this.leaveBulk()},this))},this))},i.prototype.duplicateSliders=function(e,i){for(var n=0;n<this.sliders.length;n++)this.sliders[n].selected&&this.sliders[n].duplicate(t.Event("click",{currentTarget:null}))},i.prototype.exportSliders=function(e,i){window.location.href=N2Classes.AjaxHelper.makeFallbackUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"exportAll"})+"&"+t.param({sliders:e,currentGroupID:this.groupID})},i.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1;var e=t(".n2-bulk-select").find("a");e.eq(0).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.select()})},this)),e.eq(1).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.deSelect()})},this));t(".n2-bulk-actions").find("a").on("click",t.proxy(function(e){switch(e.preventDefault(),t(e.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSliders",!1);break;case"delete":this.bulkAction("deleteSliders",!1);break;case"export":this.bulkAction("exportSliders",!1);break;case"addToGroup":this.bulkAction("addToGroup",!0)}},this))},i.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},i.prototype.removeSelection=function(e){this.selection.splice(t.inArray(e,this.selection),1),0==this.selection.length&&this.leaveBulk()},i.prototype.bulkSelect=function(t){for(var e=0;e<this.sliders.length;e++)t(this.sliders[e])},i.prototype.bulkAction=function(t,e){var i=[],n=[];this.bulkSelect(function(t){!t.selected||e&&t.isGroup||(i.push(t),n.push(t.getId()))}),n.length?(this[t](n,i),this.leaveBulk()):e?N2Classes.Notification.notice("Please select one or more sliders for the action!"):N2Classes.Notification.notice("Please select one or more sliders or groups for the action!")},i.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.orderBy&&this.slidersContainer.nUISortable("option","disabled",!0),t("#n2-admin").addClass("n2-ss-has-box-selection"))},i.prototype.leaveBulk=function(){if(this.isBulkSelection){this.orderBy&&this.slidersContainer.nUISortable("option","disabled",!1),t("#n2-admin").removeClass("n2-ss-has-box-selection");for(var e=0;e<this.sliders.length;e++)this.sliders[e].deSelect();this.selection=[],this.isBulkSelection=!1}},i.prototype.removeFromGroup=function(e){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"removeFromGroup"}),data:{currentGroupID:this.groupID,sliders:e},dataType:"json"}).done(t.proxy(function(i){for(var n=0;n<e.length;n++)t('[data-sliderid="'+e[n]+'"]').data("slider").deleted();this.initSliders()},this))},i.prototype._addToGroup=function(e,i,n){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"addToGroup"}),data:{currentGroupID:this.groupID,groupID:i,action:e,sliders:n},dataType:"json"}).done(t.proxy(function(s){if("move"==e){for(var o=0;o<n.length;o++)t('[data-sliderid="'+n[o]+'"]').data("slider").deleted();this.initSliders()}var r=t('[data-sliderid="'+i+'"] .n2-box-placeholder-buttons .n2-button-grey');r.html(parseInt(r.html())+n.length)},this))},i.prototype.addToGroup=function(e){var i=null,n=this,s=(this.ajaxUrl,new N2Classes.NextendModal({zero:{size:[350,220],title:n2_("Add to group"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<div class="n2-button n2-button-with-actions n2-button-l n2-button-green n2-radius-s n2-h4"><a class="n2-button-inner" href="#" data-action="move">'+n2_("Move")+'</a><div class="n2-button-menu-open"><i class="n2-i n2-i-buttonarrow"></i><div class="n2-button-menu"><div class="n2-button-menu-inner n2-border-radius"><a class="n2-h4" href="#" data-action="copy">'+n2_("Copy")+'</a><a class="n2-h4" href="#" data-action="link">'+n2_("Link")+"</a></div></div></div></div>"],fn:{show:function(){this.controls.find(".n2-button-menu-open").n2opener();var s=this.controls.find("a"),o=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),s.eq(0).trigger("click")});o.append(this.createSelect(n2_("Group"),"choosegroup",i,"width:300px;"));var r=t("#choosegroup");s.on("click",t.proxy(function(i){i.preventDefault(),n._addToGroup(t(i.currentTarget).data("action"),r.val(),e).done(t.proxy(function(){this.hide(i)},this))},this))}}}}));N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"listGroups"}),dataType:"json"}).done(t.proxy(function(e){i=e.data,"undefined"!=typeof i[this.groupID]&&delete i[this.groupID],t.isEmptyObject(i)?(t("body").on({"groupAdded.addToGroup":t.proxy(function(){t("body").off(".addToGroup"),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"listGroups"}),dataType:"json"}).done(t.proxy(function(t){i=t.data,"undefined"!=typeof i[this.groupID]&&delete i[this.groupID],s.show()},this))},this),"groupAddCanceled.addToGroup":t.proxy(function(){t("body").off(".addToGroup")},this)}),this.createGroup.showModal()):s.show()},this))},i}),N2D("ParticleAdminManager",function(t,e){function i(e,i){N2R("#n2-ss-"+e,t.proxy(function(t,e){this.slider=e,this.types=i,this.fields={},this.values=t.extend({},n),this.slider.ready(t.proxy(this.onVisible,this)),this.updateParticle=NextendThrottle(this.updateParticle,33),window.parent!=window&&t(window).on("keydown keyup keypress",t.proxy(function(t){27==t.keyCode&&this.postMessage("cancel")},this)),t("#n2-ss-form-cancel").on("click",t.proxy(function(t){t.preventDefault(),this.postMessage("cancel")},this)),t("#n2-ss-form-save").on("click",t.proxy(function(t){t.preventDefault(),this.postMessage("save",this.getValues())},this)),window.addEventListener("message",t.proxy(this.onMessage,this),!1),this.slider.ready(t.proxy(function(){this.postMessage("ready")},this)),t('<div style="margin:10px;">'+n2_printf(n2_("You can generate at %s Then <i>Download current config (json)</i> and paste content into the field."),'<a target="_blank" href="http://vincentgarreau.com/particles.js/">http://vincentgarreau.com/particles.js/</a>')+"</div>").insertAfter(t("#slidercustom").parent())},this))}var n={preset:0,custom:"",color:"FFFFFF80","line-color":"FFFFFF66",speed:2,number:28,hover:"off",click:"off",mobile:0};return i.prototype.getValues=function(){if("0"==this.values.preset)return JSON.stringify(!1);var e=t.extend({},this.values);return""!=e.custom&&(e.custom=JSON.parse(e.custom.replace(/\/\*.*?\*\//,""))),JSON.stringify(e)},i.prototype.postMessage=function(t){var e=!1;arguments.length>1&&(e=arguments[1]),parent.postMessage(JSON.stringify({action:t,data:e}),"*")},i.prototype.onMessage=function(t){if(t.source==parent)try{var e=JSON.parse(t.data);switch(e.action){case"load":try{var i=JSON.parse(e.data);0==i?this.loadValues(n):this.loadValues(i)}catch(s){this.loadValues(n)}}}catch(s){console.error(s)}},i.prototype.onVisible=function(){this.registerField("preset"),this.$rowSettings=t('[data-field="sliderparticle-settings"]'),this.$rowCustom=t('[data-field="slidercustom"]'),this.registerField("mobile"),this.registerField("color"),this.registerField("line-color"),this.registerField("speed"),this.registerField("number"),this.registerField("hover"),this.registerField("click"),this.registerField("custom"),this.updateParticle()},i.prototype.updateParticle=function(){var e=this.getValue("preset");if(0==e)return this.$rowSettings.css("display","none"),this.$rowCustom.css("display","none"),void(this.slider.pJS&&(this.slider.pJS.pJS.fn.vendors.destroypJS(),this.slider.pJS=!1));var i={};if("custom"==e){this.$rowSettings.css("display","none"),this.$rowCustom.css("display","");var n=this.getValue("custom").replace(/\/\*.*?\*\//,"");if(""==n)return void(this.slider.pJS&&(this.slider.pJS.pJS.fn.vendors.destroypJS(),this.slider.pJS=!1));try{i=JSON.parse(n)}catch(s){alert("Invalid JSON data in custom field.")}}else{this.$rowSettings.css("display",""),this.$rowCustom.css("display","none"),i=JSON.parse(this.types[e]);var o=N2Color.colorToSVG(this.getValue("color"));i.particles.color.value=o[0],i.particles.opacity.value=o[1];var r=N2Color.colorToSVG(this.getValue("line-color"));i.particles.line_linked.color=r[0],i.particles.line_linked.opacity=r[1],i.particles.number.value=this.getValue("number"),i.particles.move.speed=parseInt(this.getValue("speed"));var a=this.getValue("hover");"0"==a?i.interactivity.events.onhover.enable=0:(i.interactivity.events.onhover.enable=1,i.interactivity.events.onhover.mode=a);var l=this.getValue("click");"0"==l?i.interactivity.events.onclick.enable=0:(i.interactivity.events.onclick.enable=1,i.interactivity.events.onclick.mode=l)}if(i.interactivity.detect_on=this.slider.sliderElement[0],this.slider.pJS){t.extend(!0,this.slider.pJS.pJS,i);var d=this.slider.pJS.pJS;d.tmp.obj={size_value:d.particles.size.value,size_anim_speed:d.particles.size.anim.speed,move_speed:d.particles.move.speed,line_linked_distance:d.particles.line_linked.distance,line_linked_width:d.particles.line_linked.width,mode_grab_distance:d.interactivity.modes.grab.distance,mode_bubble_distance:d.interactivity.modes.bubble.distance,mode_bubble_size:d.interactivity.modes.bubble.size,mode_repulse_distance:d.interactivity.modes.repulse.distance},this.slider.pJS.pJS.fn.particlesRefresh()}else this.slider.startParticleJS(i)},i.prototype.registerField=function(e){this.fields[e]=t("#slider"+e).on("nextendChange",t.proxy(function(){this.values[e]=this.fields[e].val(),this.updateParticle()},this))},i.prototype.loadValues=function(e){"object"==typeof e.custom&&(e.custom=JSON.stringify(e.custom,null,2)),this.values=t.extend({},n,e),this.updateParticle();for(var i in this.fields)this.fields[i].data("field").insideChange(this.getValue(i))},i.prototype.getValue=function(t){return this.values[t]},i}),N2D("ShapeDividerAdminManager",function(t,e){function i(e,i){N2R("#n2-ss-"+e,t.proxy(function(t,e){this.slider=e,this.top=new n(this.slider,this,i,"top"),this.bottom=new n(this.slider,this,i,"bottom"),window.parent!=window&&t(window).on("keydown keyup keypress",t.proxy(function(t){27==t.keyCode&&this.postMessage("cancel")},this)),t("#n2-ss-form-cancel").on("click",t.proxy(function(t){t.preventDefault(),this.postMessage("cancel")},this)),t("#n2-ss-form-save").on("click",t.proxy(function(t){t.preventDefault(),this.postMessage("save",this.getValues())},this)),window.addEventListener("message",t.proxy(this.onMessage,this),!1),this.slider.ready(t.proxy(function(){this.postMessage("ready")},this))},this))}function n(e,i,n,o){this.slider=e,this.manager=i,this.types=n,this.side=o,this.devicePrefix="desktopportrait",this.isDeviceBased={},this.fields={},this.values=t.extend({},s),this.tweens=[],this.renderDivider=NextendThrottle(this.renderDivider,33),this.slider.ready(t.proxy(this.onVisible,this))}var s={type:"0",color:"FFFFFFFF",color2:"FFFFFF80",desktopportraitwidth:100,desktoplandscapewidth:100,tabletportraitwidth:100,tabletlandscapewidth:100,mobileportraitwidth:100,mobilelandscapewidth:100,desktopportraitheight:100,desktoplandscapeheight:100,tabletportraitheight:50,tabletlandscapeheight:50,mobileportraitheight:25,mobilelandscapeheight:25,flip:0,animate:0,speed:100,scroll:0};return i.prototype.getValues=function(){return JSON.stringify({top:this.top.getValues(),bottom:this.bottom.getValues()})},i.prototype.postMessage=function(t){var e=!1;arguments.length>1&&(e=arguments[1]),parent.postMessage(JSON.stringify({action:t,data:e}),"*")},i.prototype.onMessage=function(t){if(t.source==parent)try{var e=JSON.parse(t.data);switch(e.action){case"load":try{var i=JSON.parse(e.data);this.top.loadValues(i.top),this.bottom.loadValues(i.bottom)}catch(n){this.top.loadValues(s),this.bottom.loadValues(s)}}}catch(n){
console.error(n)}},n.prototype.loadValues=function(e){this.values=t.extend({},s,e),this.renderDivider();for(var i in this.fields)this.fields[i].data("field").insideChange(this.getValue(i))},n.prototype.getValues=function(){return 0==this.values.type?!1:this.values},n.prototype.onVisible=function(){this.$shapeContainer=this.slider.getSlideBackgroundContainer(),this.registerField("type",!1),this.$fieldGroups=this.fields.type.closest(".n2-element").find(".n2-mixed-group").slice(1).css("display","none"),this.registerField("color",!1),this.registerField("color2",!1),this.$color2Container=this.fields.color2.closest(".n2-mixed-group").css("display","none"),this.registerField("flip",!1),this.registerField("animate",!1),this.registerField("speed",!1),this.registerField("width",!0),this.registerField("height",!0),this.registerField("scroll",!1),this.slider.sliderElement.on("SliderDeviceOrientation",t.proxy(this.onDeviceChange,this))},n.prototype.onDeviceChange=function(t,e){this.devicePrefix=e.device.toLowerCase()+e.orientation.toLowerCase();for(var i in this.isDeviceBased)this.isDeviceBased[i]&&this.fields[i].data("field").insideChange(this.getValue(i));this.renderDivider()},n.prototype.renderDivider=function(){if(this.tweens.length){for(var i=0;i<this.tweens.length;i++)this.tweens[i].kill();this.tweens=[]}this.slider.sliderElement.find(".n2-ss-shape-divider-"+this.side).remove();var n=this.getValue("type");if(0==n?this.$fieldGroups.css("display","none"):this.$fieldGroups.css("display",""),n.match(/bi\-/)?this.$color2Container.css("display",""):this.$color2Container.css("display","none"),"0"!=n&&this.types[n]!==e){var s=this.types[n].replace(/#000000/g,N2Color.hex2rgbaCSS(this.getValue("color"))).replace(/#000010/g,N2Color.hex2rgbaCSS(this.getValue("color2"))),o=t("<div class='n2-ss-shape-divider n2-ss-shape-divider-"+this.side+"' style='height:"+this.getValue("height")+"px;'><div style='width:"+this.getValue("width")+"%;margin-left:"+-(this.getValue("width")-100)/2+"%;' class='n2-ss-shape-divider-inner'>"+s+"</div></div>").appendTo(this.$shapeContainer);if(parseInt(this.getValue("flip"))&&o.addClass("n2-ss-flip-horizontal"),parseInt(this.getValue("animate"))){o.addClass("n2-ss-divider-animate");var r=o.find(".n2-ss-divider-start > *"),a=o.find(".n2-ss-divider-end > *");if(r.parent().attr("yoyo"))for(var l={onComplete:function(){this.reverse()},onReverseComplete:function(){this.restart()}},d=0;d<r.length;d++)this.tweens.push(NextendTween.to(r[d],parseFloat(r.eq(d).attr("duration"))*(100/parseInt(this.getValue("speed"))),t.extend({morphSVG:a[d],delay:0,ease:"easeInOut"},l,{delay:r.eq(d).attr("delay"),ease:r.eq(d).attr("ease")})));else{for(var h=new NextendTimeline({onComplete:function(){this.restart()}}),d=0;d<r.length;d++)h.to(r[d],parseFloat(r.eq(d).attr("duration"))*(100/parseInt(this.getValue("speed"))),t.extend({morphSVG:a[d],delay:0,ease:"easeOutCubic"},{delay:r.eq(d).attr("delay"),ease:r.eq(d).attr("ease")}),0);h.to({x:0},2,{x:10}),this.tweens.push(h)}}}},n.prototype.registerField=function(e,i){this.isDeviceBased[e]=i,this.fields[e]=t("#slidershapedivider-"+this.side+"-"+e).on("nextendChange",t.proxy(function(){i?this.values[this.devicePrefix+e]=this.fields[e].val():this.values[e]=this.fields[e].val(),this.renderDivider()},this))},n.prototype.getValue=function(t){return this.isDeviceBased[t]?this.values[this.devicePrefix+t]==e||""==this.values[this.devicePrefix+t]?this.values["desktopportrait"+t]:this.values[this.devicePrefix+t]:this.values[t]},i}),N2D("Slider",function(t,e){function i(e,i){this.selected=!1,this.manager=e,this.box=i.data("slider",this).addClass("n2-clickable"),this.isGroup=this.box.hasClass("n2-ss-box-slider-group"),this.box.on("mouseenter",t.proxy(function(){this.manager.showMenu(this)},this)).on("mouseleave",t.proxy(function(){this.manager.hideMenu()},this)).on("click.n2-slider",t.proxy(this.goToEdit,this)),this.box.find(".n2-ss-box-select").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()},this))}return i.prototype.getId=function(){return this.box.data("sliderid")},i.prototype.goToEdit=function(t,e){if("A"!==t.target.tagName){var i=this.box.data("editurl");"undefined"!=typeof e&&e?window.open(i,"_blank"):window.location=i}},i.prototype.preview=function(t){t.stopPropagation(),t.preventDefault(),window.open(N2Classes.AjaxHelper.makeFallbackUrl(this.box.data("editurl"),{nextendcontroller:"preview",nextendaction:"index"}),"_blank")},i.prototype.duplicate=function(e){e.stopPropagation(),e.preventDefault();var n=t.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendcontroller:"slider",nextendaction:"duplicate"})}).done(t.proxy(function(e){var s=t(e.data).insertAfter(this.box),o=new i(this.manager,s);this.manager.initSliders(),n.resolve(o)},this)),n},i.prototype["delete"]=function(t){t.stopPropagation(),t.preventDefault(),this.manager.deleteSliders([this.getId()],[this])},i.prototype.deleted=function(){this.box.remove()},i.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},i.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2-selected"),this.manager.addSelection(this))},i.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2-selected"),this.manager.removeSelection(this))},i}),N2D("FormElementAnimationManager",["FormElement"],function(t,e){function i(e,i){this.element=t("#"+e),this.managerIdentifier=i,this.element.parent().on("click",t.proxy(this.show,this)),this.element.siblings(".n2-form-element-clear").on("click",t.proxy(this.clear,this)),this.name=this.element.siblings("input"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.show=function(e){e.preventDefault(),nextend[this.managerIdentifier].show(this.element.val(),t.proxy(this.save,this))},i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation(),this.val("")},i.prototype.save=function(t,e){this.val(e)},i.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},i.prototype.updateName=function(t){t=""==t?n2_("Disabled"):t.split("||").length>1?n2_("Multiple animations"):n2_("Single animation"),this.name.val(t)},i}),N2D("FormElementBackground",["FormElement"],function(t,e){function i(e,i){this.value="",this.element=t("#"+e),this.$container=this.element.closest(".n2-form-tab"),this.panel=t("#"+e+"-panel"),this.setValue(i),this.options=this.panel.find(".n2-subform-image-option").on("click",t.proxy(this.selectOption,this)),this.active=this.getIndex(this.options.filter(".n2-active").get(0)),this.element.on("change",t.proxy(function(){this.insideChange(this.element.val())},this)),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.selectOption=function(e){var i=this.getIndex(e.currentTarget);if(i!=this.active){this.options.eq(i).addClass("n2-active"),this.options.eq(this.active).removeClass("n2-active"),this.active=i;var n=t(e.currentTarget).data("value");this.insideChange(n)}},i.prototype.setValue=function(t){this.$container.removeClass("n2-ss-background-type-"+this.value),this.value=t,this.$container.addClass("n2-ss-background-type-"+this.value)},i.prototype.insideChange=function(t){this.setValue(t),this.element.val(t),this.options.removeClass("n2-active"),this.options.filter('[data-value="'+t+'"]').addClass("n2-active"),this.triggerInsideChange()},i.prototype.getIndex=function(e){return t.inArray(e,this.options)},i}),N2D("FormElementColumns",["FormElement"],function(t,e){function i(e){this.denominators={1:100,2:100,3:144,4:100,5:100,6:144},this.element=t("#"+e),N2Classes.FormElement.prototype.constructor.apply(this,arguments),this.$c=t("#"+e).parent(),this.$container=this.$c.find(".n2-ss-columns-element-container"),this.containerWidth=284,this.maxWidth=0,this.$container.nUISortable({axis:"x",items:".n2-ss-columns-element-column",helper:"clone_hide",start:t.proxy(function(t,e){this.$container.addClass("n2-sortable-currently-sorted"),e.placeholder.css({width:e.item.width(),visibility:"hidden"});var i=this.$container.find(".n2-ss-columns-element-column");e.item.data("index",i.index(e.item))},this),stop:t.proxy(function(t,e){var i=this.$container.find(".n2-ss-columns-element-column"),n=e.item.data("index"),s=i.index(e.item);n!=s&&(this.currentRow.moveCol(n,s),e.item.data("index",null)),this.makeResizable(),this.$container.removeClass("n2-sortable-currently-sorted")},this)}),this.$c.find(".n2-ss-columns-element-add-col").on({click:t.proxy(function(){this.currentRow.createCol()},this)})}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.getDenominator=function(t){return this.denominators[t]===e&&(this.denominators[t]=15*t),this.denominators[t]},i.prototype.setRow=function(t){this.currentRow=t,this.insideChange(t.getColumnsOrdered())},i.prototype.setValue=function(t){},i.prototype.insideChange=function(t){this.start(t)},i.prototype.activateColumn=function(t){var e=this.$container.find(".n2-ss-columns-element-column").index(t.currentTarget);this.currentRow.activateColumn(e,t)},i.prototype.start=function(e){this.percentages=[];for(var i=e.split("+"),n=0;n<i.length;n++)this.percentages.push(new Fraction(i[n]));this.refreshMaxWidth(),this.$container.empty();for(var n=0;n<this.percentages.length;n++)this.updateColumn(t('<div class="n2-ss-columns-element-column">').on("click",t.proxy(this.activateColumn,this)).appendTo(this.$container),this.percentages[n]);this.makeResizable()},i.prototype.refreshMaxWidth=function(){this.maxWidth=this.containerWidth-15*(this.percentages.length-1)},i.prototype.updateColumn=function(t,e){t.css("width",this.maxWidth*e.valueOf()+"px").html(Math.round(100*e.valueOf()*10)/10+"%")},i.prototype.makeResizable=function(){this.handles&&this.handles.remove(),this.$columns=this.$container.find(".n2-ss-columns-element-column"),t('<div class="n2-ss-columns-element-handle"><div class="n2-i n2-i-more"></div></div>').insertAfter(this.$columns.not(this.$columns.last())),this.handles=this.$container.find(".n2-ss-columns-element-handle").on("mousedown",t.proxy(this._resizeStart,this))},i.prototype._resizeStart=function(e){var i=this.handles.index(e.currentTarget),n=this.$container.offset().left+8;this.resizeContext={index:i,cLeft:n,$currentCol:this.$columns.eq(i),$nextCol:this.$columns.eq(i+1),startX:Math.max(0,Math.min(e.clientX-n,this.containerWidth))},this._resizeMove(e),t("html").off(".resizecol").on({"mousemove.resizecol":t.proxy(this._resizeMove,this),"mouseup.resizecol mouseleave.resizecol":t.proxy(this._resizeStop,this)})},i.prototype._resizeMove=function(e){e.preventDefault();var i=Math.max(0,Math.min(e.clientX-this.resizeContext.cLeft,this.containerWidth)),n=this.getDenominator(this.percentages.length),s=new Fraction(Math.round((i-this.resizeContext.startX)/(this.maxWidth/n)),n);s.compare(this.percentages[this.resizeContext.index].clone().mul(-1))<0&&(s=this.percentages[this.resizeContext.index].clone().mul(-1)),s.compare(this.percentages[this.resizeContext.index+1])>0&&(s=this.percentages[this.resizeContext.index+1].clone());var o=this.percentages[this.resizeContext.index].add(s),r=this.percentages[this.resizeContext.index+1].sub(s);this.updateColumn(this.resizeContext.$currentCol,o),this.updateColumn(this.resizeContext.$nextCol,r);var a=t.extend([],this.percentages);return a[this.resizeContext.index]=o,a[this.resizeContext.index+1]=r,this.onColumnWidthChange(a),[o,r]},i.prototype._resizeStop=function(e){var i=this._resizeMove(e);this.percentages[this.resizeContext.index]=i[0],this.percentages[this.resizeContext.index+1]=i[1],t("html").off(".resizecol"),delete this.resizeContext,this.currentRow.setRealColsWidth(this.percentages)},i.prototype.onColumnWidthChange=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].valueOf());this.currentRow.updateColumnWidth(e)},i}),function(t){"use strict";function e(t,e){return isNaN(t=parseInt(t,10))&&i(),t*e}function i(){throw"Invalid Param"}function n(t,e){return this instanceof n?(r(t,e),t=n.REDUCE?h(o.d,o.n):1,this.s=o.s,this.n=o.n/t,void(this.d=o.d/t)):new n(t,e)}var s=2e3,o={s:1,n:0,d:1},r=function(t,n){var s,r=0,a=1,l=1,d=0,h=0,p=0,c=1,u=1,y=0,g=1,f=1,m=1,v=1e7;if(void 0===t||null===t);else if(void 0!==n)r=t,a=n,l=r*a;else switch(typeof t){case"object":"d"in t&&"n"in t?(r=t.n,a=t.d,"s"in t&&(r*=t.s)):0 in t?(r=t[0],1 in t&&(a=t[1])):i(),l=r*a;break;case"number":if(0>t&&(l=t,t=-t),t%1===0)r=t;else if(t>0){for(t>=1&&(u=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=u);v>=g&&v>=m;){if(s=(y+f)/(g+m),t===s){v>=g+m?(r=y+f,a=g+m):m>g?(r=f,a=m):(r=y,a=g);break}t>s?(y+=f,g+=m):(f+=y,m+=g),g>v?(r=f,a=m):(r=y,a=g)}r*=u}else(isNaN(t)||isNaN(n))&&(a=r=NaN);break;case"string":if(g=t.match(/\d+|./g),"-"===g[y]?(l=-1,y++):"+"===g[y]&&y++,g.length===y+1?h=e(g[y++],l):"."===g[y+1]||"."===g[y]?("."!==g[y]&&(d=e(g[y++],l)),y++,(y+1===g.length||"("===g[y+1]&&")"===g[y+3]||"'"===g[y+1]&&"'"===g[y+3])&&(h=e(g[y],l),c=Math.pow(10,g[y].length),y++),("("===g[y]&&")"===g[y+2]||"'"===g[y]&&"'"===g[y+2])&&(p=e(g[y+1],l),u=Math.pow(10,g[y+1].length)-1,y+=3)):"/"===g[y+1]||":"===g[y+1]?(h=e(g[y],l),c=e(g[y+2],1),y+=3):"/"===g[y+3]&&" "===g[y+1]&&(d=e(g[y],l),h=e(g[y+2],l),c=e(g[y+4],1),y+=5),g.length<=y){a=c*u,l=r=p+a*d+u*h;break}default:i()}if(0===a)throw"DIV/0";o.s=0>l?-1:1,o.n=Math.abs(r),o.d=Math.abs(a)},a=function(t,e,i){for(var n=1;e>0;t=t*t%i,e>>=1)1&e&&(n=n*t%i);return n},l=function(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var i=10%e,n=1;1!==i;n++)if(i=10*i%e,n>s)return 0;return n},d=function(t,e,i){for(var n=1,s=a(10,i,e),o=0;300>o;o++){if(n===s)return o;n=10*n%e,s=10*s%e}return 0},h=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}};n.REDUCE=1,n.prototype={s:1,n:0,d:1,abs:function(){return new n(this.n,this.d)},neg:function(){return new n(-this.s*this.n,this.d)},add:function(t,e){return r(t,e),new n(this.s*this.n*o.d+o.s*this.d*o.n,this.d*o.d)},sub:function(t,e){return r(t,e),new n(this.s*this.n*o.d-o.s*this.d*o.n,this.d*o.d)},mul:function(t,e){return r(t,e),new n(this.s*o.s*this.n*o.n,this.d*o.d)},div:function(t,e){return r(t,e),new n(this.s*o.s*this.n*o.d,this.d*o.n)},clone:function(){return new n(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new n(NaN):void 0===t?new n(this.s*this.n%this.d,1):(r(t,e),0===o.n&&0===this.d&&n(0,0),new n(this.s*o.d*this.n%(o.n*this.d),o.d*this.d))},gcd:function(t,e){return r(t,e),new n(h(o.n,this.n),o.d*this.d/h(o.d,this.d))},lcm:function(t,e){return r(t,e),0===o.n&&0===this.n?new n:new n(o.n*this.n/h(o.n,this.n),h(o.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new n(NaN):new n(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new n(NaN):new n(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new n(NaN):new n(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new n(this.s*this.d,this.n)},pow:function(t){return 0>t?new n(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new n(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return r(t,e),this.s*this.n*o.d===o.s*o.n*this.d},compare:function(t,e){r(t,e);var i=this.s*this.n*o.d-o.s*o.n*this.d;return(i>0)-(0>i)},divisible:function(t,e){return r(t,e),!(!(o.n*this.d)||this.n*o.d%(o.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,i="",n=this.n,s=this.d;return this.s<0&&(i+="-"),1===s?i+=n:(t&&(e=Math.floor(n/s))>0&&(i+=e,i+=" ",n%=s),i+=n,i+="/",i+=s),i},toLatex:function(t){var e,i="",n=this.n,s=this.d;return this.s<0&&(i+="-"),1===s?i+=n:(t&&(e=Math.floor(n/s))>0&&(i+=e,n%=s),i+="\\frac{",i+=n,i+="}{",i+=s,i+="}"),i},toContinued:function(){var t,e=this.n,i=this.d,n=[];do n.push(Math.floor(e/i)),t=e%i,e=i,i=t;while(1!==e);return n},toString:function(){var t,e=this.n,i=this.d;if(isNaN(e)||isNaN(i))return"NaN";n.REDUCE||(t=h(e,i),e/=t,i/=t);for(var s=String(e).split(""),o=0,r=[~this.s?"":"-","",""],a="",p=l(e,i),c=d(e,i,p),u=-1,y=1,g=15+p+c+s.length,f=0;g>f;f++,o*=10){if(f<s.length?o+=Number(s[f]):(y=2,u++),p>0)if(u===c)r[y]+=a+"(",a="";else if(u===p+c){r[y]+=a+")";break}o>=i?(r[y]+=a+(o/i|0),a="",o%=i):y>1?a+="0":r[y]&&(r[y]+="0")}return r[0]+=r[1]||"0",r[2]?r[0]+"."+r[2]:r[0]}},t.Fraction=n}(window),N2D("FormElementLayerPicker",["FormElement"],function(t,e){function i(e){this.status=0,this.element=t("#"+e),this.$container=t(".n2-ss-parent-picker"),this.overlays=null,this.aligns=this.element.parent().parent().siblings(),this.picker=this.element.siblings(".n2-ss-layer-picker").on({click:t.proxy(function(){this.change("")},this)}),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}var n={INITIALIZED:0,PICK_PARENT:1,PICK_CHILD:2,PICK_PARENT_ALIGN:3,PICK_CHILD_ALIGN:4},s='<div class="n2-ss-picker-overlay-tile" data-align="left" data-valign="top" /><div class="n2-ss-picker-overlay-tile" data-align="center" data-valign="top" style="left:33%;top:0;" /><div class="n2-ss-picker-overlay-tile" data-align="right" data-valign="top" style="left:66%;top:0;width:34%;" /><div class="n2-ss-picker-overlay-tile" data-align="left" data-valign="middle" style="left:0;top:33%;" /><div class="n2-ss-picker-overlay-tile" data-align="center" data-valign="middle" style="left:33%;top:33%; " /><div class="n2-ss-picker-overlay-tile" data-align="right" data-valign="middle" style="left:66%;top:33%;width:34%;" /><div class="n2-ss-picker-overlay-tile" data-align="left" data-valign="bottom" style="left:0;top:66%;height:34%;" /><div class="n2-ss-picker-overlay-tile" data-align="center" data-valign="bottom" style="left:33%;top:66%;height:34%;" /><div class="n2-ss-picker-overlay-tile" data-align="right" data-valign="bottom" style="left:66%;top:66%;width:34%;height:34%;" />';return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.click=function(e){return t("#n2-admin").hasClass("n2-ss-mode-desktopPortrait")?void(this.status==n.INITIALIZED?(this.data={parent:null,parentVAlign:null,parentHAlign:null,child:null,childVAlign:null,childHAlign:null},t("body").on("mousedown.n2-ss-parent-linker",t.proxy(function(e){var i=t(e.target);i.hasClass("n2-ss-picker-overlay")||i.hasClass("n2-ss-picker-overlay-tile")||this.destroy()},this)),N2Classes.Esc.add(t.proxy(function(){return this.destroy(),!1},this)),this.pickParent(e)):(this.data=null,this.change(""),this.destroy())):void N2Classes.Notification.notice(n2_("To chain layers together, please switch to desktop portrait mode!"))},i.prototype.getAbsoluteLayers=function(t){for(var e=[],i=t.getSortedLayers(),n=0;n<i.length;n++)switch(i[n].placement.getType()){case"absolute":e.push(i[n].layer[0]);break;case"group":e.push.apply(e,this.getAbsoluteLayers(i[n].container))}return e},i.prototype.pickParent=function(e){var i=nextend.currentEditor.fragmentEditor,s=t(this.getAbsoluteLayers(i.mainContainer.container));if(this.tempLayers=s,0==s.length)this.destroy();else{this.status=n.PICK_PARENT,nextend.tooltipMouse.show(n2_("Pick the parent layer!"),e);t('<div class="n2-ss-picker-overlay"></div>').appendTo(s).on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation();var i=t(e.currentTarget).parent();i.data("layerObject");this.data.parent=i,this._destroy(),this.pickParentAlign(e)},this))}},i.prototype.pickParentAlign=function(e){this.status=n.PICK_PARENT_ALIGN,nextend.tooltipMouse.show(n2_("Pick the align point of the parent layer!"),e);var i=t(s).appendTo(this.data.parent).on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),N2Classes.WindowManager.get().preventDblClick();var n=t(e.currentTarget);this.data.parentHAlign=n.data("align"),this.data.parentVAlign=n.data("valign"),n.off("click").addClass("n2-active"),i.not(n).remove(),this.pickChild(e)},this))},i.prototype.pickChild=function(e){this.status=n.PICK_CHILD,nextend.tooltipMouse.show(n2_("Pick the child layer!"),e);var i=this.tempLayers.not(this.data.parent);delete this.tempLayers;var s=function(e){var n=e.data("layerObject").getProperty("parentid");n&&""!=n&&s(t("#"+n)),i=i.not(e)};if(s(this.data.parent),!i.length)return N2Classes.Notification.error(n2_("There is no layer available to be child of the selected layer!")),void this.destroy();var o=t('<div class="n2-ss-picker-overlay"></div>').appendTo(i).on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation();var i=t(e.currentTarget).parent();i.data("layerObject");this.data.child=i,o.remove(),this.pickChildAlign(e)},this))},i.prototype.pickChildAlign=function(e){this.status=n.PICK_CHILD_ALIGN,nextend.tooltipMouse.show(n2_("Pick the align point of the child layer!"),e);t(s).appendTo(this.data.child).on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),N2Classes.WindowManager.get().preventDblClick();var i=t(e.currentTarget);this.data.childHAlign=i.data("align"),this.data.childVAlign=i.data("valign"),this.done()},this))},i.prototype._destroy=function(){t(".n2-ss-picker-overlay").remove(),t(".n2-ss-picker-overlay-tile").remove()},i.prototype.destroy=function(){nextend.tooltipMouse.hide(),this._destroy(),t("body").off(".n2-ss-parent-linker"),N2Classes.Esc.pop(),this.status=n.INITIALIZED},i.prototype.done=function(){this.data.child.data("layerObject").placement.current.parentPicked(this.data.parent.data("layerObject"),this.data.parentHAlign,this.data.parentVAlign,this.data.childHAlign,this.data.childVAlign),this.destroy()},i.prototype.change=function(t){this.element.val(t).trigger("change"),this._setValue(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this._setValue(t),this.triggerInsideChange()},i.prototype._setValue=function(t){t&&""!=t?this.$container.css("display",""):this.$container.css("display","none")},i}),N2D("FormElementParticleManager",["FormElement"],function(t,e){function i(e){this.element=t("#"+e),this.element.parent().on("click",t.proxy(this.show,this)),this.element.siblings(".n2-form-element-clear").on("click",t.proxy(this.clear,this)),this.name=this.element.siblings("input"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.apply(this,arguments),this.form=t("#n2-ss-edit-slider-form"),this.formAction=this.form.attr("action"),this.onMessage=t.proxy(function(t){if(t.source==this.iframeWindow)try{var e=JSON.parse(t.data);switch(e.action){case"ready":this.iframeReadyDeferred.resolve();break;case"save":this.val(e.data),this.removeLightbox();break;default:this.removeLightbox()}}catch(i){console.error(i),this.removeLightbox()}},this)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.show=function(e){e.preventDefault(),N2Classes.AjaxHelper.startLoading(),this.iframeReadyDeferred=t.Deferred(),this.$lightbox=t('<div class="n2 n2-lightbox-container"></div>').css({display:"block"}).appendTo("body");var i=t('<div class="n2-lightbox n2-border-radius"></div>').appendTo(this.$lightbox),n=t('<iframe name="n2-ss-particleframe" style="width:100%;height:100%;"/>').appendTo(i);this.form.attr({action:N2Classes.AjaxHelper.makeFallbackUrl(window.location.href,{nextendaction:"particle"}),target:"n2-ss-particleframe"}).submit().attr({action:this.formAction,target:null}),this.iframeWindow=n[0].contentWindow||n[0].contentDocument,window.addEventListener("message",this.onMessage,!1),this.iframeReadyDeferred.done(t.proxy(function(){this.iframeWindow.postMessage(JSON.stringify({action:"load",data:this.element.val()}),"*"),N2Classes.AjaxHelper.stopLoading()},this))},i.prototype.removeLightbox=function(){this.$lightbox.remove(),this.$lightbox=null,window.removeEventListener("message",this.onMessage,!1)},i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation();var e=this.element.val().split("|*|");e[2]="",this.val(e.join("|*|"))},i.prototype.save=function(t,e){this.val(e)},i.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},i.prototype.updateName=function(t){var e="";try{var i=JSON.parse(t);e=0==i?n2_("Disabled"):n2_("Enabled")}catch(n){e=n2_("Disabled")}this.name.val(e)},i}),N2D("FormElementPostAnimationManager",["FormElementAnimationManager"],function(t,e){function i(){this.empty=!0,N2Classes.FormElementAnimationManager.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElementAnimationManager.prototype),i.prototype.constructor=i,i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation();var e=this.element.val().split("|*|");e[2]="",this.val(e.join("|*|"))},i.prototype.updateName=function(t){var e=t.split("|*|");t=e[2],""===t?(this.empty=!0,t=n2_("Disabled")):t.split("||").length>1?(this.empty=!1,t=n2_("Multiple animations")):(this.empty=!1,t=n2_("Single animation")),this.name.val(t)},i.prototype.relatedFieldsOff=function(){return this.empty},i}),N2D("FormElementShapeDividerManager",["FormElement"],function(t,e){function i(e){this.element=t("#"+e),this.element.parent().on("click",t.proxy(this.show,this)),this.element.siblings(".n2-form-element-clear").on("click",t.proxy(this.clear,this)),this.name=this.element.siblings("input"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.apply(this,arguments),this.form=t("#n2-ss-edit-slider-form"),this.formAction=this.form.attr("action"),this.onMessage=t.proxy(function(t){if(t.source==this.iframeWindow)try{var e=JSON.parse(t.data);switch(e.action){case"ready":this.iframeReadyDeferred.resolve();break;case"save":this.val(e.data),this.removeLightbox();break;default:this.removeLightbox()}}catch(i){console.error(i),this.removeLightbox()}},this)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.show=function(e){e.preventDefault(),N2Classes.AjaxHelper.startLoading(),this.iframeReadyDeferred=t.Deferred(),this.$lightbox=t('<div class="n2 n2-lightbox-container"></div>').css({display:"block"}).appendTo("body");var i=t('<div class="n2-lightbox n2-border-radius"></div>').appendTo(this.$lightbox),n=t('<iframe name="n2-ss-shapedividerframe" style="width:100%;height:100%;"/>').appendTo(i);this.form.attr({action:N2Classes.AjaxHelper.makeFallbackUrl(window.location.href,{nextendaction:"shapedivider"}),target:"n2-ss-shapedividerframe"}).submit().attr({action:this.formAction,target:null}),this.iframeWindow=n[0].contentWindow||n[0].contentDocument,window.addEventListener("message",this.onMessage,!1),this.iframeReadyDeferred.done(t.proxy(function(){this.iframeWindow.postMessage(JSON.stringify({action:"load",data:this.element.val()}),"*"),N2Classes.AjaxHelper.stopLoading()},this))},i.prototype.removeLightbox=function(){this.$lightbox.remove(),this.$lightbox=null,window.removeEventListener("message",this.onMessage,!1)},i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation();var e=this.element.val().split("|*|");e[2]="",this.val(e.join("|*|"))},i.prototype.save=function(t,e){this.val(e)},i.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},i.prototype.updateName=function(t){var e="";try{var i=JSON.parse(t);i.top&&i.bottom?e=n2_("Top and bottom"):i.top?e=n2_("Top"):i.bottom&&(e=n2_("Bottom"))}catch(n){e=n2_("Disabled")}this.name.val(e)},i}),N2D("FormElementSliderType",function(t,e){function i(e){this.element=t("#"+e),this.setAttribute(),this.element.on("nextendChange",t.proxy(this.setAttribute,this))}return i.prototype.setAttribute=function(){var e=this.element.val();t("#n2-admin").data("slider-type",e).attr("data-slider-type",e),"block"===this.element.val()&&t(".n2-fm-shadow").trigger("click")},i}),N2D("FormElementSliderWidgetArea",["FormElement"],function(t,e){function i(e){this.element=t("#"+e),this.area=t("#"+e+"_area"),this.areas=this.area.find(".n2-area"),this.areas.on("click",t.proxy(this.chooseArea,this)),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.chooseArea=function(e){var i=parseInt(t(e.target).data("area"));this.element.val(i),this.setSelected(i),this.triggerOutsideChange()},i.prototype.insideChange=function(t){t=parseInt(t),this.element.val(t),this.setSelected(t),this.triggerInsideChange()},i.prototype.setSelected=function(t){this.areas.removeClass("n2-active"),this.areas.eq(t-1).addClass("n2-active")},i}),N2D("FormElementSplitTextAnimationManager",["FormElement"],function(t,e){function i(e,i){this.element=t("#"+e),this.parameters=i,this.element.parent().on("click",t.proxy(this.show,this)),this.element.siblings(".n2-form-element-clear").on("click",t.proxy(this.clear,this)),this.name=this.element.siblings("input"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.show=function(e){e.preventDefault(),this.parameters.font&&nextend.splittextanimationManager.setConnectedFont(this.parameters.font),this.parameters.style&&nextend.splittextanimationManager.setConnectedStyle(this.parameters.style),nextend.splittextanimationManager.show(this.element.val(),t.proxy(this.save,this),{previewMode:"0",previewHTML:this.parameters.preview,group:this.parameters.group,transformOrigin:t("#"+this.parameters.transformOrigin)})},i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation(),this.val("")},i.prototype.save=function(t,e){this.val(e)},i.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},i.prototype.updateName=function(e){t.when(nextend.splittextanimationManager.getVisual(e)).done(t.proxy(function(t){this.name.val(t.name)},this))},i}),N2D("FormElementWidgetPosition",function(t,e){function i(e){this.element=t("#"+e+"-mode"),this.container=this.element.closest(".n2-form-element-mixed"),this.tabs=this.container.find("> .n2-mixed-group"),this.element.on("nextendChange",t.proxy(this.onChange,this)),this.onChange()}return i.prototype.onChange=function(){var t=this.element.val();"advanced"===t?(this.tabs.eq(2).css("display",""),this.tabs.eq(1).css("display","none")):(this.tabs.eq(1).css("display",""),this.tabs.eq(2).css("display","none"))},i}),N2D("SmartSliderGeneratorRecords",function(t,e){function i(e){this.ajaxUrl=e,t("#generatorrecord-viewer").on("click",t.proxy(this.showRecords,this))}return i.prototype.showRecords=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.ajaxUrl,data:t("#smartslider-form").serialize(),dataType:"json"}).done(function(t){var e=new N2Classes.NextendModal({zero:{size:[1300,700],title:"Records",content:t.data.html}},!0);e.content.css("overflow","auto")}).error(function(t){if(200==t.status){var e=new N2Classes.NextendModal({zero:{size:[1300,700],title:"Response",content:t.responseText}},!0);e.content.css("overflow","auto")}})},i}),N2D("FormElementDribbbleProjects",function(t,e){function i(e,i){this.element=t("#"+e),this.select=this.element.parent().find("select"),this.relatedField=t("#generatordribbble-user-id").on("nextendChange",t.proxy(this.refreshList,this)),this.url=i}return i.prototype.refreshList=function(e){N2Classes.AjaxHelper.ajax({url:this.url,data:{
method:"getProjects",userID:this.relatedField.val()}}).done(t.proxy(function(t){if(0!=t.data.length){this.select.find("option").remove();for(var e in t.data)this.select.append('<option value="'+e+'">'+t.data[e]+"</option>");this.select.val(this.select.find("option:first").val()).trigger("change")}},this))},i}),N2D("FormElementDribbbleToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1e3,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"YouTube authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementFacebookAlbums",function(t,e){function i(e,i){this.element=t("#"+e),this.select=this.element.parent().find("select"),this.relatedField=t("#generatorfacebook-id").on("nextendChange",t.proxy(this.refreshList,this)),this.url=i}return i.prototype.refreshList=function(e){N2Classes.AjaxHelper.ajax({url:this.url,data:{method:"getAlbums",facebookID:this.relatedField.val()}}).done(t.proxy(function(t){this.select.find("option").remove();for(var e in t.data)this.select.append('<option value="'+e+'">'+t.data[e]+"</option>");this.select.val(this.select.find("option:first").val()).trigger("change")},this))},i}),N2D("FormElementFacebookToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=600,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Facebook authentication","width="+e+",height="+i+",toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementFlickrToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1200,i=1e3,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Flickr authentication","width="+e+",height="+i+",toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementInstagramToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=580,i=400,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Instagram authentication","width=580,height=400,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementPicasaToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1e3,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Picasa authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementTwitterToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1e3,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Twitter authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("FormElementVimeoToken",[],[],function(t,e,i){function n(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return n.prototype.requestToken=function(e){e.preventDefault(),AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1e3,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"Vimeo authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},n}),N2D("FormElementYouTubePlaylists",function(t,e,i){function n(e,i){this.element=t("#"+e),this.select=this.element.parent().find("select"),this.relatedField=t("#generatorchannel-id").on("nextendChange",t.proxy(this.refreshList,this)),this.url=i}return n.prototype.refreshList=function(e){N2Classes.AjaxHelper.ajax({url:this.url,data:{method:"getPlayListsAjax",channelID:this.relatedField.val()}}).done(t.proxy(function(t){this.select.find("option").remove();for(var e in t.data)this.select.append('<option value="'+e+'">'+t.data[e]+"</option>");this.select.val(this.select.find("option:first").val()).trigger("change")},this))},n}),N2D("FormElementYoutubeToken",function(t,e){function i(e,i,n){this.element=t("#"+e),this.button=t("#"+e+"_button").on("click",t.proxy(this.requestToken,this)),this.url=i,t("#generatorcallback").html(n)}return i.prototype.requestToken=function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:t("#smartslider-form").serialize()}).done(function(t){var e=1e3,i=600,n=(screen.width-e)/2,s=(screen.height-i)/2;window.open(t.data.authUrl,"YouTube authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+n+",top="+s)})},i}),N2D("QuickSlides",function(t,e){function i(e){var i=t("#n2-quick-slides-edit");i.length<1||(this.ajaxUrl=e,i.on("click",t.proxy(this.openEdit,this)))}return i.prototype.openEdit=function(e){e.preventDefault();var i=t("#n2-ss-slides .n2-box-slide"),n=this;this.modal=new N2Classes.NextendModal({zero:{fit:!0,fitX:!1,overflow:"auto",size:[1200,700],title:n2_("Quick Edit - Slides"),back:!1,close:!0,content:'<form class="n2-form"><table></table></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Save")+"</a>"],fn:{show:function(){var e=this.controls.find(".n2-button-green"),s=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),e.trigger("click")}),o=s.find("table");i.each(t.proxy(function(e,i){var s=t(i),r=t("<tr />").appendTo(o),a=s.data("slideid");r.append(t("<td />").append('<img src="'+s.data("image")+'" style="width:100px;"/>')),r.append(t("<td />").append(n.createInput(n2_("Name"),"title-"+a,s.data("title"),"width: 240px;"))),r.append(t("<td />").append(n.createTextarea(n2_("Description"),"description-"+a,s.data("description"),"width: 330px;height:24px;")));var l=s.data("link").split("|*|");r.append(t("<td />").append(n.createLink(n2_("Link"),"link-"+a,l[0],"width: 180px;"))),r.append(t("<td />").append(n.createTarget(n2_("Target window"),"target-"+a,l.length>1?l[1]:"_self",""))),new N2Classes.FormElementUrl("link-"+a,nextend.NextendElementUrlParams)},this)),e.on("click",t.proxy(function(e){var s={};i.each(t.proxy(function(e,i){var n=t(i),o=n.data("slideid"),r=t("#title-"+o).val(),a=t("#description-"+o).val(),l=t("#link-"+o).val()+"|*|"+t("#target-"+o).val();r==n.data("title")&&a==n.data("description")&&l==n.data("link")||(s[o]={name:r,description:a,link:l})},this)),jQuery.isEmptyObject(s)?this.hide(e):(this.hide(e),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(n.ajaxUrl),data:{changed:N2Classes.Base64.encode(JSON.stringify(s))},dataType:"json"}).done(t.proxy(function(e){var i=e.data;for(var n in i){var s=t('.n2-box-slide[data-slideid="'+n+'"]');s.find(".n2-box-placeholder a.n2-h4").html(i[n].title),s.attr("data-title",i[n].rawTitle),s.data("title",i[n].rawTitle),s.attr("data-description",i[n].rawDescription),s.data("description",i[n].rawDescription),s.attr("data-link",i[n].rawLink),s.data("link",i[n].rawLink)}},this)))},this))}}}}),this.modal.setCustomClass("n2-ss-quick-slides-edit-modal"),this.modal.show()},i.prototype.createInput=function(e,i,n){var s="";4==arguments.length&&(s=arguments[3]);var o=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-text n2-border-radius"><input type="text" id="'+i+'" class="n2-h5" autocomplete="off" style="'+s+'"></div></div></div></div>');return o.find("input").val(n),o},i.prototype.createTextarea=function(e,i,n){var s="";4==arguments.length&&(s=arguments[3]);var o=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-textarea n2-border-radius"><textarea id="'+i+'" class="n2-h5" autocomplete="off" style="resize:y;'+s+'"></textarea></div></div></div></div>');return o.find("textarea").val(n),o},i.prototype.createLink=function(e,i,n){var s="";4==arguments.length&&(s=arguments[3]);var o=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-text n2-border-radius"><input type="text" id="'+i+'" class="n2-h5" autocomplete="off" style="'+s+'"><a href="#" class="n2-form-element-clear"><i class="n2-i n2-it n2-i-empty n2-i-grey-opacity"></i></a><a id="'+i+'_button" class="n2-form-element-button n2-h5 n2-uc" href="#">Link</a></div></div></div></div>');return o.find("input").val(n),o},i.prototype.createTarget=function(e,i,n){var s="";4==arguments.length&&(s=arguments[3]);var o=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select id="'+i+'" autocomplete="off" style="'+s+'"><option value="_self">Self</option><option value="_blank">Blank</option></select></div></div></div></div>');return o.find("select").val(n),o},i}),N2D("Slide",function(t,e){function i(e,i){this.selected=!1,this.manager=e,this.box=i.data("slide",this).addClass("n2-clickable"),this.box.on("mouseenter",t.proxy(function(){this.manager.showMenu(this)},this)).on("mouseleave",t.proxy(function(){this.manager.hideMenu()},this)).on("click.n2-slide",t.proxy(this.goToEdit,this)),this.publishElement=this.box.find(".n2-slide-published").on("click",t.proxy(this.switchPublished,this)),this.box.find(".n2-ss-box-select").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()},this))}return i.prototype.getId=function(){return this.box.data("slideid")},i.prototype.setFirst=function(e){e.stopPropagation(),e.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendaction:"first"}),type:"POST",data:{id:this.getId()}}).done(t.proxy(function(){this.manager.unsetFirst(),this.box.addClass("n2-slide-state-first")},this))},i.prototype.unsetFirst=function(){this.box.removeClass("n2-slide-state-first")},i.prototype.switchPublished=function(t){t.stopPropagation(),t.preventDefault(),this.isPublished()?this.manager.unPublishSlides([this.getId()],[this]):this.manager.publishSlides([this.getId()],[this])},i.prototype.isPublished=function(){return this.box.hasClass("n2-slide-state-published")},i.prototype.published=function(){this.box.addClass("n2-slide-state-published")},i.prototype.unPublished=function(){this.box.removeClass("n2-slide-state-published")},i.prototype.goToEdit=function(e,i){if(this.manager.isBulkSelection)this.invertSelection(),e.preventDefault();else if("A"!==e.target.tagName){var n=this.box.data("editurl");"undefined"!=typeof i&&i?window.open(n,"_blank"):n===location.href?t("#n2-admin").toggleClass("n2-ss-slides-outer-container-visible"):window.location=n}},i.prototype.duplicate=function(e){e.stopPropagation(),e.preventDefault();var n=t.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendaction:"duplicate"})}).done(t.proxy(function(e){var s=t(e.data).insertAfter(this.box),o=new i(this.manager,s);this.manager.initSlides(),n.resolve(o)},this)),n},i.prototype["delete"]=function(t){t.stopPropagation(),t.preventDefault(),this.manager.deleteSlides([this.getId()],[this])},i.prototype.deleted=function(){this.box.remove()},i.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},i.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2-selected"),this.manager.addSelection(this))},i.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2-selected"),this.manager.removeSelection(this))},i.prototype.publish=function(t){this.switchPublished(t)},i.prototype.unpublish=function(t){this.switchPublished(t)},i.prototype.generator=function(t){window.location=this.box.data("generator")},i.prototype.copy=function(e){this.manager.showSliderSelector(n2_("Copy slide to ..."),t.proxy(function(t){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendaction:"copy",targetSliderID:t.sliderID})})},this))},i}),N2D("SlidesManager",function(t,e){function i(i,n,s,o,r,a){this.quickPostModal=null,this.quickVideoModal=null,this.parameters=s,this.slides=[],this.ajaxUrl=i,this.contentAjaxUrl=n,this.slidesPanel=t("#n2-ss-slides-container"),this.slidesContainer=this.slidesPanel.find(".n2-ss-slides-container"),this.initMenu(),this.initSlidesOrderable();for(var l=this.slidesContainer.find(".n2-box-slide"),d=0;d<l.length;d++)this.slides.push(new N2Classes.Slide(this,l.eq(d)));if(t("body").attr("data-slides",this.slides.length),t("#n2-ss-slides").find(".n2-ss-slides-create-action-box").on("mouseup",t.proxy(function(i){i.preventDefault();var n=0;if(i.which!==e&&(n=i.which),2>=n)switch(t(i.currentTarget).data("action")){case"image":this.addQuickImage(i);break;case"video":this.addQuickVideo(i);break;case"post":this.addQuickPost(i);break;case"library":case"empty":case"static":case"dynamic":2===n?window.open(t(i.currentTarget).data("href"),"_blank").focus():window.location=t(i.currentTarget).data("href")}},this)),t(".n2-box-slide-dummy").on("click",t.proxy(this.addQuickImage,this)),t(".n2-box-add-sample-slide a").on("click",t.proxy(function(e){e.preventDefault(),N2Classes.License.get().isActiveAsync().done(t.proxy(function(){window.location.href=t(e.target).attr("href")},this))},this)),this.initBulk(),!o){var h=[];this.slidesContainer.nUIFileUpload({url:r,pasteZone:!1,dataType:"json",paramName:"image",dropZone:t(".n2-ss-slides-outer-container"),add:t.proxy(function(t,e){e.formData={path:"/"+a},e.submit()},this),done:t.proxy(function(t,e){var i=e.result;i.data&&i.data.name?h.push({title:i.data.name.replace(/\.[^\/.]+$/,""),description:"",image:i.data.url}):N2Classes.AjaxHelper.notification(i)},this),fail:t.proxy(function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},this),start:function(){N2Classes.AjaxHelper.startLoading()},stop:t.proxy(function(){h.length?this._addQuickImages(h):setTimeout(function(){N2Classes.AjaxHelper.stopLoading()},100),h=[]},this)});var p=null;this.slidesContainer.on("dragover",t.proxy(function(e){null!==p?(clearTimeout(p),p=null):this.slidesContainer.addClass("n2-drag-over"),p=setTimeout(t.proxy(function(){this.slidesContainer.removeClass("n2-drag-over"),p=null},this),400)},this))}}return i.prototype.changed=function(){},i.prototype.initSlidesOrderable=function(){this.slidesContainer.nUISortable({items:".n2-box-slide",stop:t.proxy(this.saveSlideOrder,this),placeholder:"n2-box-sortable-placeholder n2-box-sortable-placeholder-small",distance:10,helper:"clone"})},i.prototype.saveSlideOrder=function(e){for(var i=this.slidesContainer.find(".n2-box-slide"),n=[],s=[],o=[],r=0;r<i.length;r++){var a=i.eq(r).data("slide");n.push(a),s.push(a.getId())}for(var r=0;r<this.slides.length;r++)o.push(this.slides[r].getId());if(JSON.stringify(o)!=JSON.stringify(s)){t(window).triggerHandler("SmartSliderSidebarSlidesOrderChanged");var l={nextendcontroller:"slides",nextendaction:"order"};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,l),data:{slideorder:s}}),this.slides=n,this.changed()}},i.prototype.initSlides=function(){for(var e=this.slidesContainer.find(".n2-box-slide"),i=[],n=0;n<e.length;n++){var s=e.eq(n).data("slide");i.push(s)}this.slides=i,this.changed(),t(window).triggerHandler("SmartSliderSidebarSlidesChanged"),t("body").attr("data-slides",this.slides.length)},i.prototype.unsetFirst=function(){for(var t=0;t<this.slides.length;t++)this.slides[t].unsetFirst();this.changed()},i.prototype.addQuickImage=function(e){e.preventDefault(),nextend.imageHelper.openMultipleLightbox(t.proxy(this._addQuickImages,this))},i.prototype.addBoxes=function(e){e.insertBefore(this.slidesContainer.find(".n2-clear")),e.addClass("n2-ss-box-just-added").each(t.proxy(function(e,i){new N2Classes.Slide(this,t(i))},this)),this.initSlides(),setTimeout(function(){e.removeClass("n2-ss-box-just-added")},200)},i.prototype._addQuickImages=function(e){for(var i=[],n=0;n<e.length;n++)e[n].image.match(/\.(mp4)/i)?this._addQuickVideo(null,{type:"video",title:e[n].title,description:e[n].description,video:e[n].image,image:""}):i.push(e[n]);i.length&&N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickImages"}),data:{images:N2Classes.Base64.encode(JSON.stringify(i))}}).done(t.proxy(function(e){this.addBoxes(t(e.data))},this))},i.prototype.addQuickVideo=function(e){e.preventDefault();var i=this;this.quickVideoModal||(this.quickVideoModal=new N2Classes.NextendModal({zero:{size:[500,360],title:n2_("Add video"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Add video")+"</a>"],fn:{show:function(){var e=this.controls.find(".n2-button"),n=(this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),e.trigger("click")}).append(this.createInput(n2_("Video url"),"n2-slide-video-url","width: 446px;")),this.content.find("#n2-slide-video-url").focus());this.content.append(this.createHeading(n2_("Examples"))),this.content.append(this.createTable([["YouTube","https://www.youtube.com/watch?v=lsq09izc1H4"],["Vimeo","https://vimeo.com/144598279"]],["",""])),e.on("click",t.proxy(t.proxy(function(e){e.preventDefault();var s=n.val(),o=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,r=s.match(o),a=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,l=s.match(a),d=s.match(/\.(mp4)/i);r?N2Classes.AjaxHelper.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+encodeURI(r[2])+"&part=snippet&key=AIzaSyC3AolfvPAPlJs-2FgyPJdEEKS6nbPHdSM").done(t.proxy(function(t){if(t.items.length){var e=t.items[0].snippet,n=t.items[0].snippet.thumbnails,o=n.maxres||n.standard||n.high||n.medium||n["default"];i._addQuickVideo(this,{type:"youtube",title:e.title,description:e.description,image:o.url,video:s})}},this)).fail(function(t){N2Classes.Notification.error(t.error.errors[0].message)}):l?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+l[3]+".json").done(t.proxy(function(t){i._addQuickVideo(this,{type:"vimeo",title:t[0].title,description:t[0].description,video:l[3],image:t[0].thumbnail_large})},this)).fail(function(t){N2Classes.Notification.error(t.responseText)}):d?i._addQuickVideo(this,{type:"video",title:s,description:"",video:s,image:""}):N2Classes.Notification.error("This video url is not supported!")},this)))}}}})),this.quickVideoModal.show()},i.prototype._addQuickVideo=function(e,i){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickVideo"}),data:{video:N2Classes.Base64.encode(encodeURIComponent(JSON.stringify(i)))}}).done(t.proxy(function(e){this.addBoxes(t(e.data)),this.initSlides()},this)),e&&e.hide()},i.prototype.addQuickPost=function(e){if(e.preventDefault(),!this.quickPostModal){var i=this,n={},s=t.proxy(function(t){return"undefined"==typeof n[t]&&(n[t]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.contentAjaxUrl),data:{keyword:t},dataType:"json"})),n[t]},this);this.quickPostModal=new N2Classes.NextendModal({zero:{size:[600,430],title:n2_("Add post"),back:!1,close:!0,content:'<div class="n2-form"></div>',fn:{show:function(){this.content.find(".n2-form").append(this.createInput(n2_("Keyword"),"n2-ss-keyword","width:546px;"));var e=t("#n2-ss-keyword"),n=this.createHeading("").appendTo(this.content),o=this.createResult().appendTo(this.content),r="";e.on("keyup",t.proxy(function(){r=e.val(),s(r).done(t.proxy(function(s){if(e.val()==r){""==r?n.html(n2_("No search term specified. Showing recent items.")):n.html(n2_printf(n2_('Showing items match for "%s"'),r));for(var a=s.data,l=[],d=this,h=0;h<a.length;h++)l.push([a[h].title,a[h].info,t('<div class="n2-button n2-button-normal n2-button-xs n2-button-green n2-radius-s n2-uc n2-h5">'+n2_("Select")+"</div>").on("click",{post:a[h]},function(t){i._addQuickPost(d,t.data.post)})]);o.html(""),this.createTable(l,["width:100%;","",""]).appendTo(this.createTableWrap().appendTo(o))}},this))},this)).trigger("keyup").focus()}}}})}this.quickPostModal.show()},i.prototype._addQuickPost=function(e,i){i.image||(i.image=""),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickPost"}),data:{post:i}}).done(t.proxy(function(e){this.addBoxes(t(e.data)),this.initSlides()},this)),e.hide()},i.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1;var e=t(".n2-bulk-select").find("a");e.eq(0).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.select()})},this)),e.eq(1).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.deSelect()})},this)),e.eq(2).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.box.hasClass("n2-slide-state-published")?t.select():t.deSelect()})},this)),e.eq(3).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.box.hasClass("n2-slide-state-published")?t.deSelect():t.select()})},this)),t(".n2-bulk-actions a").on("click",t.proxy(function(e){var i=t(e.currentTarget).data("action");i&&(e.preventDefault(),this.bulkAction(i))},this))},i.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},i.prototype.removeSelection=function(e){this.selection.splice(t.inArray(e,this.selection),1),0==this.selection.length&&this.leaveBulk()},i.prototype.bulkSelect=function(t){for(var e=0;e<this.slides.length;e++)t(this.slides[e])},i.prototype.bulkAction=function(t){var e=[],i=[];this.bulkSelect(function(t){t.selected&&(e.push(t),i.push(t.getId()))}),i.length?this[t](i,e):N2Classes.Notification.notice("Please select one or more slides for the action!")},i.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.slidesContainer.nUISortable("option","disabled",!0),t("#n2-admin").addClass("n2-ss-has-box-selection"))},i.prototype.leaveBulk=function(){if(this.isBulkSelection){this.slidesContainer.nUISortable("option","disabled",!1),t("#n2-admin").removeClass("n2-ss-has-box-selection");for(var e=0;e<this.slides.length;e++)this.slides[e].deSelect();this.selection=[],this.isBulkSelection=!1}},i.prototype.deleteSlides=function(e,i){this.hideMenu();var n=i[0].box.find(".n2-box-placeholder-title a").text();i.length>1&&(n+=" and "+(i.length-1)+" more"),N2Classes.NextendModal.deleteModal("slide-delete",n,t.proxy(function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"delete"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSlides(),this.leaveBulk()},this))},this))},i.prototype.duplicateSlides=function(e,i){for(var n=0;n<this.slides.length;n++)this.slides[n].selected&&this.slides[n].duplicate(t.Event("click",{currentTarget:null}))},i.prototype.copySlides=function(e,i){this.showSliderSelector(n2_("Copy slide to ..."),t.proxy(function(t){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"copySlides",targetSliderID:t.sliderID}),type:"POST",data:{slides:e}})},this))},i.prototype.publishSlides=function(e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"publish"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].published();this.changed()},this))},i.prototype.unPublishSlides=function(e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"unpublish"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].unPublished();this.changed()},this))},i.prototype.initMenu=function(){this.slide=null,this.menu=t("#n2-ss-slide-menu").detach().addClass("n2-inited"),this.menu.find("li").on("click",t.proxy(function(e){e.stopPropagation();var i=t(e.currentTarget).data("action");i&&"function"==typeof this.slide[i]&&this.slide[i](e),this.menu.removeClass("n2-active").off("mouseleave")},this)),this.menu.find(".n2-button").on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.menu.hasClass("n2-active")?this.menu.removeClass("n2-active").off("mouseleave"):this.menu.addClass("n2-active").on("mouseleave",function(){t(this).removeClass("n2-active")})},this))},i.prototype.showMenu=function(t){this.slide=t,this.menu.appendTo(t.box)},i.prototype.hideMenu=function(){this.menu.detach()},i.prototype.showSliderSelector=function(e,i){var n=N2Classes.AjaxHelper.makeFallbackUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"choose"});this.sliderSelectorModal=new N2Classes.NextendModal({zero:{size:[970,600],title:e,back:!1,close:!0,content:"",fn:{show:function(){var e=t('<iframe src="'+n+'" width="970" height="540" style="margin: 0 -20px 0 -20px;"></iframe>').appendTo(this.content),s=window.addEventListener?"addEventListener":"attachEvent";window[s]("attachEvent"==s?"onmessage":"message",t.proxy(function(t){if(t.source==(e[0].contentWindow||e[0].contentDocument)){var n=t[t.message?"message":"data"];try{n=JSON.parse(n),n.action&&"ss3embed"===n.action&&i(n)}catch(s){}this.hide()}},this),!1)},destroy:function(){this.destroy()}}}},!0)},i}),N2D("SmartSliderSlideBackgroundAdmin",["SmartSliderSlideBackground"],function(t,e){function i(t,e,i){this.types={color:"SmartSliderAdminSlideBackgroundColor",image:"SmartSliderAdminSlideBackgroundImage",video:"SmartSliderAdminSlideBackgroundVideo"},this.allowVisualLoad=!0,this.slider=t.slider,this.editor=nextend.currentEditor,N2Classes.SmartSliderSlideBackground.prototype.constructor.call(this,t,e,i)}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackground.prototype),i.prototype.constructor=i,i.prototype.setVisualLoad=function(t){this.allowVisualLoad=t},i.prototype.setType=function(t){"color"===t?(this.elements.color||this.createColorElement(!0),this.elements.image&&(this.elements.image.kill(),this.elements.image=!1),this.elements.video&&(this.elements.video.kill(),this.elements.video=!1)):"image"===t?(this.elements.color||this.createColorElement(!0),this.elements.image||this.createImageElement(),this.elements.video&&(this.elements.video.kill(),this.elements.video=!1)):"video"===t&&(this.elements.image&&(this.elements.image.kill(),this.elements.image=!1),this.elements.color||this.createColorElement(!0),this.elements.video||this.createVideoElement())},i.prototype.setMode=function(t){"default"===t&&(t=this.slider.editor.options.slideBackgroundMode),this.element.attr("data-mode",t),this.elements.image&&this.elements.image.updateMode(t,this.mode),this.mode=t},i.prototype.setFocus=function(t,e){this.elements.image&&this.elements.image.updateFocus(t,e)},i.prototype.setImageOpacity=function(t){this.elements.image&&this.elements.image.updateOpacity(t)},i.prototype.setBlur=function(t){this.elements.image&&this.elements.image.updateBlur(t)},i.prototype.createColorElement=function(e){e=e||!1,this.elements.color=new N2Classes[this.types.color](this,t('<div class="n2-ss-slide-background-color"></div>').appendTo(this.$wrapElement)),e&&this.elements.color.update(this.editor.settings.getBackgroundColor(),this.editor.settings.getBackgroundGradient(),this.editor.settings.getBackgroundColorEnd())},i.prototype.updateColor=function(t,e,i){this.elements.color||this.createColorElement(),this.elements.color.update(t,e,i)},i.prototype.createImageElement=function(){var e=this.editor.settings,i=e.getBackgroundImage();if(""!==i){var n=nextend.imageHelper.fixed(i),s=t('<img src="'+n+'" alt="" />').attr({"data-hash":md5(i),"data-desktop":n,"data-opacity":e.getBackgroundImageOpacity(),"data-blur":e.getBackgroundImageBlur(),"data-x":e.getBackgroundFocusX(),"data-y":e.getBackgroundFocusY()}).appendTo(this.$wrapElement);this.elements.image=new N2Classes[this.types.image](this.slide,this.manager,this,s),this.elements.image.preLoadAdmin(i)}},i.prototype.setImage=function(t){this.elements.image?this.elements.image.setDesktopSrc(t):""!==t&&"image"===this.editor.settings.getType()&&this.createImageElement(t)},i.prototype.createVideoElement=function(){var e=this.editor.settings.getBackgroundVideo();if(""!==e){var i=t('<video muted loop preload="auto" playsinline="playsinline" webkit-playsinline="webkit-playsinline"></video>').attr({"class":"n2-ss-slide-background-video n2-ow n2-active","data-mode":this.editor.settings.getBackgroundVideoMode()}).append('<source src="'+e+'" type="video/mp4">').appendTo(this.$wrapElement);this.elements.video=new N2Classes[this.types.video](this.slide,this,i),this.elements.video.updateOpacity(this.editor.settings.getBackgroundVideoOpacity())}},i.prototype.setVideo=function(){this.elements.video&&this.elements.video.kill(),this.createVideoElement()},i.prototype.setVideoMode=function(t){this.elements.video&&this.elements.video.updateVideoMode(t)},i.prototype.setVideoOpacity=function(t){this.elements.video&&this.elements.video.updateOpacity(t)},i}),N2D("EditorAbstract",function(t,e){function i(e,i,s){n(),this.readyDeferred=t.Deferred(),this.sliderElementID=e,this.slideContentElementID=i,this.readyDeferred.done(t.proxy(function(){N2D("SSEditor",t.proxy(function(){return this},this))},this)),this.options=t.extend({slideAsFile:0,isUploadDisabled:!0,uploadUrl:"",uploadDir:""},s),nextend.currentEditor=this,this.frontend=null,this.generator=null,this.fragmentEditor=null,this.$editedElement=null,this.editedInstance=null,N2R("documentReady",t.proxy(function(t){"undefined"!=typeof nextend.fontsDeferred?nextend.fontsDeferred.done(t.proxy(this.startEditor,this)):this.startEditor()},this))}function n(){var t=s();t&&10>t&&alert(window.ss2lang.The_editor_was_tested_under_Internet_Explorer_10_Firefox_and_Chrome_Please_use_one_of_the_tested_browser)}function s(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")?parseInt(t.split("msie")[1]):!1}return i.prototype.startEditor=function(){},i.prototype.ready=function(t){this.readyDeferred.done(t);
},i.prototype.getSelf=function(){return this},i.prototype.getAvailableDeviceModes=function(){return{desktopPortrait:1,desktopLandscape:0,tabletPortrait:1,tabletLandscape:1,mobilePortrait:1,mobileLandscape:1}},i.prototype.getGeneratorVariables=function(){return this.$editedElement.data("variables")},i.prototype.getMainContainerElement=function(){return this.$editedElement.find(".n2-ss-layers-container").addBack().last()},i}),N2D("EditorSlide",["EditorAbstract"],function(t,e){function i(e,i,n){N2Classes.EditorAbstract.prototype.constructor.call(this,e,i,t.extend({isAddSample:!1,slideBackgroundMode:"fill"},n))}return i.prototype=Object.create(N2Classes.EditorAbstract.prototype),i.prototype.constructor=i,i.prototype.startEditor=function(){this.$slideContentElement=t("#"+this.slideContentElementID),this.slideStartValue=this.$slideContentElement.val(),N2R("#"+this.sliderElementID,t.proxy(function(t,e){this.frontend=e,this.frontend.editor=this,nextend.pre="div#"+this.frontend.elementID+" ",this.frontend.visible(t.proxy(this.sliderStarted,this))},this))},i.prototype.sliderStarted=function(){t("body").addClass("n2-ss-slider-visible");var e=t("#n2-ss-slide-canvas-container"),i=e.tinyscrollbar({axis:"x",wheel:!1,wheelLock:!1}).data("plugin_tinyscrollbar");"function"==typeof e.get(0).move&&(e.get(0).move=null),this.frontend.sliderElement.on("SliderResize",function(){i.update("relative")}),this.$editedElement=this.frontend.sliderElement.find(".n2-ss-currently-edited-slide"),this.editedInstance=this.$editedElement.data("slide");var n=this.$editedElement.hasClass("n2-ss-static-slide");this.generator=new N2Classes.Generator(this),this.generator.registerFields(["#slidetitle","#sldedescription","#slidethumbnail","#slidebackgroundImage","#slidebackgroundAlt","#slidebackgroundTitle","#slidebackgroundVideoMp4","#slidebackgroundColor","#slidebackgroundColorEnd","#linkslidelink-1","#layergenerator-visible","#layergroup-generator-visible"]),this.generator.registerGlobalField("slide","name","#slidetitle"),this.generator.registerGlobalField("slide","description","#slidedescription"),this.getMainContainerElement().on("updateSize",t.proxy(this.updateSize,this)),this.settings=new N2Classes.SlideSettings(this,n);var s={};n?s.snapSelector=".n2-ss-static-slide .n2-ss-layer.nui-resizable:not(.n2-ss-layer-locked):not(.n2-ss-layer-parent):not(.n2-ss-layer-selected):visible, .n2-ruler-user-guide":s.snapSelector=".n2-ss-slide.n2-ss-slide-active .n2-ss-layer.nui-resizable:not(.n2-ss-layer-locked):not(.n2-ss-layer-parent):not(.n2-ss-layer-selected):visible, .n2-ruler-user-guide",this.fragmentEditor=new N2Classes.FragmentEditor(this,this.getFrontendSlide().$element,s,this.options),this.getFrontendElement().on({SliderResize:t.proxy(this.fragmentEditor.onResize,this.fragmentEditor),SliderDeviceOrientation:t.proxy(this.fragmentEditor.onChangeDeviceOrientation,this.fragmentEditor)}),this.readyDeferred.resolve(),t("#smartslider-form").on({checkChanged:t.proxy(this.prepareFormForCheck,this),submit:t.proxy(this.onSlideSubmit,this)}),this.options.isAddSample&&this.startSampleSlides()},i.prototype.prepareFormForCheck=function(){var t=JSON.stringify(this.fragmentEditor.getData()),e=JSON.stringify(JSON.parse(N2Classes.Base64.decode(this.slideStartValue)));this.$slideContentElement.val(e==t?this.slideStartValue:N2Classes.Base64.encode(t))},i.prototype.onSlideSubmit=function(i){if(!nextend.isPreview)if(N2Classes.LayerAnimationManager.get().timelineControl.exitPreviewMode(),this.prepareForm(),i.preventDefault(),nextend.askToSave=!1,this.options.slideAsFile&&typeof window.FormData!==e&&"undefined"!=typeof window.File){var n=new FormData,s=t("#smartslider-form").serializeArray();t.each(s,function(t,e){if("slide[slide]"==e.name)try{n.append("slide",new Blob([e.value]),"slide.txt")}catch(i){try{n.append("slide",new Blob([e.value]))}catch(i){try{n.append("slide",new File([e.value],"slide.txt"))}catch(i){N2Classes.Notification.notice('Your browser does not support File api, please disable "Send slide as file" option in the global settings.')}}}else n.append(e.name,e.value)}),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(window.location.href),type:"POST",data:n,contentType:!1,processData:!1}).done(t.proxy(this.afterSave,this))}else N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(window.location.href),data:t("#smartslider-form").serialize(),dataType:"json"}).done(t.proxy(this.afterSave,this))},i.prototype.afterSave=function(){nextend.askToSave=!0,t("#smartslider-form").trigger("saved"),t(".n2-ss-edit-slide-top-details .n2-h1").html(t("#slidetitle").val())},i.prototype.prepareForm=function(){this.fragmentEditor.canvasSettings.ruler&&t("#slideguides").val(N2Classes.Base64.encode(JSON.stringify(this.fragmentEditor.canvasSettings.ruler.toArray()))),this.$slideContentElement.val(N2Classes.Base64.encode(nextend.UnicodeToHTMLEntity(JSON.stringify(this.fragmentEditor.getData()))))},i.prototype.getLayout=function(){for(var e=t("#smartslider-form").serializeArray(),i={},n=0;n<e.length;n++){var s=e[n].name.match(/slide\[(.*?)\]/);s&&(i[s[1]]=e[n].value)}return delete i.generator,delete i.published,delete i.publishdates,delete i["record-start"],delete i["record-slides"],delete i.slide,i.slide=this.fragmentEditor.getData(),i},i.prototype.loadLayout=function(e,i,n){var s=e.slide;if(delete e.slide,n?this.fragmentEditor.importLayers(s,!0):this.fragmentEditor.importLayers(s,!1),i)for(var o in e)t("#slide"+o).val(e[o]).trigger("change");e.slide=s},i.prototype.copy=function(){var e={data:this.settings.getBackgroundData(),layers:this.fragmentEditor.getData()};t.jStorage.set("copiedSlide",JSON.stringify(e))},i.prototype.paste=function(){var e=t.jStorage.get("copiedSlide");e&&(e=JSON.parse(e),this.settings.setData(e.data),this.fragmentEditor.mainContainer.replaceLayers(e.layers))},i.prototype.hasClipboard=function(){var e=t.jStorage.get("copiedSlide");return!!e},i.prototype.startSampleSlides=function(){var i="https://smartslider3.com/slides/"+window.N2SS3VERSION+"/pro2e4G2dR/",n=this,s=window.addEventListener?"addEventListener":"attachEvent",o=t('<iframe src="'+i+'"></iframe>').prependTo(".n2-ss-sample-slides-container"),r=o[0];t("html, body").scrollTop(o.offset().top-t("#wpadminbar").height());var a=t(".n2-ss-sample-slide-settings"),l=t("#slidebackground-type"),d=t("#slidebackgroundImage"),h=t("#n2-ss-sample-slide-setting-background-image").on("click",function(){d.parent().find(".n2-form-element-button").trigger("click")}),p=function(){var t=d.val();""===t?(a.removeClass("n2-ss-has-image"),h.css("background-image","url("+nextend.imageHelper.fixed("$system$/images/placeholder/image.png")+")"),"color"!==l.val()&&l.val("color").trigger("change")):(a.addClass("n2-ss-has-image"),"image"!==l.val()&&l.val("image").trigger("change"),h.css("background-image","url("+nextend.imageHelper.fixed(t)+")"))};h.find(".n2-i-close").on("click",function(t){t.stopPropagation(),d.parent().find(".n2-form-element-clear").trigger("click")}),d.on("nextendChange",p),p();var c=t("#slidebackgroundImageOpacity"),u=t("#n2-ss-sample-slide-setting-opacity-slider").removeAttr("slide").prop("slide",!1).nUISlider({min:0,max:100,step:1,slide:function(t,e){c.data("field").insideChange(e.value)}}),y=function(t){u.nUISlider("option","value",c.val())};c.on("nextendChange",y),y();var g=t("#slidebackgroundImageBlur"),f=t("#n2-ss-sample-slide-setting-blur-slider").removeAttr("slide").prop("slide",!1).nUISlider({min:0,max:40,step:1,slide:function(t,e){g.data("field").insideChange(e.value)}}),m=function(t){f.nUISlider("option","value",g.val())};g.on("nextendChange",m),m();var v=t("#slidebackgroundColor"),b=t("#n2-ss-sample-slide-setting-color").n2spectrum({showAlpha:1,preferredFormat:"hex8",showInput:!1,showButtons:!1,move:function(){var t=b.n2spectrum("get").toHexString8();b.val(t),v.data("field").insideChange(t)},showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:[["000000","55aa39","357cbd","bb4a28","8757b2","000000CC"],["81898d","5cba3c","4594e1","d85935","9e74c2","00000080"],["ced3d5","27ae60","01add3","e79d19","e264af","FFFFFFCC"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0","FFFFFF80"]]}),x=function(t){var e=v.val();e!=b.val()&&b.n2spectrum("set",e)};v.on("nextendChange",x),x();var C=t("#slidebackgroundGradient"),w=function(){"off"==C.val()?a.removeClass("n2-ss-has-gradient"):a.addClass("n2-ss-has-gradient")};C.on("nextendChange",w),w();var S=t("#slidebackgroundColorEnd"),k=t("#n2-ss-sample-slide-setting-gradient").n2spectrum({showAlpha:1,preferredFormat:"hex8",showInput:!1,showButtons:!1,move:function(){var t=k.n2spectrum("get").toHexString8();S.data("field").insideChange(t)},showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:[["000000","55aa39","357cbd","bb4a28","8757b2","000000CC"],["81898d","5cba3c","4594e1","d85935","9e74c2","00000080"],["ced3d5","27ae60","01add3","e79d19","e264af","FFFFFFCC"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0","FFFFFF80"]]}),N=function(t){k.n2spectrum("set",S.val())};S.on("outsideChange",N),N(),window[s]("attachEvent"==s?"onmessage":"message",function(t){if(t.source==(r.contentWindow||r.contentDocument)){var i=t[t.message?"message":"data"];if(i.key)switch(i.key){case"sampleSlide":var s=JSON.parse(i.data);n.settings.setData(s.data,!0),n.fragmentEditor.mainContainer.replaceLayers(s.layers),"content"!=n.fragmentEditor.currentEditorMode&&n.fragmentEditor.mainContent!=e&&n.fragmentEditor.updateEditorMode("content");break;case"ready":(r.contentWindow||r.contentDocument).postMessage({key:"ackReady"},"*"),n.options.isAddSample&&((r.contentWindow||r.contentDocument).postMessage({key:"create"},"*"),n.options.isAddSample=!1)}}},!1)},i.prototype.getAvailableDeviceModes=function(){return this.frontend.responsive.parameters.deviceModes},i.prototype.getSlideBackground=function(){return this.$editedElement.data("slideBackground")},i.prototype.getFrontendElement=function(){return this.frontend.sliderElement},i.prototype.getFrontendSlide=function(){return this.editedInstance},i.prototype.getHorizontalRatio=function(){return this.frontend.responsive.lastRatios.slideW},i.prototype.getVerticalRatio=function(){return this.frontend.responsive.lastRatios.slideH},i.prototype.updateSize=function(){return this.frontend.responsive.doVerticalResize()},i.prototype.getDeviceMode=function(){return this.frontend.responsive.getNormalizedModeString()},i.prototype.setLayersToZero=function(){this.editedInstance.setZero()},i}),N2D("Generator",["EditorAbstract"],function(t,e){"use strict";function i(e){this.editor=e,this._refreshTimeout=null,this.modal=!1,this.group=0,this.editor.generator=this;var i=this.editor.getGeneratorVariables();if(i){this.variables=i;for(var n in this.variables)!isNaN(parseFloat(n))&&isFinite(n)&&(this.group=Math.max(this.group,parseInt(n)+1));this.fill=this.generatorFill,this.group>0&&(this.registerField=this.generatorRegisterField,this.button=t('<a href="#" class="n2-button n2-button-normal n2-button-xs n2-radius-s n2-button-blue n2-h5 n2-uc" style="position:absolute;right: -2px;top: -18px;">Variable</a>').on("click",t.proxy(function(t){t.preventDefault(),this.showModal()},this)),t("body").addClass("n2-ss-dynamic-slide"))}else this.variables=null}return i.prototype.isDynamicSlide=function(){return this.group>0},i.prototype.splitTokens=function(t){for(var e=[],i="",n=0,s=0;s<t.length;s++){var o=t[s];","===o&&0===n?(e.push(i),i=""):(i+=o,"("===o?n++:")"===o&&n--)}return i.length&&e.push(i),e},i.prototype.fill=function(t){return t},i.prototype.generatorFill=function(e){return e.replace(/{((([a-z]+)\(([^}]+)\))|([a-zA-Z0-9][a-zA-Z0-9_\/]*))}/g,t.proxy(this.parseFunction,this))},i.prototype.parseFunction=function(t,e,i,n,s,o){if("undefined"==typeof o){for(var r=this.splitTokens(s),a=0;a<r.length;a++)r[a]=this.parseVariable(r[a]);return"function"==typeof this[n]?this[n].apply(this,r):t}return this.parseVariable(o)},i.prototype.parseVariable=function(t){var e=t.match(/^("|')(.*)("|')$/);if(e)return e[2];var i=t.match(/((([a-z]+)\(([^}]+)\)))/);if(i)return this.parseFunction.apply(this,i);var n=t.match(/([a-zA-Z][0-9a-zA-Z_]*)(\/([0-9a-z]+))?/);if(n){var s=n[3];if("undefined"==typeof s)s=0;else{var o=parseInt(s);isNaN(o)||(s=Math.max(s,1)-1)}return"undefined"!=typeof this.variables[s]&&"undefined"!=typeof this.variables[s][n[1]]?this.variables[s][n[1]]:""}return t},i.prototype.fallback=function(t,e){return""==t?e:t},i.prototype.cleanhtml=function(t){return this.stripTags(t,"<p><a><b><br /><br/><i>")},i.prototype.stripTags=function(t,e){e=(((e||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var i=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,n=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return t.replace(n,"").replace(i,function(t,i){return e.indexOf("<"+i.toLowerCase()+">")>-1?t:""})},i.prototype.removehtml=function(e){return t("<div>"+e+"</div>").text()},i.prototype.splitbychars=function(t,e,i){return t.substr(e,i)},i.prototype.splitbywords=function(t,e,i){var n=t,s=n.length,o=Math.max(0,0==e?0:n.indexOf(" ",e)),r=Math.max(0,i>s?s:n.indexOf(" ",i));return 0==r&&s>=i&&(r=s),n.substr(o,r)},i.prototype.findimage=function(t,e){var i=t,n=/(<img.*?src=[\'"](.*?)[\'"][^>]*>)|(background(-image)??\s*?:.*?url\((["|\']?)?(.+?)(["|\']?)?\))/gi,s=[],o=null;for(e="undefined"!=typeof e?parseInt(e)-1:0;o=n.exec(i);)"undefined"!=typeof o[2]?s.push(o[2]):"undefined"!=typeof o[6]&&s.push(o[6]);return s.length?s.length>e?s[e]:s[s.length-1]:""},i.prototype.findlink=function(t,e){var i=t,n=/href=["\']?([^"\'>]+)["\']?/gi,s=[],o=null;for(e="undefined"!=typeof e?parseInt(e)-1:0;o=n.exec(i);)"undefined"!=typeof o[1]&&s.push(o[1]);return s.length?s.length>e?s[e]:s[s.length-1]:""},i.prototype.removevarlink=function(t){var e=String(t),i=/<a href=\"(.*?)\">(.*?)<\/a>/g;return e.replace(i,"")},i.prototype.removelinebreaks=function(t){var e=String(t),i=/\r?\n|\r/g;return e.replace(i,"")},i.prototype.registerFields=function(t){for(var e=0;e<t.length;e++)this.registerField(t[e])},i.prototype.registerGlobalField=function(e,i,n){null!==this.variables&&(n=t(n).on("nextendChange",t.proxy(function(){this.variables[e][i]=n.val(),this.refresh()},this)))},i.prototype.registerField=function(t){},i.prototype.generatorRegisterField=function(e){e=t(e);var i=e.parent();i.on({mouseenter:t.proxy(function(){this.activeField=e,this.button.prependTo(i)},this)})},i.prototype.getModal=function(){var e=this;if(!this.modal){var i={key:"",group:1,filter:"no",split:"no",splitStart:0,splitLength:300,findImage:0,findImageIndex:1,findLink:0,findLinkIndex:1,removeVarLink:0,removelinebreaks:0},n=function(){var t=i.key+"/"+i.group;return i.findImage&&(t="findimage("+t+","+Math.max(1,i.findImageIndex)+")"),i.findLink&&(t="findlink("+t+","+Math.max(1,i.findLinkIndex)+")"),i.removeVarLink&&(t="removevarlink("+t+")"),i.removelinebreaks&&(t="removelinebreaks("+t+")"),"no"!=i.filter&&(t=i.filter+"("+t+")"),"no"!=i.split&&i.splitStart>=0&&i.splitLength>0&&(t=i.split+"("+t+","+i.splitStart+","+i.splitLength+")"),"{"+t+"}"},s=t('<div class="n2-generator-result-container" />'),o=function(){s.html(t("<div/>").text(e.fill(n())).html())},r=e.group,a=null,l=null,d=t('<div class="n2-generator-insert-variable"/>'),h=N2Classes.NextendModal.prototype.createHeading(n2_("Choose the group")).appendTo(d),p=t('<div class="n2-group-container" />').appendTo(d);d.append(N2Classes.NextendModal.prototype.createHeading(n2_("Choose the variable")));var c=t('<div class="n2-variable-container webkit-scroll-fix" />').appendTo(d),u=t('<div class="n2-generator-functions-container n2-form-element-mixed" />').appendTo(t('<div class="n2-form" />').appendTo(d));d.append(N2Classes.NextendModal.prototype.createHeading(n2_("Result"))),s.appendTo(d),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Filter")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select autocomplete="off" name="filter" id="n2-generator-function-filter"><option selected="selected" value="no">'+n2_("No")+'</option><option value="cleanhtml">'+n2_("Clean HTML")+'</option><option value="removehtml">'+n2_("Remove HTML")+"</option></select></div></div></div>").appendTo(u);var y=u.find("#n2-generator-function-filter");y.on("change",t.proxy(function(){i.filter=y.val(),o()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Split by chars")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select autocomplete="off" name="split" id="n2-generator-function-split"><option selected="selected" value="no">'+n2_("No")+'</option><option value="splitbychars">'+n2_("Strict")+'</option><option value="splitbywords">'+n2_("Respect words")+'</option></select></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Start")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="0" id="n2-generator-function-split-start"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Length")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="300" id="n2-generator-function-split-length"></div></div></div>').appendTo(u);var g=u.find("#n2-generator-function-split");g.on("change",t.proxy(function(){i.split=g.val(),o()},this));var f=u.find("#n2-generator-function-split-start");f.on("change",t.proxy(function(){i.splitStart=parseInt(f.val()),o()},this));var m=u.find("#n2-generator-function-split-length");m.on("change",t.proxy(function(){i.splitLength=parseInt(m.val()),o()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Find image")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-findimage"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Index")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="1" id="n2-generator-function-findimage-index"></div></div></div>').appendTo(u);var v=u.find("#n2-generator-function-findimage");v.on("nextendChange",t.proxy(function(){i.findImage=parseInt(v.val()),o()},this));var b=u.find("#n2-generator-function-findimage-index");b.on("change",t.proxy(function(){i.findImageIndex=parseInt(b.val()),o()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Find link")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-findlink"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Index")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="1" id="n2-generator-function-findlink-index"></div></div></div>').appendTo(u);var x=u.find("#n2-generator-function-findlink");x.on("nextendChange",t.proxy(function(){i.findLink=parseInt(x.val()),o()},this));var C=u.find("#n2-generator-function-findlink-index");C.on("change",t.proxy(function(){i.findLinkIndex=parseInt(C.val()),o()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Remove links")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-removevarlink"></div></div></div>').appendTo(u);var w=u.find("#n2-generator-function-removevarlink");w.on("nextendChange",t.proxy(function(){i.removeVarLink=parseInt(w.val()),o()},this));var S=u.find("#n2-generator-function-removevarlink-index");S.on("change",t.proxy(function(){i.removeVarLinkIndex=parseInt(S.val()),o()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Remove line breaks")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-removelinebreaks"></div></div></div>').appendTo(u);var k=u.find("#n2-generator-function-removelinebreaks");k.on("nextendChange",t.proxy(function(){i.removelinebreaks=parseInt(k.val()),o()},this));var N=u.find("#n2-generator-function-removelinebreaks-index");N.on("change",t.proxy(function(){i.removelinebreaksIndex=parseInt(N.val()),o()},this));for(var P in this.variables[0])t('<a href="#" class="n2-button n2-button-normal n2-button-s n2-button-grey n2-radius-s">'+P+"</a>").on("click",t.proxy(function(e,n){n.preventDefault(),a.removeClass("n2-active"),t(n.currentTarget).addClass("n2-active"),i.key=e,o()},this,P)).appendTo(c);a=c.find("a"),a.eq(0).trigger("click"),1==r&&(h.css("display","none"),p.css("display","none"));for(var D=0;r>D;D++)t('<a href="#" class="n2-button n2-button-normal n2-button-s n2-button-grey n2-radius-s">'+(D+1)+"</a>").on("click",t.proxy(function(e,n){n.preventDefault(),l.removeClass("n2-active"),t(n.currentTarget).addClass("n2-active"),i.group=e+1,o()},this,D)).appendTo(p);l=p.find("a"),l.eq(0).trigger("click");var A=!1;this.modal=new N2Classes.NextendModal({zero:{size:[1e3,r>1?670:600],title:n2_("Insert variable"),back:!1,close:!0,content:d,controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green">'+n2_("Insert")+"</a>"],fn:{show:function(){A||(new N2Classes.FormElementOnoff("n2-generator-function-findimage"),new N2Classes.FormElementOnoff("n2-generator-function-findlink"),new N2Classes.FormElementOnoff("n2-generator-function-removevarlink"),new N2Classes.FormElementOnoff("n2-generator-function-removelinebreaks"),A=!0),this.controls.find(".n2-button").on("click",t.proxy(function(t){t.preventDefault(),e.insert(n()),this.hide(t)},this))}}}},!1),this.modal.setCustomClass("n2-ss-generator-modal")}return this.modal},i.prototype.showModal=function(){this.getModal().show()},i.prototype.insert=function(t){this.activeField.val(t).trigger("change")},i.prototype.refresh=function(){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),this._refreshTimeout=setTimeout(t.proxy(this._refresh,this),100)},i.prototype._refresh=function(){for(var t=this.editor.fragmentEditor.mainContainer.container.getAllLayers(),e=0;e<t.length;e++)"layer"==t[e].type&&t[e].item.reRender()},i}),N2D("History",function(t,e){"use strict";function i(){this.historyStates=50,this.enabled=0!=this.historyStates,this.historyAddAllowed=!0,this.isBatched=!1,this.currentBatch=this,this.index=-1,this.stackedOff=[],this.tasks=[],this.preventUndoRedo=!1,this.undoBTN=t("#n2-ss-undo").on({click:t.proxy(this.undo,this),mousedown:function(t){N2Classes.WindowManager.get().setMouseDownArea("undo",t)}}),this.redoBTN=t("#n2-ss-redo").on({click:t.proxy(this.redo,this),mousedown:function(t){N2Classes.WindowManager.get().setMouseDownArea("redo",t)}}),this.updateUI()}function n(t){this.parent=t,this.tasks=[]}function s(t){switch(t){case"skipForwardUndos":this.undo=function(){return!1}}}function o(t,e,i,n){this.that=t,this.undoAction=e,this.redoAction=i,this.context=n||[]}function r(){o.prototype.constructor.apply(this,arguments)}return i.get=function(){var t=new i;return i.get=function(){return t},t},i.prototype.updateUI=function(){0==this.index||0==this.tasks.length?this.undoBTN.removeClass("n2-active"):this.undoBTN.addClass("n2-active"),-1==this.index||this.index>=this.tasks.length?this.redoBTN.removeClass("n2-active"):this.redoBTN.addClass("n2-active")},i.prototype.throttleUndoRedo=function(){return this.preventUndoRedo?!0:(this.preventUndoRedo=!0,setTimeout(t.proxy(function(){this.preventUndoRedo=!1},this),100),!1)},i.prototype.isEnabled=function(){return this.enabled&&this.historyAddAllowed},i.prototype.startBatch=function(){if(this.isEnabled()){var t=new n(this.currentBatch);return this.currentBatch._add(t),this.currentBatch=t,t}return!1},i.prototype.endBatch=function(){this.isEnabled()&&(this.currentBatch.parent==e,this.currentBatch=this.currentBatch.parent)},i.prototype.addControl=function(t){return this.currentBatch._add(new s(t))},i.prototype.addSimple=function(t,e,i,n){return this.isEnabled()?this.currentBatch._add(new o(t,e,i,n)):!1},i.prototype.addValue=function(t,e,i){if(this.isEnabled()){if(this.isBatched||this.currentBatch!=this)for(var n=this.getCurrentBatchStack(),s=0;s<n.length;s++)if(n[s].isEqual(t,e,i))return n.push(n.splice(s,1)[0]),n[n.length-1];return this.currentBatch._add(new r(t,e,e,i))}return!1},i.prototype.getCurrentBatchStack=function(){return this.currentBatch!=this?this.currentBatch.tasks:this.tasks[this.tasks.length-1]},i.prototype._add=function(e){return-1!=this.index&&this.tasks.splice(this.index,this.tasks.length),this.index=-1,this.isBatched?this.tasks[this.tasks.length-1].push(e):(this.tasks.push([e]),this.isBatched=!0,setTimeout(t.proxy(function(){this.isBatched=!1},this),100)),this.tasks.length>this.historyStates&&this.tasks.unshift(),this.updateUI(),e},i.prototype.off=function(){this.historyAddAllowed=!1,this.stackedOff.push(1)},i.prototype.on=function(){this.stackedOff.pop(),0==this.stackedOff.length&&(this.historyAddAllowed=!0)},i.prototype.undo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.off(),-1==this.index?this.index=this.tasks.length-1:this.index--,this.index>=0)for(var e=this.tasks[this.index],i=e.length-1;i>=0&&e[i].undo();i--);else this.index=0;return this.on(),this.updateUI(),!0},i.prototype.redo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.off(),-1!=this.index&&this.index<this.tasks.length){var e=this.tasks[this.index];this.index++;for(var i=0;i<e.length&&e[i].redo();i++);}return this.on(),this.updateUI(),!0},n.prototype._add=function(t){return this.tasks.push(t),t},n.prototype.invertUndo=function(){return this.undo=function(){for(var t=this.tasks.length-1;t>=0&&this.tasks[t].undo();t--);return!0},this},n.prototype.undo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].undo();t++);return!0},n.prototype.redo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].redo();t++);return!0},n.prototype.isEqual=function(){return!1},s.prototype.undo=function(){return!0},s.prototype.redo=function(){return!0},s.prototype.isEqual=function(){return!1},o.prototype.undo=function(){return this.undoAction.apply(this.that.getSelf(),this.context),!0},o.prototype.redo=function(){return this.redoAction.apply(this.that.getSelf(),this.context),!0},o.prototype.isEqual=function(){return!1},r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.setValues=function(t,e){this.undoValue=t,this.redoValue=e},r.prototype.undo=function(){return this.context.unshift(this.undoValue),this.undoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},r.prototype.redo=function(){return this.context.unshift(this.redoValue),this.redoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},r.prototype.isEqual=function(t,e,i){if(t==this.that&&e==this.undoAction){for(var n=0;n<i.length;n++)if(i[n]!=this.context[n])return!1;return this.setValues=function(t,e){this.redoValue=e},!0}return!1},i}),N2D("InlineField",function(t,e){function i(){this.$input=t('<input type="text" name="name" />').on({mouseup:function(t){t.stopPropagation()},keyup:t.proxy(function(t){27==t.keyCode&&this.cancel()},this),blur:t.proxy(this.save,this)}),this.$form=t('<form class="n2-inline-form"></form>').append(this.$input).on("submit",t.proxy(this.save,this))}return i.prototype.injectNode=function(t,e){this.$input.val(e),t.append(this.$form),this.$input.focus()},i.prototype.save=function(t){t.preventDefault(),this.$input.trigger("valueChanged",[this.$input.val()]),this.$input.off("blur"),this.destroy()},i.prototype.cancel=function(){this.$input.trigger("cancel"),this.destroy()},i.prototype.destroy=function(){this.$input.off("blur"),this.$form.remove()},i}),N2D("SlideSettings",function(t,e){"use strict";function i(e,i){this.editor=e,this.isStatic=i;var n=t("#smartslider-form").find('input[id][name^="slide"], textarea[id][name^="slide"]'),s={};if(n.each(t.proxy(function(e,i){var n=t(i),o=n.attr("name").match(/slide\[(.*)\]/)[1];s[o]=n.on("nextendChange",t.proxy(this.onChange,this,o))},this)),this.fields=s,this.slideBackground=this.editor.getSlideBackground(),!i){var o=t("#slidethumbnail").on("change, nextendChange",function(){var e=o.val();""===e&&(e="$system$/images/placeholder/image.png"),t(".n2-ss-edit-slide-top-thumbnail img").attr("src",nextend.imageHelper.fixed(e))}),r=null,a=this.fields.backgroundImage.val(),l=t.proxy(function(t){""===t||"$system$/images/placeholder/image.png"===t||""!==o.val()&&o.val()!==a||(o.val(t).trigger("change"),r&&(r.off(".slidethumbnail"),r=null))},this);this.fields.backgroundImage.on("nextendChange.slidethumbnail",t.proxy(function(){var t=this.fields.backgroundImage.val();l(t),a=t},this)),""===o.val()&&(r=t("#item_imageimage").on("nextendChange.slidethumbnail",t.proxy(function(){l(r.val())},this)))}this.createHistory()}i.prototype.createHistory=function(){this.values={},t("#smartslider-form").find('input[id][name^="slide"], textarea[id][name^="slide"]').not("#slideslide").each(t.proxy(function(e,i){var n=t(i),s=n.data("field"),o=n.attr("id");this.values[o]=n.val(),n.on("nextendChange",t.proxy(function(){var t=n.val(),e=N2Classes.History.get().addValue(this,this.historyUpdateSlideValue,[s]);e&&e.setValues(this.values[o],t),this.values[o]=t},this))},this))},i.prototype.getSelf=function(){return this},i.prototype.historyUpdateSlideValue=function(t,e){e.insideChange(t)},i.prototype.getAllData=function(){var t={};for(var e in this.fields)t[e]=this.fields[e].val();return t};var n=["thumbnail","background-type","backgroundColor","backgroundGradient","backgroundColorEnd","backgroundImage","backgroundImageOpacity","backgroundImageBlur","backgroundFocusX","backgroundFocusY","backgroundMode"];return i.prototype.getBackgroundData=function(){for(var t={},e=0;e<n.length;e++)t[n[e]]=this.fields[n[e]].val();return t},i.prototype.setData=function(t,e){e&&this.slideBackground.setVisualLoad(!1);for(var i in t)this.fields[i].val(t[i]).trigger("change");e&&this.slideBackground.setVisualLoad(!1)},i.prototype.onChange=function(t,e){t=t.replace(/-/g,"_"),"function"==typeof this["sync_"+t]&&this["sync_"+t].call(this)},i.prototype.sync_backgroundColor=i.prototype.sync_backgroundGradient=i.prototype.sync_backgroundColorEnd=function(){this.updateBackgroundColor()},i.prototype.updateBackgroundColor=function(){var t,e=this.getBackgroundColor(),i=this.getBackgroundGradient();"off"!==i&&(t=this.getBackgroundColorEnd()),this.slideBackground.updateColor(e,i,t)},i.prototype.sync_backgroundVideoMp4=function(){this.slideBackground.setVideo()},i.prototype.sync_backgroundVideoMode=function(){this.slideBackground.setVideoMode(this.getBackgroundVideoMode())},i.prototype.getBackgroundVideo=function(){return nextend.imageHelper.fixed(this.editor.generator.fill(this.fields.backgroundVideoMp4.val()))},i.prototype.getBackgroundVideoMode=function(){return this.fields.backgroundVideoMode.val()},i.prototype.sync_backgroundVideoOpacity=function(){this.slideBackground.setVideoOpacity(this.getBackgroundVideoOpacity());
},i.prototype.getBackgroundVideoOpacity=function(){return this.fields.backgroundVideoOpacity.val()},i.prototype.sync_backgroundImage=function(){this.slideBackground.setImage(this.getBackgroundImage())},i.prototype.sync_background_type=function(){this.slideBackground.setType(this.fields["background-type"].val())},i.prototype.getType=function(){return this.fields["background-type"].val()},i.prototype.sync_backgroundMode=function(){this.slideBackground.setMode(this.fields.backgroundMode.val())},i.prototype.sync_backgroundFocusY=i.prototype.sync_backgroundFocusX=function(){this.slideBackground.setFocus(this.getBackgroundFocusX(),this.getBackgroundFocusY())},i.prototype.sync_backgroundImageOpacity=function(){this.slideBackground.setImageOpacity(this.getBackgroundImageOpacity())},i.prototype.getBackgroundImageOpacity=function(){return this.fields.backgroundImageOpacity.val()},i.prototype.sync_backgroundImageBlur=function(){this.slideBackground.setBlur(this.getBackgroundImageBlur())},i.prototype.getBackgroundColor=function(){return this.editor.generator.fill(this.fields.backgroundColor.val())},i.prototype.getBackgroundGradient=function(){return this.fields.backgroundGradient.val()},i.prototype.getBackgroundColorEnd=function(){return this.editor.generator.fill(this.fields.backgroundColorEnd.val())},i.prototype.getBackgroundImage=function(){return this.editor.generator.fill(this.fields.backgroundImage.val())},i.prototype.getBackgroundImageBlur=function(){return this.fields.backgroundImageBlur.val()},i.prototype.getBackgroundFocusX=function(){return this.fields.backgroundFocusX.val()},i.prototype.getBackgroundFocusY=function(){return this.fields.backgroundFocusY.val()},i}),N2D("FormElementStyleMode",function(t,e){function i(e){this.$element=t("#"+e).on("nextendChange",t.proxy(function(){""==this.$element.val()?this.$reset.css("visibility","hidden"):this.$reset.css("visibility","")},this)),this.$container=this.$element.parent(),this.$reset=this.$container.find(".n2-form-element-style-mode-reset").on("click",t.proxy(function(){this.$element.triggerHandler("n2resetmode")},this))}return i}),N2D("SmartSliderAdminSlideBackgroundColor",["SmartSliderSlideBackgroundColor"],function(t,e){function i(t,e){N2Classes.SmartSliderSlideBackgroundColor.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundColor.prototype),i.prototype.constructor=i,i.prototype.update=function(t,e,i){t=this.fixColor(t),this.$el.css({background:"",filter:""}),"off"!==e?this.updateGradient(t,e,i):this.updateColor(t)},i.prototype.updateColor=function(t){"00"!==t.substr(6,8)&&this.$el.css("background","#"+t.substr(0,6)).css("background",N2Color.hex2rgbaCSS(t))},i.prototype.updateGradient=function(t,e,i){switch(this.$el.css({background:"",filter:""}),i=this.fixColor(i),e){case"horizontal":this.$el.css("background","#"+t.substr(0,6)).css("background","-moz-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background"," -webkit-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+t.substr(0,6)+"', endColorstr='#"+i.substr(0,6)+"',GradientType=1)");break;case"vertical":this.$el.css("background","#"+t.substr(0,6)).css("background","-moz-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background"," -webkit-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+t.substr(0,6)+"', endColorstr='#"+i.substr(0,6)+"',GradientType=0)");break;case"diagonal1":this.$el.css("background","#"+t.substr(0,6)).css("background","-moz-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background"," -webkit-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+t.substr(0,6)+"', endColorstr='#"+i.substr(0,6)+"',GradientType=1)");break;case"diagonal2":this.$el.css("background","#"+t.substr(0,6)).css("background","-moz-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background"," -webkit-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+t.substr(0,6)+"', endColorstr='#"+i.substr(0,6)+"',GradientType=1)")}},i.prototype.fixColor=function(t){return t.length&&"#"===t.charAt(0)&&(t=t.substring(1),6===t.length&&(t+="ff")),t},i}),N2D("SmartSliderAdminSlideBackgroundImage",["SmartSliderSlideBackgroundImage"],function(t,e){function i(t,e,i,n){this.hash=n.data("hash"),N2Classes.SmartSliderSlideBackgroundImage.prototype.constructor.apply(this,arguments),this.loadAllowed=!0,this.listenImageManager()}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundImage.prototype),i.prototype.constructor=i,i.prototype.listenImageManager=function(){""!==this.hash&&t(window).on(this.hash,t.proxy(this.onImageManagerChanged,this))},i.prototype.notListenImageManager=function(){""!==this.hash&&t(window).off(this.hash,null,t.proxy(this.onImageManagerChanged,this))},i.prototype.onImageManagerChanged=function(t,e){this.tabletSrc=e.tablet.image,this.mobileSrc=e.mobile.image,this.updateBackgroundToDevice(this.manager.device)},i.prototype.preLoadAdmin=function(e){this.preLoad(),""!==e&&this.background.allowVisualLoad&&(this.notListenImageManager(),this.deferred.done(t.proxy(function(){t.when(nextend.imageManager.getVisual(e)).done(t.proxy(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()},this))},this)))},i.prototype.setDesktopSrc=function(e){if(this.notListenImageManager(),this.desktopSrc=e,this.hash=md5(e),""!==e&&this.background.allowVisualLoad){var i=new Image;i.addEventListener("load",t.proxy(function(){t.when(nextend.imageManager.getVisual(e)).done(t.proxy(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()},this))},this),!1),i.src=nextend.imageHelper.fixed(e)}else this.tabletSrc="",this.mobileSrc="",this.setSrc(nextend.imageHelper.fixed(e))},i.prototype.setSrc=function(t){N2Classes.SmartSliderSlideBackgroundImage.prototype.setSrc.call(this,nextend.imageHelper.fixed(t))},i.prototype.startFixed=function(){},i.prototype.updateMode=function(t,e){if("blurfit"===t&&1===this.$background.length){this.$background=this.$background.add(this.$background.clone().insertAfter(this.$background));var i=7;this.$background.first().css({margin:"-"+2*i+"px",padding:2*i+"px"}).css(window.n2FilterProperty,"blur("+i+"px)")}"blurfit"===e&&"blurfit"!==t&&(this.$background.eq(1).remove(),this.$background=this.$background.eq(0),this.updateBlur(this.blur))},i.prototype.updateFocus=function(t,e){this.$background.css("background-position",t+"% "+e+"%")},i.prototype.updateOpacity=function(t){this.$background.css("opacity",t/100)},i.prototype.updateBlur=function(t){window.n2FilterProperty&&(t>0?this.$background.last().css({margin:"-"+2*t+"px",padding:2*t+"px"}).css(window.n2FilterProperty,"blur("+t+"px)"):this.$background.last().css({margin:"",padding:""}).css(window.n2FilterProperty,"")),this.blur=t},i.prototype.kill=function(){this.notListenImageManager(),this.$el.remove(),this.$background.remove()},i}),N2D("SmartSliderAdminSlideBackgroundVideo",["SmartSliderSlideBackgroundVideo"],function(t,e){function i(t,e,i){N2Classes.SmartSliderSlideBackgroundVideo.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundVideo.prototype),i.prototype.constructor=i,i.prototype.onReady=function(){if(!this.isReady){this.isReady=!0;var e=this.$video;this.safePause(),e.data("ratio")||(e[0].videoWidth>0?e.data("ratio",e[0].videoWidth/e[0].videoHeight):e.data("ratio",e[0].offsetWidth/e[0].offsetHeight),e.addClass("n2-active"),this.slider.sliderElement.one("BeforeVisible",t.proxy(this.onResize,this)),this.slider.ready(t.proxy(function(){this.$video.one("n2playvideo",t.proxy(function(){this.background.fadeOut()},this)),this.slider.sliderElement.on("SliderResize",t.proxy(this.onResize,this)),this.isResized||this.onResize(),this.setState("ready",!0),this.setState("scroll",!0)},this)))}},i.prototype.updateVideoMode=function(t){this.$video.data("mode",t).attr("data-mode",t),this.resizeVideo()},i.prototype.updateOpacity=function(t){this.$video.css("opacity",t/100)},i.prototype.kill=function(){this.$video.remove()},i}),N2D("LayerContainer",function(t,e){"use strict";function i(t,e,i,n,s){this.component=t,this.$ul=e.data("container",this),this.allowedPlacementMode=i,this.childrenSelector=n,this.allowedChildren=s,this.layerContainerElement=t.layer}return i.prototype.setLayerContainerElement=function(t){this.layerContainerElement=t},i.prototype.startWithExistingNodes=function(t){for(var e=this.layerContainerElement.find(this.childrenSelector),i=0;i<e.length;i++)this._loadNode(e.eq(i),t);this.component.onChildCountChange()},i.prototype.isChildAllowed=function(e){return-1!==t.inArray(e,this.allowedChildren)},i.prototype._loadNode=function(t,i){var n=t.data("sstype");if(this.isChildAllowed(n)){var s=t.data("lastplacement"),o={};if(s!==e&&s!=this.allowedPlacementMode)switch(s){case"absolute":o=N2Classes.PlacementAbsolute.cleanLayer(t);break;case"normal":o=N2Classes.PlacementNormal.cleanLayer(t)}var r;switch(n){case"layer":r=new N2Classes.Layer(this.component.fragmentEditor,this.component);var a=r.itemEditor.getItemClass(t.find(".n2-ss-item").data("item"));a&&N2Classes[a].needSize&&o.desktopportraitheight!==e&&t.data("desktopportraitheight",o.desktopportraitheight);break;case"content":r=new N2Classes.Content(this.component.fragmentEditor,this.component);break;case"row":r=new N2Classes.Row(this.component.fragmentEditor,this.component);break;case"col":r=new N2Classes.Col(this.component.fragmentEditor,this.component);break;case"group":r=new N2Classes.Group(this.component.fragmentEditor,this.component)}if(r)return r.load(t,i),i||r.sync(),r}else console.error(n+" is not allowed in "+this.component.label);return!1},i.prototype.getLayerCount=function(){return this.layerContainerElement.find(this.childrenSelector).length},i.prototype.getLayerIndex=function(t){return this.layerContainerElement.find(this.childrenSelector).index(t)},i.prototype.getSortedLayers=function(){var i=[];return this.layerContainerElement.find(this.childrenSelector).each(function(n,s){var o=t(s).data("layerObject");o!==e&&i.push(o)}),i},i.prototype.append=function(t){t.appendTo(this.layerContainerElement);var e=this._loadNode(t,!1);return this.component.onChildCountChange(),e},i.prototype.insertAt=function(t,e){var i=this.getSortedLayers();e>=i.length?t.appendTo(this.layerContainerElement):t.insertBefore(i[e].layer);var n=this._loadNode(t,!1);return this.component.onChildCountChange(),n},i.prototype.insert=function(t){t.getRootElement().appendTo(this.layerContainerElement)},i.prototype.insertLayerAt=function(e,i){var n=this.getSortedLayers(),s=t.inArray(e,n);s>-1&&i>s&&i++,i>=n.length?e.getRootElement().appendTo(this.layerContainerElement):e.getRootElement().insertBefore(n[i].getRootElement()),this.syncLayerRow(e)},i.prototype.syncLayerRow=function(t){var i,n="absolute"===this.allowedPlacementMode;i=n?t.getRootElement().prevAll(".n2-ss-layer, .n2-ss-layer-group").first().data("layerObject"):t.getRootElement().nextAll(".n2-ss-layer, .n2-ss-layer-group").first().data("layerObject"),i!==e?t.layerRow.insertBefore(i.layerRow):this.$ul.append(t.layerRow),t.animations&&t.animations.syncRow(i,n)},i.prototype.getChildLayersRecursive=function(t){for(var e=this.getSortedLayers(),i=[],n=0;n<e.length;n++)t?i.push(e[n].layer[0]):i.push(e[n]),e[n].container&&i.push.apply(i,e[n].container.getChildLayersRecursive(t));return i},i.prototype.moveLayerToGroup=function(t,e){this.moveLayersToGroup([t],[e])},i.prototype.moveLayersToGroup=function(e,i){i=i||[];for(var n=[],s=0;s<e.length;s++){var o=e[s],r=o.group,a=o.getIndex();"undefined"!=typeof i[s]?this.insertLayerAt(o,i[s]):this.insert(o),o.changeGroup(a,this.component),this!=r&&-1==t.inArray(r,n)&&n.push(r)}for(var s=0;s<n.length;s++)n[s].update()},i.prototype.activateFirst=function(){var t=this.getSortedLayers();t.length>0&&t[t.length-1].activate()},i.prototype.resetModes=function(t){for(var i=this.getSortedLayers(),n=0;n<i.length;n++)i[n].resetMode(t),i[n].container!=e&&i[n].container.resetModes(t)},i.prototype.copyModes=function(t,i){for(var n=this.getSortedLayers(),s=0;s<n.length;s++)n[s].copyMode(t,i),n[s].container!=e&&n[s].container.copyModes(t,i)},i.prototype.changeEditorModes=function(t){for(var i=this.getSortedLayers(),n=0;n<i.length;n++)i[n].changeEditorMode(t),i[n].container!=e&&i[n].container.changeEditorModes(t)},i.prototype.renderModeProperties=function(){for(var t=this.getSortedLayers(),i=0;i<t.length;i++)t[i].renderModeProperties(),t[i].container!=e&&t[i].container.renderModeProperties()},i.prototype.getAllLayers=function(t){t=t||[];for(var i=this.getSortedLayers(),n=0;n<i.length;n++)t.push(i[n]),i[n].container!=e&&i[n].container.getAllLayers(t);return t},i.prototype.getData=function(e){e=t.extend({layersIncluded:!0,itemsIncluded:!0},e);var i=[],n=this.getSortedLayers();if("absolute"==this.allowedPlacementMode)for(var s=n.length-1;s>=0;s--)i.push(n[s].getData(e));else for(var s=0;s<n.length;s++)i.push(n[s].getData(e));return i},i.prototype.getHTML=function(t){for(var e=this.getSortedLayers(),i=[],n=0;n<e.length;n++)i.push(e[n].getHTML(t));return i},i.prototype.getDroppables=function(t){for(var e=[],i=this.getSortedLayers(),n=0;n<i.length;n++)if(i[n]!=t){var s=i[n].getDroppable();"object"==typeof s&&e.push(s),"hidden"!=s&&i[n].container&&e.push.apply(e,i[n].container.getDroppables(t))}return e},i.prototype.getLLDroppables=function(t){var e=[],i=this.component.getLLDroppable(t);i&&e.push(i);for(var n=this.getSortedLayers(),s=0;s<n.length;s++)n[s].container&&n[s]!=t&&e.push.apply(e,n[s].container.getLLDroppables(t));return e},i}),N2D("LayerDataStorage",function(t,e){"use strict";function i(){this.isDeviceProp={},this.propertyScope={},this.property={},this.deviceProperty={desktopPortrait:{},desktopLandscape:{},tabletPortrait:{},tabletLandscape:{},mobilePortrait:{},mobileLandscape:{}},this.advancedProperties={}}return i.prototype.getMode=function(){return this.fragmentEditor.getMode()},i.prototype.getProperties=function(){var t={};for(var i in this.property)if(this.advancedProperties[i]!==e){if(i==this.advancedProperties[i].getName()){var n=this.property[i],s=this.advancedProperties[i].getBaseName();this.property[i]===e&&(n=this.property[s]),t[s]=n}}else t[i]=this.property[i];return t},i.prototype.getRawProperty=function(t){if(this.isDeviceProp[t]){var i=this.getMode(),n=this.deviceProperty[i];return n[t]!==e?n[t]:e}return this.property[t]},i.prototype.getProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),i=this.deviceProperty[e],n=this.deviceProperty.desktopPortrait;if("undefined"!=typeof i[t])return i[t];if("undefined"!=typeof n[t])return n[t]}return this.property[t]},i.prototype.historyStore=function(t,e,i){if(!this.isDeleteStarted){var n=this.getMode();this.isDeviceProp[e]&&i!=n?(this.deviceProperty[i][e]=t,this.render(e)):(this.store(e,t,!0,"history"),this.$.trigger("propertyChanged",[e,this.getProperty(e)]))}},i.prototype.store=function(t,e,i,n){var s,o,r=this.getMode();this.isDeviceProp[t]?(s=this.deviceProperty[r][t],o=this.getProperty(t)):o=s=this.property[t];var a=N2Classes.History.get().addValue(this,this.historyStore,[t,r]);a&&a.setValues(s,e),this.property[t]=e,this.isDeviceProp[t]&&(this.deviceProperty[r][t]=e),i&&this.render(t,o,n)},i.prototype.render=function(t,e,i){this.propertyScope[t]["_sync"+t](e,i)},i.prototype.isDimensionPropertyAccepted=function(t){return(t+"").match(/[0-9]+%/)||"auto"==t},i.prototype.changeEditorMode=function(t){var e=parseInt(this.property[t]);e?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.renderModeProperties(!1)},i.prototype.renderModeProperties=function(t){for(var e in this.isDeviceProp)this.isDeviceProp[e]&&(this.property[e]=this.getProperty(e),this.$.trigger("propertyChanged",[e,this.property[e]]))},i.prototype.historyResetMode=function(e,i){this.deviceProperty[i]=t.extend({},e),i==this.fragmentEditor.getMode()&&this.renderModeProperties(!0)},i.prototype.resetMode=function(e){if("desktopPortrait"!=e){var i,n=N2Classes.History.get().addValue(this,this.historyResetMode,[e]);n&&n.setValues(t.extend({},this.deviceProperty[e]),{});for(var s in this.deviceProperty[e])this.deviceProperty[e][s]=i;e==this.fragmentEditor.getMode()&&this.renderModeProperties(!0)}},i.prototype.copyMode=function(e,i){if(e!=i){var n=this.deviceProperty[i];this.deviceProperty[i]=t.extend({},this.deviceProperty[i],this.deviceProperty[e]);var s=N2Classes.History.get().addValue(this,this.historyResetMode,[i]);s&&s.setValues(n,this.deviceProperty[i])}},i.prototype._getDefault=function(t,i){return this.originalProperties[t]!==e?this.originalProperties[t]:i},i.prototype.createProperty=function(t,i,n,s){this.isDeviceProp[t]=!1,this.propertyScope[t]=s||this,n?(this.property[t]=n.data(t.toLowerCase()),this.property[t]===e&&(this.property[t]=this._getDefault(t,i))):this.property[t]=this._getDefault(t,i)},i.prototype.createAdvancedProperty=function(t,e,i){var n=t.getNames();for(var s in n)this.advancedProperties[s]=t,this.createProperty(s,n[s],e,i)},i.prototype.syncAdvancedField=function(t){var i=this.advancedProperties[t].getName(),n=this.property[i];this.property[i]===e&&(n=this.property[t]),this.fragmentEditor.layerOptions.updateField(t,n)},i.prototype.createDeviceProperty=function(t,i,n,s){var o,r;if(this.isDeviceProp[t]=!0,this.propertyScope[t]=s||this,n){for(o in this.deviceProperty)this.deviceProperty[o][t]=n.data(o.toLowerCase()+t.toLowerCase()),""===this.deviceProperty[o][t]&&(this.deviceProperty[o][t]=e);for(o in this.deviceProperty)this.deviceProperty[o][t]!==e&&""!==this.deviceProperty[o][t]||(r=this._getDefault(o.toLowerCase()+t.toLowerCase()),r!==e&&(this.deviceProperty[o][t]=r));for(o in i)this.deviceProperty[o][t]!==e&&""!==this.deviceProperty[o][t]||(this.deviceProperty[o][t]=i[o])}else{for(o in i)this.deviceProperty[o][t]=i[o];for(o in this.deviceProperty)r=this._getDefault(o.toLowerCase()+t.toLowerCase()),r!==e&&(this.deviceProperty[o][t]=r)}this.property[t]=this.deviceProperty.desktopPortrait[t]},i.prototype.removeProperty=function(t){if(delete this.property[t],this.layer.removeData(t.toLowerCase()).removeAttr("data-"+t.toLowerCase()),this.isDeviceProp[t])for(var e in this.deviceProperty)delete this.deviceProperty[e][t],this.layer.removeData(e.toLowerCase()+t.toLowerCase()).removeAttr("data-"+e.toLowerCase()+t.toLowerCase());delete this.isDeviceProp[t],delete this.propertyScope[t]},i.prototype.removeProperties=function(t){for(var e=0;e<t.length;e++)this.removeProperty(t[e])},i.prototype.getPropertiesData=function(t){for(var i={},n=0;n<t.length;n++){var s=t[n];if(this.property[s]!==e&&(i[s]=this.property[s]),this.isDeviceProp[s])for(var o in this.deviceProperty)this.deviceProperty[o][s]!==e&&(i[o.toLowerCase()+s]=this.deviceProperty[o][s])}return i},i.prototype.setProperty=function(t,i,n){this.advancedProperties[t]!==e&&(t=this.advancedProperties[t].getName()),this.propertyScope[t]!==e?"function"==typeof this.propertyScope[t]["setProperty"+t]?this.propertyScope[t]["setProperty"+t](t,i,n):this._setProperty(t,i,n):"function"==typeof this["setProperty"+t]&&this["setProperty"+t](t,i,n)},i.prototype._setProperty=function(t,e,i){this.store(t,e,!0,i),"manager"!=i&&this.$.trigger("propertyChanged",[t,this.getProperty(t)])},i.prototype.onSyncFields=function(){},i.prototype.resetStyleMode=function(t){for(var e in this.advancedProperties)this.advancedProperties[e].resetMode(t)},i}),N2D("FragmentEditor",function(t,e){"use strict";function i(e,i,n,s){this.mode="desktopPortrait",this.editor=e,this.$editedElement=i,this.configuration=n,this.ready=t.Deferred(),this.shouldPreventActivationBubble=!1,this.$=t(this),e.fragmentEditor=this,this.$highlight=t('<div class="n2-ss-layer-highlight n2-ss-layer-highlight-n" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-e" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-s" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-w" />'),this.initSelectMode(),this.layerWindow=new N2Classes.LayerWindow(this),this.editor.setLayersToZero(),this.layerOptions=new N2Classes.ComponentSettings(this),this.layerAnimationManager=new N2Classes.LayerAnimationManager(this),this.ui=new N2Classes.CanvasUserInterface(this),this.mainContainer=new N2Classes.MainContainer(this),this.itemEditor=new N2Classes.ItemManager(this,s),this.mainContainer.lateInit(),this._initDeviceModeChange(),this.canvasSettings=new N2Classes.CanvasSettings(this),this.layerOptions.startFeatures(),this.hotkeys(),this.addContextMenu(),this.mainContainer.refreshHasLayers();var o=t("#n2-ss-editor-mode .n2-radio-option"),r=t.proxy(function(t){switch(this.updateEditorMode(t),t){case"content":o.eq(0).addClass("n2-active"),o.eq(1).removeClass("n2-active");break;case"canvas":o.eq(0).removeClass("n2-active"),o.eq(1).addClass("n2-active")}},this);if(this.mainContent&&this.mainContent.container.getLayerCount())r("content");else{var a=this.mainContainer.container.getSortedLayers();if(this.mainContent&&a.length>1||!this.mainContent&&a.length>0)r("canvas");else{var l=t.jStorage.get("editormode");l||(l="content",t.jStorage.set("editormode",l)),r(l)}}o.on("click",t.proxy(function(e){o.removeClass("n2-active");var i=t(e.currentTarget),n=i.data("mode");i.addClass("n2-active"),n!=this.currentEditorMode&&(this.updateEditorMode(n),t.jStorage.set("editormode",n))},this)),this.isMultiDrag=!1}var n={16:0,38:0,40:0,37:0,39:0},s={97:"left",98:"center",99:"right",100:"left",101:"center",102:"right",103:"left",104:"center",105:"right"},o={97:"bottom",98:"bottom",99:"bottom",100:"middle",101:"middle",102:"middle",103:"top",104:"top",105:"top"},r={OFF:0,ON:1,GROUP:2};return i.prototype.updateEditorMode=function(e){this.currentEditorMode=e,t("body").attr("data-editormode",this.currentEditorMode)},i.prototype.getMode=function(){return this.mode},i.prototype.getResponsiveRatioHorizontal=function(){return this.editor.getHorizontalRatio()},i.prototype.getResponsiveRatioVertical=function(){return this.editor.getVerticalRatio()},i.prototype.setMainContent=function(t){this.mainContent=t},i.prototype.isGroup=function(t){return t instanceof N2Classes.Group},i.prototype.isRow=function(t){return t instanceof N2Classes.Row},i.prototype.isCol=function(t){return t instanceof N2Classes.Col},i.prototype.isLayer=function(t){return t instanceof N2Classes.Layer},i.prototype.isContent=function(t){return t instanceof N2Classes.Content},i.prototype._initDeviceModeChange=function(){var e=t("#layerresettodesktop").on("click",t.proxy(this.__onResetToDesktopClick,this));this.resetToDesktopTRElement=e.closest("tr"),this.resetToDesktopGlobalElement=t("#n2-ss-layer-reset-to-desktop").on("click",t.proxy(function(){"block"==this.resetToDesktopTRElement.css("display")&&e.trigger("click")},this));var i=t("#n2-ss-layer-show-on"),n={},s=this.editor.getAvailableDeviceModes();for(var o in s)s[o]&&(n[o]=t('<div class="n2-radio-option"><i class="n2-i n2-it n2-i-'+o+'"></i></div>').on("click",t.proxy(function(t){this.layerOptions.currentForm[t].data("field").onoff.trigger("click")},this,o)).appendTo(i));i.children().first().addClass("n2-first"),i.children().last().addClass("n2-last"),this.globalShowOnDeviceCB=function(t){"undefined"!=typeof n[t]&&n[t].toggleClass("n2-active",1==this.layerOptions.currentForm[t].val())},this.layerOptions.forms.global.desktopPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopPortrait")),this.layerOptions.forms.global.desktopLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopLandscape")),this.layerOptions.forms.global.tabletPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletPortrait")),this.layerOptions.forms.global.tabletLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletLandscape")),this.layerOptions.forms.global.mobilePortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobilePortrait")),this.layerOptions.forms.global.mobileLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobileLandscape")),this.layerOptions.forms.component.group.desktopPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopPortrait")),this.layerOptions.forms.component.group.desktopLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopLandscape")),this.layerOptions.forms.component.group.tabletPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletPortrait")),this.layerOptions.forms.component.group.tabletLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletLandscape")),this.layerOptions.forms.component.group.mobilePortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobilePortrait")),this.layerOptions.forms.component.group.mobileLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobileLandscape")),t("#layershow").data("field").setAvailableDevices(s),t("#layergroup-show").data("field").setAvailableDevices(s),this.refreshMode(),this.ready.resolve()},i.prototype.refreshMode=function(){this.mode=this.editor.getDeviceMode(),this.resetToDesktopTRElement.css("display","desktopPortrait"==this.mode?"none":""),this.resetToDesktopGlobalElement.css("display","desktopPortrait"==this.mode?"none":""),this.mainContainer.container.changeEditorModes(this.mode)},i.prototype.onChangeDeviceOrientation=function(){this.refreshMode()},i.prototype.onResize=function(t){this.mainContainer.onResize(t),this.canvasSettings.ruler&&this.canvasSettings.ruler.onResize()},i.prototype.__onResetToDesktopClick=function(){if(this.mainContainer.getSelectedLayer()){var t=this.getMode();this.mainContainer.getSelectedLayer().resetMode(t)}},i.prototype.copyOrResetMode=function(t){var e=this.getMode();"desktopPortrait"==e?"desktopPortrait"!=t&&this.mainContainer.container.resetModes(t):t==e?this.mainContainer.container.resetModes(t):this.mainContainer.container.copyModes(e,t)},i.prototype.getSnap=function(){return this.canvasSettings.get("n2-ss-snap-to-enabled")?t(this.configuration.snapSelector):!1},i.prototype.getHTML=function(){for(var e=t("<div></div>"),i=this.mainContainer.container.getAllLayers(),n=0;n<i.length;n++)e.append(i[n].getHTML(!0));return e.html()},i.prototype.getData=function(){return this.mainContainer.container.getData()},i.prototype.importLayers=function(e,i){var n=(this.mainContainer,t.extend(!0,[],e));i&&this.mainContainer.deleteLayers(),this._idTranslation={};for(var s=this.dataToLayers(n),o=0;o<s.length;o++)this.mainContainer.container.append(s[o]);if(this.refreshMode(),!this.mainContainer.getSelectedLayer()){var n=this.mainContainer.container.getSortedLayers();n.length>0&&n[0].activate()}},i.prototype.loadComponentWithNode=function(t,e,i,n){var s=t.container.append(e);return n&&this.refreshMode(),s},i.prototype.insertComponentWithNode=function(t,e,i,n,s){var o=t.container.insertAt(e,i);return s&&this.refreshMode(),o},i.prototype.fixActiveLayer=function(){var t=this.mainContainer.getSelectedLayer();(0==t||t.isDeleted)&&this.resetActiveLayer()},i.prototype.resetActiveLayer=function(){var t=this.mainContainer.container.getSortedLayers();t.length?t[t.length-1].activate():this.changeActiveLayer(null)},i.prototype.changeActiveLayer=function(e,i){var n=this.mainContainer.getSelectedLayer();n&&!n.isDeleted&&(n.$.off("propertyChanged.editor").off(".active"),n.deActivate()),this.mainContainer.activeLayer=e,i||this.exitSelectMode(),e&&(this.layerOptions.changeActiveComponent(e,e.type,e.placement.getType(),e.getProperties()),e.$.on({"propertyChanged.editor":t.proxy(this.layerOptions.onUpdateField,this.layerOptions),"placementChanged.active":t.proxy(function(t,i,n){this.layerOptions.changeActiveComponentPlacement(i,e.property)},this)}),e.animations.activate()),this.$.trigger("activeLayerChanged")},i.prototype.highlight=function(t){this.$highlight.appendTo(t.layer)},i.prototype.deHighlight=function(t){this.$highlight.detach()},i.prototype["delete"]=function(){this.mainContainer.getSelectedLayer()&&this.doActionOnActiveLayer("delete")},i.prototype.duplicate=function(){this.mainContainer.getSelectedLayer()&&this.doActionOnActiveLayer("duplicate",[this.selectMode!=r.ON,!1])},i.prototype.copy=function(i){var n;if(i==e)if(1==this.selectMode)n=this.selectedLayers;else{var s=this.mainContainer.getSelectedLayer();s&&(n=this.isCol(s)||this.isContent(s)?s.container.getSortedLayers():[s])}else n=this.isCol(i)||this.isContent(i)?i.container.getSortedLayers():[i];var o=this.mainContainer.getLayerData(n);o.length&&t.jStorage.set("ss3layersclipboard",JSON.stringify(o))},i.prototype.paste=function(i){var n=t.jStorage.get("ss3layersclipboard");if(n){var s=JSON.parse(n);if(s.length){var o;o=i!==e&&i?this.isCol(i)||this.isContent(i)?i:i.group:this.mainContainer.getActiveGroup(),this.mainContainer.addLayers(s,o)}}},i.prototype.hasLayersOnClipboard=function(){return!!t.jStorage.get("ss3layersclipboard")},i.prototype.addContextMenu=function(){this.$editedElement.nextendContextMenu({onShow:t.proxy(function(e,i){var n=t(e.target),s=n.closest(".n2-ss-layer"),o=s.data("layerObject");o||(o=this.mainContainer.getSelectedLayer()),o&&(this.isCol(o)||this.isContent(o)?i.addItem("Copy child layers","n2-i-copy",t.proxy(function(){this.copy(o)},this)):i.addItem("Copy layer","n2-i-copy",t.proxy(function(){this.selectMode==r.ON?this.copy():this.copy(o)},this))),this.hasLayersOnClipboard()&&i.addItem("Paste layer(s)","n2-i-paste",t.proxy(function(){this.paste(o)},this)),i.addItem("Copy slide","n2-i-copy",t.proxy(function(){this.editor.copy()},this)),this.editor.hasClipboard()&&i.addItem("Paste slide","n2-i-paste",t.proxy(function(){this.editor.paste()},this))},this)})},i.prototype.initSelectMode=function(){this.selectMode=r.OFF,this.selectedLayers=[],t(".n2-ss-layer-list-top-bar .n2-button").on("mousedown",t.proxy(function(e){switch(e.preventDefault(),t(e.currentTarget).data("action")){case"delete":this["delete"]();break;case"duplicate":this.duplicate();break;case"group":this.createGroupFromSelected();break;case"cancel":this.exitSelectMode()}},this))},i.prototype.startSelection=function(t){t?(this.selectMode==r.ON&&this.exitSelectMode(),this.changeSelectMode(r.GROUP)):this.changeSelectMode(r.ON)},i.prototype.changeSelectMode=function(e){var i=this.selectMode;i!=e&&(i==r.ON?t("#n2-admin").removeClass("n2-ss-select-layer-mode-on"):i==r.GROUP&&t("#n2-admin").removeClass("n2-ss-select-layer-mode-group"),this.selectMode=e,i==r.GROUP&&e==r.ON&&this.selectedLayers[0].activate(null,null,!0),e==r.OFF?t("#n2-admin").removeClass("n2-ss-select-layer-mode"):(t("#n2-admin").addClass("n2-ss-select-layer-mode"),e==r.ON?t("#n2-admin").addClass("n2-ss-select-layer-mode-on"):e==r.GROUP&&t("#n2-admin").addClass("n2-ss-select-layer-mode-group")),this.selectMode==r.OFF?t("body").off(".n2-ss-selection"):t("body").on("mousedown.n2-ss-selection",t.proxy(function(t){3!=t.which&&"main"==N2Classes.WindowManager.get().getCurrentWindow()&&N2Classes.WindowManager.get().mouseDownArea===!1&&this.exitSelectMode()},this)))},i.prototype.endSelection=function(t){
t&&this.selectMode==r.GROUP&&this.exitSelectMode()},i.prototype.selectLayer=function(t,e){if("layer"!=t.type)return!0;if(this.selectMode!=r.ON){var i=this.mainContainer.getSelectedLayer();if("layer"!=i.type)return t.activate(null),!0;this.startSelection(!1),e&&this.selectedLayers.push(i)}return this._selectLayer(t),!0},i.prototype._selectLayer=function(e){var i=t.inArray(e,this.selectedLayers);if(-1!=i){if(this.selectMode==r.ON&&this.selectedLayers.length<=1)return this.exitSelectMode(),!1;var n=this.selectedLayers[i];if(this.selectedLayers.splice(i,1),e.layerRow.removeClass("n2-selected"),e.layer.removeClass("n2-ss-layer-selected"),this.selectMode==r.ON&&this.selectedLayers.length<=1)return this.selectedLayers[0].activate(),this.exitSelectMode(),!1;n===this.mainContainer.getSelectedLayer()&&this.selectedLayers[0].activate(!1,null,!0)}else{for(var s=this.selectedLayers.length,o=0;o<this.selectedLayers.length;o++)if(e.layer.add(this.selectedLayers[o].layer).index(this.selectedLayers[o].layer)>0){s=o;break}this.selectedLayers.splice(s,0,e)}for(var o=0;o<this.selectedLayers.length;o++)this.selectedLayers[o].layerRow.addClass("n2-selected"),this.selectedLayers[o].layer.addClass("n2-ss-layer-selected")},i.prototype.addSelection=function(t,e){e||this.changeSelectMode(r.ON);for(var i=0;i<t.length;i++)this._selectLayer(t[i],!1)},i.prototype.exitSelectMode=function(){if(this.selectMode){for(var e=0;e<this.selectedLayers.length;e++)this.selectedLayers[e]!=this.mainContainer.getSelectedLayer()&&this.selectedLayers[e].layerRow.removeClass("n2-active"),this.selectedLayers[e].layerRow.removeClass("n2-selected"),this.selectedLayers[e].layer.removeClass("n2-ss-layer-selected");t("#n2-admin").removeClass("n2-ss-select-layer-mode"),this.selectedLayers=[],this.changeSelectMode(r.OFF)}},i.prototype.doActionOnActiveLayer=function(e,i){if(this.selectMode==r.ON)for(var n=t.extend([],this.selectedLayers),s=0;s<n.length;s++)n[s][e].apply(n[s],i);else{var o=this.mainContainer.getSelectedLayer();o&&o[e].apply(o,i)}},i.prototype.canvasDragStart=function(t,e){if(this.selectMode&&"canvas"==this.currentEditorMode&&"absolute"==e.mode){for(var i=!1,n=0;n<this.selectedLayers.length;n++){var s=this.selectedLayers[n],o=s.layer;if(o[0]!=e.layer.layer[0]){var r=o.css("display");"none"==r&&o.css("display",""),s._originalPosition=o.position(),"none"==r&&o.css("display","none")}else i=!0}i||this.exitSelectMode(),this.isMultiDrag=!0}},i.prototype.canvasDragMove=function(t,e){if(this.isMultiDrag===!0)for(var i={left:e.position.left+e.canvasOffset.left-e.originalOffset.left,top:e.position.top+e.canvasOffset.top-e.originalOffset.top},n=0;n<this.selectedLayers.length;n++){var s=this.selectedLayers[n];if(!this.isGroup(s)){var o=s.layer;o[0]!=e.layer.layer[0]&&(o.css({left:s._originalPosition.left+i.left,top:s._originalPosition.top+i.top,bottom:"auto",right:"auto"}),s.placement.doAction("triggerLayerResized"))}}},i.prototype.canvasDragStop=function(t,e){if(this.isMultiDrag===!0){for(var i=0;i<this.selectedLayers.length;i++){var n=this.selectedLayers[i];if(!this.isGroup(n)){var s=n.layer;if(s[0]!=e.layer.layer[0]){var o=s.css("display");"none"==o&&s.css("display","block");var r=parseInt(n.layer.css("left")),a=parseInt(n.layer.css("top"));n.placement.current.setPosition(r,a),n.placement.doAction("triggerLayerResized"),"none"==o&&s.css("display","none")}}}return this.isMultiDrag=!1,!0}return!1},i.prototype.historyDeleteGroup=function(t){t.getSelf()["delete"]()},i.prototype.historyCreateGroup=function(t){var e=new N2Classes.Group(this,this.mainContainer,{},null);e.create(),t.setSelf(e)},i.prototype.createGroupFromSelected=function(){var t;switch(this.selectMode){case r.ON:t=new N2Classes.Group(this,this.mainContainer,{},null),t.create(),N2Classes.History.get().addSimple(this,this.historyDeleteGroup,this.historyCreateGroup,[t]),t.addLayers(this.selectedLayers),this.exitSelectMode(),t.activate();break;case r.OFF:var e=this.mainContainer.getSelectedLayer();e.group instanceof N2Classes.Group?e.group.activate():(t=new N2Classes.Group(this,this.mainContainer,{},null),t.create(),N2Classes.History.get().addSimple(this,this.historyDeleteGroup,this.historyCreateGroup,[t]),t.addLayers([e]),t.activate());break;case r.GROUP:}},i.prototype.createRow=function(t){var e=new N2Classes.Row(this,t,{});return e.create(),e.hightlightStructure(),{layer:e}},i.prototype.createCol=function(t){var e=t,i=null;if(this.isCol(e))i=e.group.createCol();else if(this.isRow(e))i=e.createCol();else{if(!this.isCol(e.group))return this.createRow(t);i=e.group.group.createCol()}return i.activate(null),{layer:i}},i.prototype.preventActivationBubbling=function(){return this.shouldPreventActivationBubble?!1:(this.shouldPreventActivationBubble=!0,!0)},i.prototype.allowActivation=function(){this.shouldPreventActivationBubble=!1},i.prototype.hotkeys=function(){t(window).on({keydown:t.proxy(function(e){var i=!1;if(i=this.layerAnimationManager.timelineControl&&this.layerAnimationManager.timelineControl.isActivated(),"TEXTAREA"!=e.target.tagName&&"INPUT"!=e.target.tagName&&!i){var r=this.mainContainer.getSelectedLayer(),a=e.keyCode;if(a>=49&&57>=a){var l=e.originalEvent.location||e.originalEvent.keyLocation||0;3==l&&(a+=48)}if(r)if(46==a||8==a)this["delete"](),e.preventDefault();else if(35==a)this.duplicate(),e.preventDefault();else if(16==a)n[a]=1;else if(38==a){if(!n[a]){var d=t.proxy(function(){this.doActionOnActiveLayer("moveY",[-1*(n[16]?10:1)])},this);d(),n[a]=setInterval(d,100)}e.preventDefault()}else if(40==a){if(!n[a]){var d=t.proxy(function(){this.doActionOnActiveLayer("moveY",[n[16]?10:1])},this);d(),n[a]=setInterval(d,100)}e.preventDefault()}else if(37==a){if(!n[a]){var d=t.proxy(function(){this.doActionOnActiveLayer("moveX",[-1*(n[16]?10:1)])},this);d(),n[a]=setInterval(d,100)}e.preventDefault()}else if(39==a){if(!n[a]){var d=t.proxy(function(){this.doActionOnActiveLayer("moveX",[n[16]?10:1])},this);d(),n[a]=setInterval(d,100)}e.preventDefault()}else if(a>=97&&105>=a){var h=s[a],p=o[a],c=!1;this.layerOptions.forms.placement.absolute.align.val()==h&&this.layerOptions.forms.placement.absolute.valign.val()==p&&(c=!0),this.layerOptions.layerFeatures.horizontalAlign(h,c),this.layerOptions.layerFeatures.verticalAlign(p,c)}else if(65==a){e.preventDefault();var u=this.mainContainer.getSelectedLayer();u&&"absolute"==u.placement.getType()&&u.placement.current.fit()}(e.ctrlKey||e.metaKey)&&(90==a?e.shiftKey?N2Classes.History.get().redo()&&e.preventDefault():N2Classes.History.get().undo()&&e.preventDefault():71==a?(this.createGroupFromSelected(),e.preventDefault()):68==a?(e.preventDefault(),this.editor.copy()):70==a?(e.preventDefault(),this.editor.paste()):67==a?this.copy():86==a&&this.paste())}},this),keyup:t.proxy(function(t){"undefined"!=typeof n[t.keyCode]&&n[t.keyCode]&&(clearInterval(n[t.keyCode]),n[t.keyCode]=0)},this)})},i.prototype.getSelf=function(){return this},i}),N2D("CanvasUserInterface",function(t,e){"use strict";function i(e){this.fragmentEditor=e,this.isShown=!t.jStorage.get("ssLayersShown",!1),this.tlHeight=t.jStorage.get("ssLayersHeight")||200,this.$container=t("#n2-ss-layers"),this.fixScroll(),this.switchLayerList(),this.topBar=t(".n2-ss-layer-list-top-bar").on("mousedown",t.proxy(this.resizeStart,this)),this.topBar.find(".n2-ss-layer-list-opener").on("click",t.proxy(function(t){t.preventDefault(),this.switchLayerList()},this)),t(".n2-ss-slide-show-layers").on("click",t.proxy(function(t){t.preventDefault(),this.switchLayerList()},this)),this.onResize(),t(window).on("resize",t.proxy(this.onResize,this))}return i.prototype.onResize=function(){this.$container.width(this.$container.parent().width()+2);var t=this.$container.height();this.paneLeft.height(t-48),this.paneRight.height(t-48)},i.prototype.onActivateLayer=function(t){var e=this.paneLeft.scrollTop(),i=0,n=t;do i+=n.layerRow.get(0).offsetTop,n=n.group;while(n!==this.fragmentEditor.mainContainer);(e>i||i>e+this.paneLeft.height()-32)&&(this.paneLeft.scrollTop(i),this.paneRight.scrollTop(i))},i.prototype.fixScroll=function(){this.paneLeft=t(".n2-ss-layers-sidebar-rows"),this.paneRight=t(".n2-ss-timeline-content-layers-container");var e=t.proxy(function(t){var e=this.paneLeft.scrollTop();t.originalEvent.deltaY>0?e+=32:e-=32,e=32*Math.round(e/32),this.paneLeft.scrollTop(e),this.paneRight.scrollTop(e),t.preventDefault()},this);this.paneLeft.on("mousewheel",e),this.paneLeft.on("scroll",t.proxy(function(t){var e=this.paneLeft.scrollTop();this.paneRight.scrollTop(e),t.preventDefault()},this)),this.paneRight.on("mousewheel",e)},i.prototype.resizeStart=function(e){this.isShown&&(e.target==this.topBar[0]||t(e.target).hasClass("n2-h2"))&&(e.preventDefault(),this.startY=e.clientY,this.height=this.$container.height(),t("body").on({"mousemove.n2-ss-tl-resize":t.proxy(this.resizeMove,this),"mouseup.n2-ss-tl-resize":t.proxy(this.resizeStop,this),"mouseleave.n2-ss-tl-resize":t.proxy(this.resizeStop,this)}))},i.prototype.resizeMove=function(t){t.preventDefault(),this.setTLHeight(this._calculateDesiredHeight(t))},i.prototype.resizeStop=function(e){e.preventDefault(),t("body").off(".n2-ss-tl-resize");var i=this._calculateDesiredHeight(e);this.setTLHeight(i),this.tlHeight=i,t.jStorage.set("ssLayersHeight",i),t("#n2-admin").triggerHandler("resize")},i.prototype._calculateDesiredHeight=function(t){var e=this.startY-t.clientY+this.height-48;return this.__calculateDesiredHeight(e)},i.prototype.__calculateDesiredHeight=function(t){return 32*Math.round(Math.min(Math.max(32,t),(window.innerHeight||document.documentElement.clientHeight)/2)/32)+48},i.prototype.switchLayerList=function(){this.isShown=!this.isShown,this.$container.toggleClass("n2-active",this.isShown),this.isShown?this.setTLHeight(this.tlHeight):this.setTLHeight(48),t.jStorage.set("ssLayersShown",this.isShown)},i.prototype.setTLHeight=function(t){t=Math.max(48,t),this.$container.height(t),t=this.$container.height(),this.paneLeft.height(t-48),this.paneRight.height(t-48),nextend.triggerResize()},i.prototype.activateAdd=function(t,e){this.$add.css({left:t,top:e}).appendTo(this.$container)},i}),N2D("LayerFeatures",function(t,e){"use strict";function i(t,e){this.fields=t,this.fragmentEditor=e,this.initParentLinker(),this.initAlign(),this.initEvents()}var n={left:0,center:1,right:2,top:0,middle:1,bottom:2};return i.prototype.initParentLinker=function(){var e=this.fields.parentid.data("field");t("#n2-ss-layer-parent-linker").on({click:function(t){e.click(t)}})},i.prototype.initAlign=function(){this.layerDefault={align:null,valign:null};var e=t("#n2-ss-layer-horizontal-align .n2-radio-option"),i=t("#n2-ss-layer-vertical-align .n2-radio-option");e.add(i).on("click",t.proxy(function(n){if(n.ctrlKey||n.metaKey){var s=t(n.currentTarget),o=s.hasClass("n2-sub-active"),r=s.data("align");switch(r){case"left":case"center":case"right":e.removeClass("n2-sub-active"),o?(t.jStorage.set("ss-item-horizontal-align",null),this.layerDefault.align=null):(t.jStorage.set("ss-item-horizontal-align",r),this.layerDefault.align=r,s.addClass("n2-sub-active"));break;case"top":case"middle":case"bottom":i.removeClass("n2-sub-active"),o?(t.jStorage.set("ss-item-vertical-align",null),this.layerDefault.valign=null):(t.jStorage.set("ss-item-vertical-align",r),this.layerDefault.valign=r,s.addClass("n2-sub-active"))}}else if(this.fragmentEditor.mainContainer.getSelectedLayer()){var r=t(n.currentTarget).data("align");switch(r){case"left":case"center":case"right":this.horizontalAlign(r,!0);break;case"top":case"middle":case"bottom":this.verticalAlign(r,!0)}}},this)),this.fields.align.on("nextendChange",t.proxy(function(){switch(e.removeClass("n2-active"),this.fields.align.val()){case"left":e.eq(0).addClass("n2-active");break;case"center":e.eq(1).addClass("n2-active");break;case"right":e.eq(2).addClass("n2-active")}},this)),this.fields.valign.on("nextendChange",t.proxy(function(){switch(i.removeClass("n2-active"),this.fields.valign.val()){case"top":i.eq(0).addClass("n2-active");break;case"middle":i.eq(1).addClass("n2-active");break;case"bottom":i.eq(2).addClass("n2-active")}},this));var s=t.jStorage.get("ss-item-horizontal-align",null),o=t.jStorage.get("ss-item-vertical-align",null);null!=s&&(e.eq(n[s]).addClass("n2-sub-active"),this.layerDefault.align=s),null!=o&&(i.eq(n[o]).addClass("n2-sub-active"),this.layerDefault.valign=o)},i.prototype.horizontalAlign=function(t,e){this.fields.align.val()!=t?this.fields.align.data("field").options.eq(n[t]).trigger("click"):e&&this.fields.left.val(0).trigger("change")},i.prototype.verticalAlign=function(t,e){this.fields.valign.val()!=t?this.fields.valign.data("field").options.eq(n[t]).trigger("click"):e&&this.fields.top.val(0).trigger("change")},i.prototype.initEvents=function(){var e=t("#n2-tab-events"),i=e.find(".n2-h3"),n=i.html(),s=t('<div class="n2-editor-header n2-h2 n2-uc"><span>'+n+"</span></div>");i.replaceWith(s)},i}),N2D("LayerWindow",function(t,e){"use strict";function i(e){this.isMinimized=!1,this.detachedPosition={left:t.jStorage.get("ssPanelLeft")||200,top:t.jStorage.get("ssPanelTop")||100,height:t.jStorage.get("ssPanelHeight")||400},this.hasBreadcrumb=!1,this.lastHeight=this.detachedPosition.height,this.admin=t("#n2-admin"),this.sidebar=t("#n2-ss-layer-window").on("mousedown",t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"sidebarClicked")),this.title=this.sidebar.find(".n2-ss-layer-window-title-inner"),this.fragmentEditor=e,this.viewPanes={layerEdit:t("#n2-tabbed-slide-editor-settings > .n2-tabs").addClass("n2-scrollable")};for(var i in this.viewPanes)this.viewPanes[i].on("DOMMouseScroll mousewheel",function(e){var i=!1;e.originalEvent&&(e.originalEvent.wheelDelta&&(i=e.originalEvent.wheelDelta/-1<0),e.originalEvent.deltaY&&(i=e.originalEvent.deltaY<0),e.originalEvent.detail&&(i=e.originalEvent.detail<0));var n=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!i&&this.scrollHeight<=t(this).innerHeight()+this.scrollTop+1?n():i&&0>=this.scrollTop-1?n():void 0});this.panelHeading=t("#n2-tabbed-slide-editor-settings").find(".n2-sidebar-tab-switcher .n2-td");var n=this.sidebar.find(".n2-ss-layer-window-title-nav-left");t('<a href="#"><i class="n2-i n2-i-minimize n2-i-grey-opacity"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.toggleMinimize()},this)).appendTo(n);var s=this.sidebar.find(".n2-ss-layer-window-title-nav-right");t('<a href="#"><i class="n2-i n2-i-closewindow n2-i-grey-opacity"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.hide()},this)).appendTo(s),nextend.tooltip.add(s),this.$breadcrumb=t('<div class="n2-ss-layer-window-breadcrumb"></div>').insertAfter("#n2-tabbed-slide-editor-settings > .n2-sidebar-tab-switcher");var o=t("#n2-ss-add-sidebar");t(".n2-ss-add-layer-button").on("click",function(e){e.preventDefault(),t("#n2-ss-layers-switcher > .n2-labels .n2-td").eq(0).trigger("click"),o.toggleClass("n2-active")}),t(".n2-ss-core-item").on("click",function(t){o.removeClass("n2-active")});var r=t("#wpadminbar, .navbar-fixed-top").height()+t(".n2-top-bar").height();this.$verticalBarInner=t(".n2-ss-add-sidebar-inner").each(function(){var e=t(this);e.fixTo(e.parent(),{top:r})}),this.$resizeInnerContainer=t("#n2-ss-layers-switcher_0, #n2-ss-layers-switcher_1"),this.extraHeightToRemove=60,this.$resizeInnerContainer.length||(this.extraHeightToRemove=0,this.$resizeInnerContainer=this.$verticalBarInner),this.$resizeInnerContainer.css("overflow","auto"),this.detach(),t("#n2-admin").on("resize",t.proxy(this.resizeVerticalBar,this)),t(window).on("resize",t.proxy(this.onResize,this)),t(".n2-ss-slide-duplicate-layer").on("click",t.proxy(function(t){t.preventDefault(),this.duplicate()},this.fragmentEditor)),t(".n2-ss-slide-delete-layer").on("click",t.proxy(function(t){t.preventDefault(),this["delete"]()},this.fragmentEditor)),t("body").on("mousedown",t.proxy(function(t){"main"==N2Classes.WindowManager.get().getCurrentWindow()&&N2Classes.WindowManager.get().mouseDownArea===!1&&this.hide()},this));var a=t('<div id="n2-ss-devicespecific-settings"></div>'),l=this.fragmentEditor.editor.getAvailableDeviceModes();for(var i in l)if(l[i]){var d=i.replace(/([A-Z])/g," $1").split(" "),h=d[0],p=d[1].toLowerCase();a.append('<i class="n2-i n2-it n2-i-mini-'+h+"-"+p+'" data-device="'+h+'" data-orientation="'+p+'"></i>')}var c={mouseenter:t.proxy(function(t){a.appendTo(t.currentTarget)},this),mouseleave:t.proxy(function(t){a.detach()},this)};this.sidebar.find("[data-devicespecific] label").prepend('<span class="n2-i n2-i-mini-desktop-portrait"></span>'),this.sidebar.find("[data-devicespecific] label").on(c),a.find(".n2-i").on({click:t.proxy(function(e){e.preventDefault();var i=t(e.currentTarget);t("#n2-ss-devices").find('[data-device="'+i.data("device")+'"][data-orientation="'+i.data("orientation")+'"]').trigger("click")},this)})}return i.prototype.toggleMinimize=function(){this.isMinimized=!this.isMinimized,this.sidebar.toggleClass("n2-ss-layer-window-minized",this.isMinimized),this.isMinimized||this.onResize()},i.prototype.magnetize=function(){if(!this.autoPosition){this.autoPosition=1,t.jStorage.set("ssPanelAutoPosition",1),this.magnet.css("display","none");var e=this.fragmentEditor.mainContainer.getSelectedLayer();e&&e.positionSidebar()}},i.prototype.show=function(e,i){this.setTitle(e),t("body").addClass("n2-ss-layer-edit-visible")},i.prototype._show=function(){t("body").addClass("n2-ss-layer-edit-visible")},i.prototype.hide=function(){t("body").removeClass("n2-ss-layer-edit-visible")},i.prototype.isVisible=function(){return t("body").hasClass("n2-ss-layer-edit-visible")},i.prototype.hideWithDeferred=function(e){t("body").hasClass("n2-ss-layer-edit-visible")&&(this.hide(),e.done(t.proxy(this._show,this)))},i.prototype.setTitle=function(t){this.title.html(t.getName()),this.updateGroupTitle(t)},i.prototype.updateGroupTitle=function(e){var i;for(this.$breadcrumb.html(""),i=0;5>i&&(t('<span class="n2-window-title-structure-nav"><span>'+e.label+'</span><span class="n2-i n2-it n2-i-mini-arrow-thin"></span></span>').on({mouseenter:t.proxy(function(){this.fragmentEditor.highlight(this)},e),mouseleave:t.proxy(function(){this.fragmentEditor.deHighlight(this)},e),click:t.proxy(function(t){this.fragmentEditor.deHighlight(this),this.activate(t)},e)}).prependTo(this.$breadcrumb),e.group&&e.group!==this.fragmentEditor.mainContainer);i++)e=e.group;this.hasBreadcrumb=i>0,this.$breadcrumb.toggleClass("n2-has-breadcrumb",this.hasBreadcrumb),this.onResize()},i.prototype.getLayerEditExcludedHeight=function(){return 85+(this.hasBreadcrumb?23:0)},i.prototype.resizeVerticalBar=function(){this.$resizeInnerContainer.height((window.innerHeight||document.documentElement.clientHeight)-(t("#n2-ss-layers").is(":visible")&&t("#n2-ss-layers").hasClass("n2-active")?t("#n2-ss-layers").height():0)-t("#wpadminbar, .navbar-fixed-top").height()-t(".n2-top-bar").height()-this.extraHeightToRemove)},i.prototype.onResize=function(){this.sidebar.css("display","block"),this.resizeVerticalBar();var t=window.innerHeight||document.documentElement.clientHeight,e=this.sidebar.height()-this.getLayerEditExcludedHeight();this.viewPanes.layerEdit.height(e);var i={},n=window.innerWidth||document.documentElement.clientWidth,s=this.sidebar[0].getBoundingClientRect();s.left<0?i.left=0:s.left+s.width>n&&(i.left=Math.max(0,n-s.width)),s.height>t-s.top&&(i.top=t-s.top-s.height+s.top,i.top<0&&(this.lastHeight=i.height=s.height+i.top,i.top=0)),this.sidebar.css(i),this.sidebar.css("display","")},i.prototype.detach=function(){this.sidebar.css(this.detachedPosition),this.sidebar.appendTo(this.admin),this.admin.addClass("n2-sidebar-hidden"),t(window).off(".n2-ss-panel"),this.sidebar.removeClass("n2-sidebar-fixed"),this.sidebar.nUIDraggable({distance:5,handle:".n2-ss-layer-window-title",containment:"window",stop:t.proxy(function(e,i){this.sidebar.css("height",this.lastHeight);var n=this.sidebar[0].getBoundingClientRect();this.detachedPosition.left=n.left,this.detachedPosition.top=n.top,t.jStorage.set("ssPanelLeft",n.left),t.jStorage.set("ssPanelTop",n.top)},this),scroll:!1}).nUIResizable({distance:5,handles:"s",stop:t.proxy(function(e,i){this.lastHeight=this.detachedPosition.height=this.sidebar.height(),t.jStorage.set("ssPanelHeight",this.detachedPosition.height)},this),create:t.proxy(function(e,i){t(e.target).find(".nui-resizable-handle").addClass("n2-ss-layer-window-resizer")},this)}),this.onResize(),nextend.triggerResize()},i.prototype.switchTab=function(t){this.panelHeading.filter('[data-tab="'+t+'"]').trigger("click")},i}),N2D("PositionDisplay",function(t,e){"use strict";function i(){this.currentSource="",t(window).ready(t.proxy(this._ready,this))}return i.prototype._ready=function(){this.$body=t("body"),this.$el=t('<div class="n2 n2-ss-position-display"/>').appendTo("body")},i.prototype.show=function(t){""==this.currentSource&&(this.currentSource=t,this.$el.addClass("n2-active"),this.$body.addClass("n2-position-display-active"))},i.prototype.update=function(t,e,i){this.currentSource==e&&this.$el.html(i).css({left:t.pageX+10,top:t.pageY+10})},i.prototype.hide=function(t){this.currentSource!=t&&t!==e||(this.$body.removeClass("n2-position-display-active"),this.$el.removeClass("n2-active"),this.currentSource="")},i.get=function(){var t=new i;return i.get=function(){return t},t},i}),N2D("Ruler",function(t,e){"use strict";function i(e,i){this.editor=e,this.showGuides=1,this.guides=[],this.container=t('<div class="n2-ruler-container" />').appendTo("#n2-ss-slide-canvas-container-inner .n2-ss-slider-outer-container"),this.scale=10,this.vertical=t('<div class="n2-ruler n2-ruler-vertical unselectable"></div>').appendTo(".n2-ss-slider-real-container"),this.horizontal=t('<div class="n2-ruler n2-ruler-horizontal unselectable"></div>').appendTo(this.container),this.verticalSpans=t(),this.horizontalSpans=t(),this.onResize(),t(window).on("resize",t.proxy(this.onResize,this)),this.horizontal.on("mousedown",t.proxy(function(t){this.showGuides&&new s(this,this.horizontal,t)},this)),this.vertical.on("mousedown",t.proxy(function(t){this.showGuides&&new o(this,this.vertical,t)},this));try{i=t.extend({vertical:[],horizontal:[]},JSON.parse(N2Classes.Base64.decode(i)));for(var n=0;n<i.horizontal.length;n++){var r=new s(this,this.horizontal);r.setPosition(i.horizontal[n])}for(var n=0;n<i.vertical.length;n++){var r=new o(this,this.vertical);r.setPosition(i.vertical[n])}}catch(a){}this.measureToolVertical(),this.measureToolHorizontal()}function n(e,i,n){this.ruler=e,this.container=i,this.position=0,this.guide=t('<div class="n2-ruler-guide n2-ruler-user-guide"><div class="n2-ruler-guide-border"></div><div class="n2-ruler-guide-handle"></div></div>').appendTo(i).on("mousedown",t.proxy(function(t){t.preventDefault(),t.stopPropagation(),e.editor.fragmentEditor.canvasSettings.settings["n2-ss-lock-guides"]||this["delete"]()},this)),this.ruler.addGuide(this),n&&this.create(n)}function s(){n.prototype.constructor.apply(this,arguments)}function o(){n.prototype.constructor.apply(this,arguments)}return i.prototype.addGuide=function(t){this.guides.push(t)},i.prototype.removeGuide=function(e){this.guides.splice(t.inArray(e,this.guides),1)},i.prototype.clearGuides=function(){for(var t=this.guides.length-1;t>=0;t--)this.guides[t]["delete"]()},i.prototype.onResize=function(){var e=t(".n2-ss-slider-outer-container"),i=e.width(),n=e.height();this.container.css({width:i+40,height:n+40});for(var s=this.horizontalSpans.length-3;s<i/this.scale;s++){var o=t("<span />").appendTo(this.horizontal);s%10==0?o.addClass("n2-ss-ruler-mark-large").append("<span>"+s/10*100+"</span>"):s%2==0&&o.addClass("n2-ss-ruler-mark-medium"),this.horizontalSpans=this.horizontalSpans.add(o)}for(var s=this.verticalSpans.length-3;s<n/this.scale;s++){var o=t("<span />").appendTo(this.vertical);s%10==0?o.addClass("n2-ss-ruler-mark-large").append("<span>"+s/10*100+"</span>"):s%2==0&&o.addClass("n2-ss-ruler-mark-medium"),this.verticalSpans=this.verticalSpans.add(o)}},i.prototype.toArray=function(){for(var t={horizontal:[],vertical:[]},e=0;e<this.guides.length;e++)this.guides[e]instanceof s?t.horizontal.push(this.guides[e].position):this.guides[e]instanceof o&&t.vertical.push(this.guides[e].position);return t},i.prototype.measureToolVertical=function(){var e=t('<div class="n2-ruler-guide" style="z-index:1;"><div class="n2-ruler-guide-border" style="border-color: #f00;"></div></div>').css("display","none").appendTo(this.vertical),i=!1,n=t.proxy(function(){i||(i=!0,e.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))},this),s=t.proxy(function(){i&&(i=!1,e.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))},this);this.vertical.on({mouseenter:t.proxy(function(i){if(this.showGuides){var o=0,r=Math.round(this.vertical.offset().top);n(),this.vertical.on("mousemove.n2-ruler-measure-tool",t.proxy(function(i){if(t(i.target).hasClass("n2-ruler-guide-border")&&t(i.target).parent()[0]!=e[0])s();else if(n(),o!=i.pageY){var a=i.pageY-r;e.css("top",a),N2Classes.PositionDisplay.get().update(i,"Guide",a-40+"px"),o=i.pageY}},this))}},this),mouseleave:t.proxy(function(){this.vertical.off(".n2-ruler-measure-tool"),s()},this)})},i.prototype.measureToolHorizontal=function(){var e=t('<div class="n2-ruler-guide" style="z-index:1;"><div class="n2-ruler-guide-border" style="border-color: #f00;"></div></div>').css("display","none").appendTo(this.horizontal),i=!1,n=t.proxy(function(){i||(i=!0,e.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))},this),s=t.proxy(function(){i&&(i=!1,e.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))},this);this.horizontal.on({mouseenter:t.proxy(function(i){if(this.showGuides){var o=0,r=Math.round(this.horizontal.offset().left);n(),this.horizontal.on("mousemove.n2-ruler-measure-tool",t.proxy(function(i){if(t(i.target).hasClass("n2-ruler-guide-border")&&t(i.target).parent()[0]!=e[0])s();else if(n(),o!=i.pageX){var a=Math.max(i.pageX-r,40);e.css("left",a),N2Classes.PositionDisplay.get().update(i,"Guide",a-40+"px"),o=i.pageX}},this))}},this),mouseleave:t.proxy(function(){this.horizontal.off(".n2-ruler-measure-tool"),s()},this)})},n.prototype._position=function(t,e){return Math.max(0,t)},n.prototype.setPosition=function(t){this.position=t,this.refresh()},n.prototype.refresh=function(){this.positionRender(this.position)},n.prototype["delete"]=function(){this.ruler.removeGuide(this),this.guide.remove()},s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.create=function(t){var e=Math.round(this.container.offset().left)+40;this.position=this._position(t.pageX-e,t),this.positionRender(this.position)},s.prototype.rawPositionRender=function(t){this.guide.css("left",Math.max(0,t)+40)},s.prototype.positionRender=function(t){this.guide.css("left",Math.max(0,t)+40)},o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.create=function(t){var e=Math.round(this.container.offset().top)+40;this.position=this._position(t.pageY-e,t),this.positionRender(this.position)},o.prototype.rawPositionRender=function(t){this.guide.css("top",Math.max(0,t)+40)},o.prototype.positionRender=function(t){this.guide.css("top",Math.max(0,t)+40)},i}),N2D("CanvasSettings",function(t,e){"use strict";function i(e){this.fragmentEditor=e,this.settings={};var i=t("#n2-ss-slide-canvas-settings").on("mouseleave",t.proxy(function(){i.removeClass("n2-active")},this));i.find("> a").on("click",function(t){t.preventDefault(),i.toggleClass("n2-active")}),this.$settingsPanel=i.find(".n2-ss-settings-panel-inner"),this.snapTo(),this.roundTo(),this.colorScheme(),this.fragmentEditor.editor.options.isAddSample||this.startRuler()}return i.prototype._addSettings=function(e,i,n,s){this.settings[e]=parseInt(t.jStorage.get(e,n));var o=t('<a href="#">'+i+'<span class="n2-setting-tick"><i class="n2-i n2-it n2-i-tick2"></i></span></a>').on("click",t.proxy(function(i){i.preventDefault(),this.settings[e]=1==this.settings[e]?0:1,t.jStorage.set(e,this.settings[e]),o.toggleClass("n2-setting-enabled",1==this.settings[e]),s(this.settings[e],!1)},this)).appendTo(this.$settingsPanel);o.toggleClass("n2-setting-enabled",1==this.settings[e]),s(this.settings[e],!0)},i.prototype._addAction=function(e,i){t('<a href="#" class="n2-panel-action">'+e+"</a>").on("click",t.proxy(function(t){t.preventDefault(),i()},this)).appendTo(this.$settingsPanel)},i.prototype.get=function(t){return this.settings[t]},i.prototype.snapTo=function(){this._addSettings("n2-ss-snap-to-enabled",n2_("Smart Snap"),1,t.proxy(function(t){for(var e=this.mainContainer.container.getSortedLayers(),i=0;i<e.length;i++)e[i].placement.doAction("snap")},this.fragmentEditor))},i.prototype.roundTo=function(){this._addSettings("n2-ss-round-to-enabled",n2_("Round to 5px"),1,function(t){1==t?nextend.roundTo=5:nextend.roundTo=1})},i.prototype.colorScheme=function(){var e=t("#n2-ss-slide-canvas-container");this._addSettings("n2-ss-theme-dark",n2_("Dark Mode"),0,function(t){e.toggleClass("n2-ss-theme-dark",1==t)})},i.prototype.startRuler=function(){this.ruler=new N2Classes.Ruler(this.fragmentEditor.editor,t("#slideguides").val());var e=t("#n2-ss-slide-canvas-container");this._addSettings("n2-ss-ruler-enabled",n2_("Ruler"),1,t.proxy(function(t){e.toggleClass("n2-ss-has-ruler",1==t),nextend.triggerResize()},this)),this._addSettings("n2-ss-show-guides",n2_("Show Guides"),1,t.proxy(function(t){this.ruler.showGuides=t,e.toggleClass("n2-ss-show-guides",1==t)},this)),this._addSettings("n2-ss-lock-guides",n2_("Lock Guides"),0,t.proxy(function(t){e.toggleClass("n2-ss-lock-guides",1==t)},this)),this._addAction(n2_("Clear Guides"),t.proxy(function(){this.ruler.clearGuides()},this))},i}),N2D("PlacementAbsolute",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="absolute",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments),this.doThrottledTheResize=this.doTheResize,this._triggerLayerResizedThrottled=NextendThrottle(this._triggerLayerResized,30),this.parentIsVisible=!0,this.children=[]}var n=function(){var t=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var i,n=(new Date).getTime();return i=Math.max(0,16-(n-t)),t=n+i,setTimeout(function(){e(n+i)},i)}}(),s={raf:!1,ratios:null,isThrottled:!1,layers:[]},o=function(){s.raf===!1&&(s.raf=!0,n(function(){for(var t=0;t<s.layers.length;t++)s.layers[t].isDeleted||s.layers[t].doTheResize(s.ratios,!0,s.isThrottled);s={raf:!1,ratios:null,isThrottled:!1,layers:[]}}))};return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer,this.$layerRow=this.layer.layerRow},i.prototype.preActivation=function(t){if("normal"==t.type){var e=this.layer.getProperty("height");e>0&&(this.transferredProperties.height=e)}},i.prototype.activated=function(e){var i=this.$layer.data("parentid");if(i){var n=t("#"+i);n.length>0?this.activatedAfterParentReady(e):setTimeout(t.proxy(function(){this.activatedAfterParentReady(e)},this),300)}else this._activated(e)},i.prototype.activatedAfterParentReady=function(e){var i=this.$layer.data("parentid");if(i){var n=t("#"+i);if(n.length>0){var s=n.data("layerObject");s?s.readyDeferred.done(t.proxy(this._activated,this,e)):n.on("layerStarted",t.proxy(function(i,n){n.readyDeferred.done(t.proxy(this._activated,this,e))},this))}else this.$layer.data("parentid",""),this._activated(e)}else this._activated(e)},i.prototype._activated=function(e){this.loadProperties(t.extend(e,this.transferredProperties)),this.transferredProperties={},this.$layer.css("zIndex",""),this.___makeLayerAlign(),this.___makeLayerResizeable()},i.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""});for(var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],n={},s=0;s<i.length;s++){
var o=i[s].toLowerCase();n[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();n[a+o]=t.data(a+o),t.removeAttr(a+o),t.removeData(a+o)}}return n},i.prototype.deActivated=function(t){var e=this.layer.getProperty("parentid");e&&""!=e&&(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent()),this.$layer.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""}),this.alignMarker.remove(),this.$layer.nUIResizable("destroy"),this.$layer.off(".n2-ss-absolute"),this.$layer.triggerHandler("LayerUnavailable");var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],n=this.layer.getPropertiesData(i);return this.layer.removeProperties(i),this.chainParent.remove(),n},i.prototype.loadProperties=function(e){this.layer.createProperty("parentid",null,this.layer.layer,this),this.layer.createProperty("responsiveposition",1,this.layer.layer,this),this.layer.createProperty("responsivesize",1,this.layer.layer,this),this.layer.createDeviceProperty("parentalign",{desktopPortrait:"center"},this.layer.layer,this),this.layer.createDeviceProperty("parentvalign",{desktopPortrait:"middle"},this.layer.layer,this),this.layer.createDeviceProperty("align",{desktopPortrait:e.align||"center"},this.layer.layer,this),this.layer.createDeviceProperty("valign",{desktopPortrait:e.valign||"middle"},this.layer.layer,this),this.layer.createDeviceProperty("left",{desktopPortrait:e.left||0},this.layer.layer,this),this.layer.createDeviceProperty("top",{desktopPortrait:e.top||0},this.layer.layer,this),this.layer.createDeviceProperty("width",{desktopPortrait:e.width||"auto"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:e.height||"auto"},this.layer.layer,this);var i=this.layer.layer;this.subscribeParentCallbacks={},this.layer.getProperty("parentid")&&this.subscribeParent(),i.attr({"data-align":this.layer.getProperty("align"),"data-valign":this.layer.getProperty("valign")});var n=null;this.chainParent=t('<div class="n2-ss-layer-chain-parent n2-button n2-button-icon n2-button-xs n2-radius-s n2-button-blue"><i class="n2-i n2-i-layerunlink"></i></div>').on({click:t.proxy(this.unlink,this),mouseenter:t.proxy(function(){n=t("#"+this.layer.getProperty("parentid")).addClass("n2-highlight")},this),mouseleave:t.proxy(function(){n&&(n.removeClass("n2-highlight"),n=null)},this)}).appendTo(this.$layer)},i.prototype.triggerLayerResized=function(t,e){t?this._triggerLayerResized(t,e):this._triggerLayerResizedThrottled(!0,e)},i.prototype._triggerLayerResized=function(t,e){this.layer.isDeleted||this.$layer.triggerHandler("LayerResized",[e||{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.fragmentEditor.getResponsiveRatioVertical()},t||!1])},i.prototype.___makeLayerAlign=function(){this.alignMarker=t('<div class="n2-ss-layer-cc" />').appendTo(this.$layer)},i.prototype.___makeLayerResizeable=function(){this._resizableJustClick=!1,this.$layer.nUIResizable({handles:"n, e, s, w, ne, se, sw, nw",_containment:this.fragmentEditor.mainContainer.layer,start:t.proxy(this.____makeLayerResizeableStart,this),resize:t.proxy(this.____makeLayerResizeableResize,this),stop:t.proxy(this.____makeLayerResizeableStop,this),create:t.proxy(function(){this.$layer.find(".nui-resizable-handle, .n2-ss-layer-cc").on({mousedown:t.proxy(function(t){this._resizableJustClick=[t.clientX,t.clientY]},this),mouseup:t.proxy(function(e){if(this._resizableJustClick&&Math.abs(Math.sqrt(Math.pow(this._resizableJustClick[0]-e.clientX,2)+Math.pow(this._resizableJustClick[1]-e.clientY,2)))<1){var i=t(e.currentTarget),n=this.fragmentEditor.layerOptions.layerFeatures;i.hasClass("nui-resizable-nw")?(n.horizontalAlign("left",!1),n.verticalAlign("top",!1)):i.hasClass("nui-resizable-w")?(n.horizontalAlign("left",!1),n.verticalAlign("middle",!1)):i.hasClass("nui-resizable-sw")?(n.horizontalAlign("left",!1),n.verticalAlign("bottom",!1)):i.hasClass("nui-resizable-n")?(n.horizontalAlign("center",!1),n.verticalAlign("top",!1)):i.hasClass("n2-ss-layer-cc")?(n.horizontalAlign("center",!1),n.verticalAlign("middle",!1)):i.hasClass("nui-resizable-s")?(n.horizontalAlign("center",!1),n.verticalAlign("bottom",!1)):i.hasClass("nui-resizable-ne")?(n.horizontalAlign("right",!1),n.verticalAlign("top",!1)):i.hasClass("nui-resizable-e")?(n.horizontalAlign("right",!1),n.verticalAlign("middle",!1)):i.hasClass("nui-resizable-se")&&(n.horizontalAlign("right",!1),n.verticalAlign("bottom",!1))}this._resizableJustClick=!1},this)})},this),smartguides:t.proxy(function(){return this.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this),tolerance:5}).on({"mousedown.n2-ss-absolute":t.proxy(function(t){!this.layer.status!=N2Classes.ComponentAbstract.STATUS.LOCKED&&(N2Classes.PositionDisplay.get().show("Canvas"),N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+parseInt(this.$layer.width())+"px<br />H: "+parseInt(this.$layer.height())+"px")),document.activeElement&&document.activeElement.blur()},this),"mouseup.n2-ss-absolute":t.proxy(function(t){N2Classes.PositionDisplay.get().hide("Canvas")},this)})},i.prototype.____makeLayerResizeableStart=function(e,i){this.preventActivation=!0,this.resizableDeferred=t.Deferred(),this.fragmentEditor.layerWindow.hideWithDeferred(this.resizableDeferred),t("body").addClass("n2-ss-resize-layer"),this._resizableJustClick&&(this._resizableJustClick=!1),this.____makeLayerResizeableResize(e,i),N2Classes.PositionDisplay.get().show("Canvas")},i.prototype.____makeLayerResizeableResize=function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+e.size.width+"px<br />H: "+e.size.height+"px"),this.triggerLayerResized()},i.prototype.____makeLayerResizeableStop=function(e,i){t("body").removeClass("n2-ss-resize-layer"),this.resizableDeferred.resolve();var n=!1;if("n"==i.axis||"s"==i.axis||i.originalSize.width==i.size.width){var s=this.layer.getProperty("width");this.layer.isDimensionPropertyAccepted(s)&&(n=!0,this._syncwidth())}var o=!1;if("e"==i.axis||"w"==i.axis||i.originalSize.height==i.size.height){var s=this.layer.getProperty("height");this.layer.isDimensionPropertyAccepted(s)&&(o=!0,this._syncheight())}var r=this.fragmentEditor.getResponsiveRatioHorizontal(),a=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsivesize"))||(r=a=1);var l=null;n||(l=Math.round(i.size.width*(1/r)));var d=null;o||(d=Math.round(i.size.height*(1/a))),this._setPosition(null,null,i.position.left,i.position.top,l,d,!0),this.triggerLayerResized(),this.$layer.triggerHandler("LayerUnParent"),N2Classes.PositionDisplay.get().hide("Canvas"),setTimeout(t.proxy(function(){this.preventActivation=!1},this),80)},i.prototype._setPosition=function(t,e,i,n,s,o,r){var a=this.layer.getMode();null===t&&(t=this.layer.getProperty("align")),null===e&&(e=this.layer.getProperty("valign")),null===i?i=this.layer.getProperty("left"):r&&(i=this.calculatePositionLeft(t,i)),null===n?n=this.layer.getProperty("top"):r&&(n=this.calculatePositionTop(e,n)),null===s&&(s=this.layer.getProperty("width")),null===o&&(o=this.layer.getProperty("height"));var l=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStorePosition",a]);l&&l.setValues({align:this.layer.getRawProperty("align"),valign:this.layer.getRawProperty("valign"),left:this.layer.getRawProperty("left"),top:this.layer.getRawProperty("top"),width:this.layer.getRawProperty("width"),height:this.layer.getRawProperty("height")},{align:t,valign:e,left:i,top:n,width:s,height:o}),N2Classes.History.get().off(),this.layer.store("width",s,!0,"layer"),this.layer.$.trigger("propertyChanged",["width",s]),this.layer.store("height",o,!0,"layer"),this.layer.$.trigger("propertyChanged",["height",o]),this.layer.store("align",t,!0,"layer"),this.layer.$.trigger("propertyChanged",["align",t]),this.layer.store("valign",e,!0,"layer"),this.layer.$.trigger("propertyChanged",["valign",e]),this.layer.store("left",i,!0,"layer"),this.layer.$.trigger("propertyChanged",["left",i]),this.layer.store("top",n,!0,"layer"),this.layer.$.trigger("propertyChanged",["top",n]),N2Classes.History.get().on()},i.prototype.historyStorePosition=function(t,e){this.layer.historyStore(t.align,"align",e),this.layer.historyStore(t.valign,"valign",e),this.layer.historyStore(t.width,"width",e),this.layer.historyStore(t.height,"height",e),this.layer.historyStore(t.left,"left",e),this.layer.historyStore(t.top,"top",e),this.triggerLayerResized()},i.prototype.calculatePositionLeft=function(t,e){var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var n=this.parent,s={left:0,leftMultiplier:1};if(n&&n.is(":visible")){var o=n.position();switch(this.layer.getProperty("parentalign")){case"right":s.left=o.left+n.width();break;case"center":s.left=o.left+n.width()/2;break;default:s.left=o.left}}else switch(n=this.$layer.parent(),t){case"center":s.left+=n.width()/2;break;case"right":s.left+=n.width()}var e;switch(t){case"left":e=-Math.round((s.left-e)*(1/i));break;case"center":e=-Math.round((s.left-e-this.$layer.width()/2)*(1/i));break;case"right":e=-Math.round((s.left-e-this.$layer.width())*(1/i))}return e},i.prototype.calculatePositionTop=function(t,e){var i=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var n=this.parent,s={top:0,topMultiplier:1};if(n&&n.is(":visible")){var o=n.position();switch(this.layer.getProperty("parentvalign")){case"bottom":s.top=o.top+n.height();break;case"middle":s.top=o.top+n.height()/2;break;default:s.top=o.top}}else switch(n=this.$layer.parent(),t){case"middle":s.top+=n.height()/2;break;case"bottom":s.top+=n.height()}var e;switch(t){case"top":e=-Math.round((s.top-e)*(1/i));break;case"middle":e=-Math.round((s.top-e-this.$layer.height()/2)*(1/i));break;case"bottom":e=-Math.round((s.top-e-this.$layer.height())*(1/i))}return e},i.prototype.moveX=function(t){this._setPosition(null,null,this.layer.getProperty("left")+t,null,null,null,!1)},i.prototype.moveY=function(t){this._setPosition(null,null,null,this.layer.getProperty("top")+t,null,null,!1)},i.prototype.setPositionLeft=function(t){t=this.calculatePositionLeft(this.layer.getProperty("align"),t),this.layer.store("left",t,!0),this.layer.$.trigger("propertyChanged",["left",t])},i.prototype.setPositionTop=function(t){t=this.calculatePositionTop(this.layer.getProperty("valign"),t),this.layer.store("top",t,!0),this.layer.$.trigger("propertyChanged",["top",t])},i.prototype.setPosition=function(t,e){this.setPositionLeft(t),this.setPositionTop(e)},i.prototype.setDeviceBasedAlign=function(){var t=this.layer.getMode();"undefined"==typeof this.layer.deviceProperty[t].align&&this.layer.setProperty("align",this.layer.getProperty("align"),"layer"),"undefined"==typeof this.layer.deviceProperty[t].valign&&this.layer.setProperty("valign",this.layer.getProperty("valign"),"layer")},i.prototype.setPropertyresponsiveposition=i.prototype.setPropertyresponsivesize=function(t,e,i){this.layer._setProperty(t,parseInt(e),i)},i.prototype.setPropertywidth=i.prototype.setPropertyheight=function(e,i,n){var s=i;this.layer.isDimensionPropertyAccepted(i)||(s=~~i,s!=i&&this.layer.$.trigger("propertyChanged",[e,s])),setTimeout(t.proxy(function(){this.onResize(!1)},this),50),this.layer._setProperty(e,s,n)},i.prototype.setPropertyleft=i.prototype.setPropertytop=function(t,e,i){var n=~~e;n!=e&&this.layer.$.trigger("propertyChanged",[t,n]),this.layer._setProperty(t,n,i)},i.prototype.render=function(t){this["_sync"+t]()},i.prototype.renderWithModifier=function(t,e,i){try{"width"!=t&&"height"!=t||!this.layer.isDimensionPropertyAccepted(e)?this["_sync"+t](Math.round(e*i)):this["_sync"+t](e)}catch(n){console.error("_sync"+t)}},i.prototype.onResize=function(t){this.resize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.fragmentEditor.getResponsiveRatioVertical()},t)},i.prototype.resize=function(t,e){this.parent&&!e||this.addToResizeCollection(this,t,!1)},i.prototype.addToResizeCollection=function(t,e,i){s.ratios=e,s.isThrottled=i;for(var n=0;n<s.layers.length;n++)if(s.layers[n]==this){s.layers.splice(n,1);break}s.layers.push(t),o(),this.triggerLayerResized(i,e)},i.prototype._syncresponsiveposition=function(){this.onResize(!1)},i.prototype._syncwidth=function(){var t=this.layer.getProperty("width");if(!this.layer.isDimensionPropertyAccepted(t)){if(parseInt(this.layer.getProperty("responsivesize"))){var e=this.fragmentEditor.getResponsiveRatioHorizontal();t*=e}t+="px"}this.$layer.css("width",t)},i.prototype._syncheight=function(){var t=this.layer.getProperty("height");if(!this.layer.isDimensionPropertyAccepted(t)){if(parseInt(this.layer.getProperty("responsivesize"))){var e=this.fragmentEditor.getResponsiveRatioVertical();t*=e}t+="px"}this.$layer.css("height",t)},i.prototype._syncparentalign=function(){var t=this.layer.getProperty("parentalign");this.$layer.data("parentalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},i.prototype._syncparentvalign=function(){var t=this.layer.getProperty("parentvalign");this.$layer.data("parentvalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},i.prototype._syncleft=function(){var t=this.layer.getProperty("left");if(parseInt(this.layer.getProperty("responsiveposition"))){var e=this.fragmentEditor.getResponsiveRatioHorizontal();t*=e}if(this.parent&&this.parentIsVisible){var i=this.parent.position(),n=this.layer.getProperty("align"),s=this.layer.getProperty("parentalign"),o=0;switch(s){case"right":o=i.left+this.parent.width();break;case"center":o=i.left+this.parent.width()/2;break;default:o=i.left}switch(n){case"right":this.$layer.css({left:"auto",right:this.$layer.parent().width()-o-t+"px"});break;case"center":this.$layer.css({left:o+t-this.$layer.width()/2+"px",right:"auto"});break;default:this.$layer.css({left:o+t+"px",right:"auto"})}}else switch(this.layer.getProperty("align")){case"right":this.$layer.css({left:"auto",right:-t+"px"});break;case"center":this.$layer.css({left:this.$layer.parent().width()/2+t-this.$layer.width()/2+"px",right:"auto"});break;default:this.$layer.css({left:t+"px",right:"auto"})}this.triggerLayerResized()},i.prototype._synctop=function(){var t=this.layer.getProperty("top");if(parseInt(this.layer.getProperty("responsiveposition"))){var e=this.fragmentEditor.getResponsiveRatioVertical();t*=e}if(this.parent&&this.parentIsVisible){var i=this.parent.position(),n=this.layer.getProperty("valign"),s=this.layer.getProperty("parentvalign"),o=0;switch(s){case"bottom":o=i.top+this.parent.height();break;case"middle":o=i.top+this.parent.height()/2;break;default:o=i.top}switch(n){case"bottom":this.$layer.css({top:"auto",bottom:this.$layer.parent().height()-o-t+"px"});break;case"middle":this.$layer.css({top:o+t-this.$layer.height()/2+"px",bottom:"auto"});break;default:this.$layer.css({top:o+t+"px",bottom:"auto"})}}else switch(this.layer.getProperty("valign")){case"bottom":this.$layer.css({top:"auto",bottom:-t+"px"});break;case"middle":this.$layer.css({top:this.$layer.parent().height()/2+t-this.$layer.height()/2+"px",bottom:"auto"});break;default:this.$layer.css({top:t+"px",bottom:"auto"})}this.triggerLayerResized()},i.prototype._syncresponsivesize=function(){this.onResize(!1)},i.prototype.historyStoreDoubleProp=function(t,e,i,n){var s=this.layer.getMode();e==s?(this.layer._setProperty(i,t.value,"history"),this.layer._setProperty(n,t.value2,"history")):(this.layer.deviceProperty[e][i]=t.value,this.layer.deviceProperty[e][n]=t.value2,this.layer.$.trigger("propertyChanged",[i,this.layer.getProperty(i)]),this.layer.$.trigger("propertyChanged",[n,this.layer.getProperty(n)]),this.layer.render(i,null,"history"),this.layer.render(n,null,"history"))},i.prototype.setPropertyalign=function(t,e,i){var n=this.layer.getProperty(t),s=this.layer.getRawProperty("left");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var o=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"align","left"]);o&&o.setValues({value:n,value2:s},{value:e,value2:this.layer.getRawProperty("left")})},i.prototype.setPropertyvalign=function(t,e,i){var n=this.layer.getProperty(t),s=this.layer.getRawProperty("top");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var o=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"valign","top"]);o&&o.setValues({value:n,value2:s},{value:e,value2:this.layer.getRawProperty("top")})},i.prototype._syncalign=function(t,e){var i=this.layer.getProperty("align");this.$layer.attr("data-align",i),"history"!==e&&i!=t&&this.setPositionLeft(this.$layer.position().left)},i.prototype._syncvalign=function(t,e){var i=this.layer.getProperty("valign");this.$layer.attr("data-valign",i),"history"!==e&&i!=t&&this.setPositionTop(this.$layer.position().top)},i.prototype.fit=function(){var t=this.$layer.get(0);this.$layer.position();if(t.scrollWidth>0&&t.scrollHeight>0){var e=!1;if(this.layer.item&&(e=this.layer.item.fitLayer()),!e){this.layer.setProperty("width","auto","layer"),this.layer.setProperty("height","auto","layer");var i=this.$layer.width();Math.abs(this.fragmentEditor.mainContainer.layer.width()-this.$layer.position().left-i)<2&&this.layer.setProperty("width",i,"layer")}}},i.prototype.hide=function(t){this.layer.store(t?t:this.layer.getMode(),0,!0)},i.prototype.show=function(t){this.layer.store(t?t:this.layer.getMode(),1,!0)},i.prototype.changeStatus=function(t,e){t==N2Classes.ComponentAbstract.STATUS.LOCKED&&this.layer.nUIResizable("enable"),e==N2Classes.ComponentAbstract.STATUS.LOCKED&&this.$layer.nUIResizable("disable")},i.prototype.getParent=function(){return t("#"+this.layer.getProperty("parentid")).data("layerObject")},i.prototype.subscribeParent=function(){var e=this,i=t("#"+this.layer.property.parentid);this.parent&&!i.is(this.parent)&&(this.parent.off(this.subscribeParentCallbacks),this.parent=!1),this.parent||(this.subscribeParentCallbacks={LayerResized:function(){e.resizeParent.apply(e,arguments)},LayerParent:function(){e.$layer.addClass("n2-ss-layer-parent"),e.$layer.triggerHandler("LayerParent")},LayerUnParent:function(){e.$layer.removeClass("n2-ss-layer-parent"),e.$layer.triggerHandler("LayerUnParent")},LayerDeleted:function(t){e.layer.setProperty("parentid","","layer")},LayerUnavailable:function(t){e.layer.setProperty("parentid","","layer"),e.layer.setProperty("left",0,"layer"),e.layer.setProperty("top",0,"layer")},LayerShowChange:function(t,i,n){e.layer.getMode()==i&&(e.parentIsVisible=n)},"n2-ss-activate":function(){e.$layerRow.addClass("n2-parent-active")},"n2-ss-deactivate":function(){e.$layerRow.removeClass("n2-parent-active")},LayerGetDataWithChildren:function(t,i,n){e.layer.getDataWithChildren(i,n)}},this.parent=i.on(this.subscribeParentCallbacks),this.parent.data("layerObject").placement.current.addChild(this),this.$layer.addClass("n2-ss-layer-has-parent"))},i.prototype.unSubscribeParent=function(t){if(this.$layerRow.removeClass("n2-parent-active"),this.$layer.removeClass("n2-ss-layer-has-parent"),this.parent&&(this.parent.off(this.subscribeParentCallbacks),this.parent=!1,this.subscribeParentCallbacks={},"delete"!=t)){var e=this.$layer.position();this._setPosition(null,null,e.left,e.top,null,null,!0)}},i.prototype.addChild=function(t){this.children.push(t)},i.prototype.removeChild=function(e){this.children.splice(t.inArray(e,this.children),1)},i.prototype.unlink=function(t){t&&t.preventDefault(),this.layer.setProperty("parentid","","layer")},i.prototype.parentPicked=function(t,e,i,n,s){this.layer.setProperty("parentid","","layer"),this.layer.setProperty("align",n,"layer"),this.layer.setProperty("valign",s,"layer"),this.layer.setProperty("parentalign",e,"layer"),this.layer.setProperty("parentvalign",i,"layer"),this.layer.setProperty("parentid",t.requestID(),"layer");var o;for(var r in this.layer.deviceProperty)"desktopPortrait"!=r&&(this.layer.deviceProperty[r].left=o,this.layer.deviceProperty[r].top=o,this.layer.deviceProperty[r].valign=o,this.layer.deviceProperty[r].align=o)},i.prototype._syncparentid=function(){var e=this.layer.getProperty("parentid");if(e&&""!=e)if(0==t("#"+e).length)this.layer.setProperty("parentid","","layer");else{this.$layer.attr("data-parentid",e).addClass("n2-ss-layer-has-parent"),this.subscribeParent();var i=this.$layer.position();this._setPosition(null,null,i.left,i.top,null,null,!0)}else this.$layer.removeAttr("data-parentid"),this.unSubscribeParent()},i.prototype.snap=function(){this.$layer.nextendResizable("option","smartguides",t.proxy(function(){return this.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this))},i.prototype._renderModeProperties=function(t){this.$layer.attr("data-align",this.layer.property.align),this.$layer.attr("data-valign",this.layer.property.valign),t&&this.onResize(!0)},i.prototype.doLinearResize=function(t){this.doThrottledTheResize(t,!0)},i.prototype.doTheResize=function(t,e,i){this.render("width"),this.render("height"),this.render("left"),this.render("top"),e||this.triggerLayerResized(i,t)},i.prototype.resizeParent=function(t,e,i){this.addToResizeCollection(this,e,i)},i.prototype.updatePosition=function(){var t=this.parent;if("center"==this.layer.getProperty("align")){var e=0;e=t?t.position().left+t.width()/2:this.$layer.parent().width()/2;var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("left",e-this.$layer.width()/2+this.layer.getProperty("left")*i)}if("middle"==this.layer.getProperty("valign")){var n=0;n=t?t.position().top+t.height()/2:this.$layer.parent().height()/2;var i=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("top",n-this.$layer.height()/2+this.layer.getProperty("top")*i)}this.triggerLayerResized()},i.prototype.getIndex=function(){var t=parseInt(this.$layer.css("zIndex"));return isNaN(t)&&(t=0),t},i.prototype.renderIndex=function(t){},i.prototype.sync=function(){this._syncalign(null,"history"),this._syncvalign(null,"history"),this._syncwidth(),this._syncheight(),this._synctop(),this._syncleft(),this._syncparentid()},i.prototype["delete"]=function(){var t=this.layer.getProperty("parentid");t&&this.unSubscribeParent("delete")},i.prototype.isParentOrChild=function(){return this.parent||this.children.length>0},i}),N2D("PlacementContent",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="content",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i}),N2D("PlacementDefault",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="default",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.activated=function(t){this.startUISizing()},i.prototype.deActivated=function(t){this.$layer.nUINormalSizing("destroy")},i.prototype.startUISizing=function(){var e=!1;this.layer.item&&this.layer.item.needSize&&(e=!0),this.$layer.nUINormalSizing({start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.layer.setProperty("maxwidth",e.value)},this)})},i}),N2D("PlacementGroup",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="group",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i}),N2D("PlacementNormal",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="normal",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.preActivation=function(t){if("absolute"==t.type&&this.layer.item&&this.layer.item.needSize){var e=this.layer.getProperty("height");e.match&&e.match(/[0-9]+%$/)?this.transferredProperties.height=Math.max(100,parseInt(this.$layer.parent().height()*parseInt(e)/100)):e>0&&(this.transferredProperties.height=e)}},i.prototype.activated=function(e){this.loadProperties(t.extend(e,this.transferredProperties)),this.transferredProperties={},this.layer.$.on("baseSizeUpdated.placementnormal",t.proxy(this._syncmargin,this)),this.layer.$.on("baseSizeUpdated.placementnormal",t.proxy(this._syncheight,this)),this.startUISpacing(),this.startUISizing(),this.$layer.on({mousedown:t.proxy(function(t){t.stopPropagation()})})},i.prototype.loadProperties=function(t){this.layer.createDeviceProperty("margin",{desktopPortrait:"0|*|0|*|0|*|0|*|px+"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||0},this.layer.layer,this),this.layer.createDeviceProperty("maxwidth",{desktopPortrait:0},this.layer.layer,this),this.layer.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},this.layer.layer,this)},i.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.attr("data-has-maxwidth","0").removeAttr("data-cssselfalign").css({position:"",margin:"",height:"",maxWidth:""});for(var i=["margin","height","maxwidth","selfalign"],n={},s=0;s<i.length;s++){var o=i[s].toLowerCase();n[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();n[o]=t.data(a+o),t.removeAttr(a+o),t.removeData(a+o)}}return n},i.prototype.deActivated=function(t){this.layer.$.off(".placementnormal"),this.$layer.nUISpacing("destroy"),this.$layer.nUINormalSizing("destroy"),this.layer.layer.attr("data-has-maxwidth","0"),this.layer.layer.removeAttr("data-cssselfalign");var e=["margin","height","maxwidth","selfalign"],i=this.layer.getPropertiesData(e);return this.layer.removeProperties(e),this.layer.layer.css({position:"",margin:"",height:"",maxWidth:""}),i},i.prototype._renderModeProperties=function(t){this._syncmargin(),this._syncheight(),this._syncmaxwidth(),this._syncselfalign()},i.prototype._syncmargin=function(){var t=this.layer.getProperty("margin").split("|*|"),e=t.pop(),i=this.layer.baseSize;if("px+"==e&&i>0){e="em";for(var n=0;n<t.length;n++)t[n]=parseInt(t[n])/i}var t=t.join(e+" ")+e;this.layer.layer.css("margin",t),this.layer.update(),this.$layer.nUISpacing("option","current",t)},i.prototype.startUISpacing=function(){this.$layer.nUISpacing({mode:"margin",sync:{n:"margin-top",e:"margin-right",s:"margin-bottom",w:"margin-left"},handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var n in e.changed)i+="Margin "+n+": "+e.changed[n]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.onSpacingStop,this)})},i.prototype.onSpacingStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var n=this.layer.getProperty("margin").split("|*|"),s=1,o=1;"px+"==n[n.length-1]&&Math.abs(parseFloat(this.$layer.css("fontSize"))-this.layer.baseSize)>1&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical());for(var r in i.changed){var a=i.changed[r];switch(r){case"top":n[0]=Math.round(a/o);break;case"right":n[1]=Math.round(a/s);break;case"bottom":n[2]=Math.round(a/o);break;case"left":n[3]=Math.round(a/s)}}this.layer.setProperty("margin",n.join("|*|")),t("#layernormal-margin").data("field").insideChange(n.join("|*|"))},i.prototype.startUISizing=function(){var e=!1;this.layer.item&&this.layer.item.needSize&&(e=!0),this.$layer.nUINormalSizing({height:e,syncWidth:!0,start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.layer.setProperty("maxwidth",e.value)},this),resizeHeight:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Height: "+e.value+"px")},this),stopHeight:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing");var i=1;parseInt(this.$layer.css("fontSize"))!=this.layer.baseSize&&(i=this.fragmentEditor.getResponsiveRatioHorizontal());var n=Math.round(n/i);this.layer.setProperty("height",e.value)},this)})},i.prototype._syncheight=function(){var t=parseInt(this.layer.getProperty("height"));if(t>0){var e="px",i=this.layer.baseSize;i>0&&(e="em",t=parseInt(t)/i),this.layer.layer.css("height",t+e)}else this.layer.layer.css("height","");this.layer.update()},i.prototype._syncmaxwidth=function(){var t=parseInt(this.layer.getProperty("maxwidth"));0>=t||isNaN(t)?this.layer.layer.css("maxWidth","").attr("data-has-maxwidth","0"):this.layer.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.layer.update()},i.prototype._syncselfalign=function(){this.layer.layer.attr("data-cssselfalign",this.layer.getProperty("selfalign"))},i.prototype.sync=function(){this._syncmargin(),this._syncheight(),this._syncmaxwidth()},i}),N2D("Placement",function(t,e){"use strict";function i(t){this.layer=t,this.fragmentEditor=t.fragmentEditor,this.modes={},this.current=null,this.isTransferHandled=!1,this.updatePositionThrottled=NextendDeBounce(this.updatePosition,200)}return i.prototype.allow=function(t){switch(t){case"absolute":this.modes.absolute=new N2Classes.PlacementAbsolute(this,this.layer,this.fragmentEditor);break;case"normal":this.modes.normal=new N2Classes.PlacementNormal(this,this.layer,this.fragmentEditor);break;case"group":this.modes.absolute=new N2Classes.PlacementGroup(this,this.layer,this.fragmentEditor);break;case"content":this.modes.absolute=new N2Classes.PlacementContent(this,this.layer,this.fragmentEditor);break;case"default":this.modes["default"]=new N2Classes.PlacementDefault(this,this.layer,this.fragmentEditor)}},i.prototype.start=function(){for(var t in this.modes)this.modes[t].start()},i.prototype.setMode=function(t,e){var i=!1;if(e=e||{},"undefined"==typeof this.modes[t])throw new Exception("Layer placement("+t+") not allowed for the container",this.layer);if(this.current!=this.modes[t]){var n;this.current&&(this.modes[t].preActivation(this.current),n=this.current.type,i=this.current.deActivated(this.modes[t])),this.current=this.modes[t],this.layer.layer.attr("data-pm",this.current.type),this.current.activated(e),this.layer.$.triggerHandler("placementChanged",[this.current.type,n])}return i},i.prototype.doAction=function(t){try{return this.current[t].apply(this.current,Array.prototype.slice.call(arguments,1))}catch(e){}},i.prototype.getType=function(){return this.current.type},i.prototype.onResize=function(t){"function"==typeof this.current.onResize&&this.current.onResize(t)},i.prototype.updatePosition=function(){this.current.updatePosition()},i.prototype.getIndex=function(){return this.current.getIndex()},i.prototype.renderIndex=function(t){return this.current.renderIndex(t)},i.prototype.doLinearResize=function(t){this.current.doLinearResize(t)},i.prototype.sync=function(){
this.current.sync()},i.prototype.renderModeProperties=function(t){var e=this.layer.getProperty("fontsize");this.layer.adjustFontSize(this.layer.getProperty("adaptivefont"),e,!1),this.current._renderModeProperties(t)},i.prototype["delete"]=function(){this.current["delete"]()},i}),N2D("PlacementAbstract",["Placement"],function(t,e){"use strict";function i(t,e,i){this.placement=t,this.layer=e,this.fragmentEditor=i}return i.prototype.start=function(){},i.prototype.preActivation=function(t){},i.prototype.activated=function(){},i.prototype.deActivated=function(t){return!1},i.prototype.updatePosition=function(){this.layer.group.update()},i.prototype._renderModeProperties=function(t){},i.prototype._hide=function(){},i.prototype._show=function(){},i.prototype.snap=function(){return!1},i.prototype.getIndex=function(){return this.layer.layer.index()},i.prototype.renderIndex=function(t){},i.prototype.doLinearResize=function(t){},i.prototype.sync=function(){},i.prototype["delete"]=function(){},i.prototype.triggerLayerResized=function(t,e){},i.prototype.changeStatus=function(t,e){},i}),N2D("CounterItemAdmin",["FrontendItemCounter"],function(t,e){"use strict";function i(){N2Classes.FrontendItemCounter.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FrontendItemCounter.prototype),i.prototype.constructor=i,i.prototype["delete"]=function(){this.$layer.off(".counter"),this.layer.animations.removeExtraAnimation("in","counter")},i.prototype.start=function(){this.$layer.triggerHandler("deleteCounter"),N2R("SSEditor",t.proxy(this.started,this))},i.prototype.started=function(){N2Classes.FrontendItemCounter.prototype.started.apply(this,arguments),this.layer=this.$layer.data("layerObject"),this.$layer.on("deleteCounter.counter",t.proxy(this["delete"],this)),this.setZero(),this.$layer.on("AnimationSetZero.counter",t.proxy(this.setZero,this)),this.layer.readyDeferred.done(t.proxy(function(){this.layer.animations.addExtraAnimation("in","counter",this.delay,{label:"Counter",duration:this.timeline.totalDuration(),changeDelayCallback:t.proxy(this.changeDelay,this),changeDurationCallback:t.proxy(this.changeDuration,this)})},this))},i.prototype.changeDelay=function(e){t("#item_"+this.data.name+"animationdelay").val(1e3*e).trigger("change")},i.prototype.changeDuration=function(e){t("#item_"+this.data.name+"animationduration").val(1e3*e).trigger("change")},i.prototype.setZero=function(t){this.timeline.progress(1)},i}),N2D("HighlightedHeadingItemAdmin",["FrontendItemHighlightedHeading"],function(t,e){"use strict";function i(t,e){N2Classes.FrontendItemHighlightedHeading.prototype.constructor.call(this,t,e)}return i.prototype=Object.create(N2Classes.FrontendItemHighlightedHeading.prototype),i.prototype.constructor=i,i.prototype["delete"]=function(){this.$layer.off(".highlightedHeading"),"1"==this.loop?this.layer.animations.removeExtraAnimation("loop","highlight"):this.layer.animations.removeExtraAnimation("in","highlight")},i.prototype.start=function(){this.$layer.triggerHandler("deleteHeadingHighlight"),N2R("SSEditor",t.proxy(this.started,this))},i.prototype.started=function(){N2Classes.FrontendItemHighlightedHeading.prototype.started.apply(this,arguments),this.layer=this.$layer.data("layerObject"),this.$layer.on("deleteHeadingHighlight.highlightedHeading",t.proxy(this["delete"],this)),this.setZero(),this.$layer.on("AnimationSetZero.highlightedHeading",t.proxy(this.setZero,this)),this.layer.readyDeferred.done(t.proxy(function(){"1"==this.loop?this.layer.animations.addExtraAnimation("loop","highlight",this.delay,{label:"Highlight",duration:this.timeline.totalDuration(),changeDelayCallback:t.proxy(this.changeIn,this)}):this.layer.animations.addExtraAnimation("in","highlight",this.delay,{label:"Highlight",duration:this.timeline.totalDuration(),changeDelayCallback:t.proxy(this.changeIn,this)})},this))},i.prototype.changeIn=function(e){t("#item_highlightedHeadingdelay").val(1e3*e).trigger("change")},i.prototype.setZero=function(){for(var t=0;t<this.$paths.length;t++){var e=Math.round(1.05*(this.$paths[t].getTotalLength()||2e3));NextendTween.set(this.$paths[t],{opacity:1,"stroke-dasharray":e+" "+e})}},i}),N2D("Item",function(t,e){"use strict";function i(i,n,s){this.type===e&&(this.type=i.data("item")),this.needSize=this.constructor.needSize,this.fragmentEditor=s.fragmentEditor,this.generator=this.fragmentEditor.editor.generator,this.self=this,this.$item=i,this.layer=n,this.itemEditor=s,this.fonts=[],this.styles=[],this.needFill=[],this.values=this.$item.data("itemvalues"),"object"!=typeof this.values&&(this.values=t.parseJSON(this.values)),this.pre="div#"+this.fragmentEditor.editor.frontend.elementID+" ",this.defaultValues=s.getItemForm(this.type).values,this.added(),this.$item.data("item",this),this.$item.appendTo(this.layer.getContent()),this.layer.item=this,0===this.$item.children().length&&this.layer.readyDeferred.done(t.proxy(this.reRender,this)),t("<div/>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.$item.find("a").on("click",function(t){t.preventDefault()}),t(window).trigger("ItemCreated")}return i.needSize=!1,i.prototype.setSelf=function(t){this.self!=this&&this.self.setSelf(t),this.self=t},i.prototype.getSelf=function(){return this.self!=this&&(this.self=this.self.getSelf()),this.self},i.prototype.changeValue=function(e,i){this==this.itemEditor.activeItem?t("#item_"+this.type+e).data("field").insideChange(i):this.values[e]=i},i.prototype.activate=function(t,e,i){this.itemEditor.setActiveItem(this,e,i)&&(nextend.basicCSS.activate("ss3item"+this.type,this.values,{font:this.fonts,style:this.styles}),this.itemEditor.lastValues[this.type]=this.values)},i.prototype.deActivate=function(){nextend.basicCSS.deActivate()},i.prototype.render=function(e,i){this.layer.layer.triggerHandler("itemRender"),this.$item.html(""),this.parseAll(e),this._render(e),this.itemEditor.lastValues[this.type]=this.values=i,t("<div/>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item);var n=this.getName(e);n=n===!1||""==n||"Layer"==n?this.type:n.replace(/[<>]/gi,""),this.layer.rename(n,!1),this.layer.update(),this.$item.find("a").on("click",function(t){t.preventDefault()})},i.prototype._render=function(t){},i.prototype.reRender=function(e){this.values=t.extend({},this.getDefault(),this.values,e),this.render(t.extend({},this.values),this.values)},i.prototype["delete"]=function(){this.$item.trigger("mouseleave"),this.$item.remove(),this.itemEditor.activeItem==this&&(this.itemEditor.activeItem=null)},i.prototype.getHTML=function(e){var i="";return i=e?"["+this.type+' values="'+N2Classes.Base64.encode(JSON.stringify(this.values))+'"]':t('<div class="n2-ss-item n2-ss-item-'+this.type+'"></div>').attr("data-item",this.type).attr("data-itemvalues",JSON.stringify(this.values))},i.prototype.getData=function(){return{type:this.type,values:this.values}},i.prototype.getDefault=function(){return{}},i.prototype.added=function(){},i.prototype.addedFont=function(e,i){var n=t("#item_"+this.type+i);n.length&&(this.fonts.push({mode:e,name:i,field:n.data("field"),def:this.defaultValues[i]}),t.when(nextend.fontManager.addVisualUsage(e,this.values[i],this.pre)).done(t.proxy(function(t){t||this.changeValue(i,"")},this)))},i.prototype.addedStyle=function(e,i){var n=t("#item_"+this.type+i);n.length&&(this.styles.push({mode:e,name:i,field:n.data("field"),def:this.defaultValues[i]}),t.when(nextend.styleManager.addVisualUsage(e,this.values[i],this.pre)).done(t.proxy(function(t){t||this.changeValue(i,"")},this)))},i.prototype.parseAll=function(t){for(var e=0;e<this.fonts.length;e++)t[this.fonts[e].name+"class"]=nextend.fontManager.getClass(t[this.fonts[e].name],this.fonts[e].mode)+" ";for(var e=0;e<this.styles.length;e++)t[this.styles[e].name+"class"]=nextend.styleManager.getClass(t[this.styles[e].name],this.styles[e].mode)+" ";for(var e=0;e<this.needFill.length;e++)"undefined"!=typeof t[this.needFill[e]]&&(t[this.needFill[e]]=this.generator.fill(t[this.needFill[e]]+""))},i.prototype.getName=function(t){return"Layer"},i.prototype.resizeLayerToImage=function(e){var i=this.layer,n=t("<img/>").attr("src",e).on("load",t.proxy(function(){var t=n[0].width,e=n[0].height;if(t>0&&e>0){var s=this.fragmentEditor.editor.getMainContainerElement(),o=s.width(),r=s.height();t>o&&(e=e*o/t,t=o),e>r&&(t=t*r/e),N2Classes.History.get().off(),i.setProperty("width",t),i.setProperty("height","auto"),N2Classes.History.get().on()}},this))},i.prototype.fitLayer=function(t){return!1},i}),N2D("ItemManager",function(t,e){"use strict";function i(e,i){if(this.suppressChange=!1,this.activeItemOriginalData=null,this.fragmentEditor=e,this.lastValues={},this.startItems(),this.forms={},this.activeForm=!1,!i.isUploadDisabled){var n=t("#n2-ss-slide-canvas-container-inner");n.nUIFileUpload({url:i.uploadUrl,pasteZone:!1,dropZone:n,dataType:"json",paramName:"image",add:function(t,e){e.formData={path:"/"+i.uploadDir},e.submit()},done:t.proxy(function(t,e){var i=e.result;if(i.data&&i.data.name){var n=this.createLayerItem(!1,{item:"image"});n.reRender({image:i.data.url}),n.activate(null,null,!0)}else N2Classes.AjaxHelper.notification(i)},this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},start:function(){N2Classes.AjaxHelper.startLoading()},stop:function(){setTimeout(function(){N2Classes.AjaxHelper.stopLoading()},100)}})}}return i.prototype.setActiveItem=function(e,i,n){if(e!=this.activeItem||n){this.activeItemOriginalData=null;var s=e.type;this.activeForm&&this.activeForm.form.css("display","none"),this.activeItem&&this.activeItem.deActivate(),this.activeForm=this.getItemForm(s);var o=t.extend({},this.activeForm.values,e.values);this.activeItem=e,this.suppressChange=!0;for(var r in o){var a=t("#item_"+s+r).data("field");a&&a.insideChange(o[r])}return this.suppressChange=!1,this.activeForm.form.css("display","block"),this.focusFirst(i),!0}return!1},i.prototype.focusFirst=function(t){var e=this.activeForm.fields.eq(0).data("field");this.fragmentEditor.editor.generator.isDynamicSlide()&&e.connectedField&&e.connectedField instanceof N2Classes.FormElementImage||e.focus("undefined"!=typeof t&&t)},i.prototype.startItems=function(){t(".n2-ss-core-item").nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,distance:5,$layer:function(){return this.element.clone()},onCreate:t.proxy(function(t,e,i,n){switch(i.layer.type){case"content":case"col":N2Classes.History.get().startBatch();var s=this.createLayerItem(i.layer,e.$layer.data(),"click");N2Classes.History.get().addControl("skipForwardUndos"),i.layer.container.insertLayerAt(s.layer,n),s.layer.changeGroup(!1,i.layer),N2Classes.History.get().endBatch();break;case"row":var o=i.layer.createCol();i.layer.moveCol(o.getIndex(),n),N2Classes.History.get().startBatch();var s=this.createLayerItem(o,e.$layer.data(),"click");N2Classes.History.get().addControl("skipForwardUndos"),o.container.insertLayerAt(s.layer,0),s.layer.changeGroup(!1,o),N2Classes.History.get().endBatch();break;default:var r=this.fragmentEditor.mainContainer.layer.offset(),s=this.createLayerItem(this.fragmentEditor.mainContainer,e.$layer.data(),"click");s.layer.placement.current.setPosition(t.pageX-r.left-20,t.pageY-r.top-20)}},this),start:function(){t("#n2-ss-add-sidebar").removeClass("n2-active")}}).on("click",t.proxy(function(e){this.createLayerItem(this.fragmentEditor.mainContainer.getActiveGroup(),t(e.currentTarget).data(),"click")},this)),t("[data-itemshortcut]").on({click:t.proxy(function(e){e.preventDefault(),t('.n2-ss-core-item[data-item="'+t(e.currentTarget).data("itemshortcut")+'"]').trigger("click")},this),mousedown:t.proxy(function(e){t('.n2-ss-core-item[data-item="'+t(e.currentTarget).data("itemshortcut")+'"]').trigger(e)},this)}),t("[data-structureshortcut]").on({click:t.proxy(function(e){e.preventDefault(),t(".n2-ss-add-layer-button").trigger("click"),t("#n2-ss-layers-switcher > .n2-labels .n2-td").eq(1).trigger("click")},this),mousedown:t.proxy(function(e){t('.n2-ss-core-item[data-sstype="'+t(e.currentTarget).data("structureshortcut")+'"]').trigger(e)},this)})},i.prototype.createLayerItem=function(e,i,n,s){e=e||this.fragmentEditor.mainContainer.getActiveGroup();var o=i.item;if("structure"==o){var r=new N2Classes.Row(this.fragmentEditor,e,{});return r.create(i.sstype),r.hightlightStructure(),{layer:r}}var a=this.getItemForm(o),l=t("<div></div>").attr("data-item",o).data("itemvalues",t.extend(!0,{},a.values,this.getLastValues(o))).addClass("n2-ss-item n2-ss-item-"+o),r=this._createLayer(l,e,t.extend(t(".n2-ss-core-item-"+o).data("layerproperties"),s));return n&&"click"==n?setTimeout(function(){r.layer.trigger("mousedown",["create"]).trigger("mouseup",["create"]).trigger("click",["create"])},500):r.activate(),this.fragmentEditor.layerWindow.switchTab("item"),N2Classes.History.get().addSimple(this,this.historyDelete,this.historyCreate,[e,r,i]),r.item},i.prototype.getLastValues=function(t){return this.lastValues[t]!==e?this.lastValues[t]:{}},i.prototype.getItemClass=function(t){var e="Item"+N2Classes.StringHelper.capitalize(t);return"undefined"==typeof N2Classes[e]?"Item":e},i.prototype._createLayer=function(t,e,i){var n=this.fragmentEditor.layerOptions.layerFeatures.layerDefault;for(var s in n)null!==n[s]&&(i[s]=n[s]);var o=new N2Classes.Layer(this.fragmentEditor,e,i);return o.create(function(e){return e._createLayer().append(t)}),o},i.prototype.getItemForm=function(i){if(this.forms[i]===e){var n=t("#smartslider-slide-toolbox-item-type-"+i),s={form:n,values:n.data("itemvalues"),fields:n.find('[name^="item_'+i+'"]'),fieldNameRegexp:new RegExp("item_"+i+"\\[(.*?)\\]","")};s.fields.on({nextendChange:t.proxy(this.updateCurrentItem,this),keydown:t.proxy(this.updateCurrentItemDeBounced,this)}),this.forms[i]=s}return this.forms[i]},i.prototype.updateCurrentItem=function(e){if(!this.suppressChange){null===this.activeItemOriginalData&&(this.activeItemOriginalData=t.extend({},this.activeItem.values));var i={},n={};if(this.activeForm.fields.each(t.proxy(function(e,s){var s=t(s),o=s.attr("name").match(this.activeForm.fieldNameRegexp)[1];n[o]=i[o]=s.val()},this)),e&&"nextendChange"==e.type){var s=N2Classes.History.get().addValue(this,this.historyUpdateCurrentItem,[this.activeItem]);s&&s.setValues(this.activeItemOriginalData,t.extend({},n)),this.activeItemOriginalData=null}this.activeItem.render(t.extend({},this.activeItem.getDefault(),i),n)}},i.prototype.historyUpdateCurrentItem=function(e,i){var n=i.getSelf();n.reRender(t.extend(!0,{},e)),n.values=e,this.activeItem==n&&n.activate(null,null,!0)},i.prototype.updateCurrentItemDeBounced=NextendDeBounce(function(t){this.updateCurrentItem(t)},100),i.prototype.historyDelete=function(t,e){e.getSelf()["delete"]()},i.prototype.historyCreate=function(t,e,i){var n=this.createLayerItem(t.getSelf(),i);e.setSelf(n.layer)},i.prototype.historyCreateStructure=function(t,e,i){var n=this.createLayerItem(t.getSelf(),i);e.setSelf(n.layer)},i.prototype.getSelf=function(){return this},i}),N2D("HeadingItemSplitTextAdmin",["FrontendItemHeadingSplitText"],function(t,e){"use strict";function i(e,i,n,s,o,r,a,l){if(""!=o)try{o=JSON.parse(N2Classes.Base64.decode(o))}catch(d){o=!1}else o=!1;if(""!=a)try{a=JSON.parse(N2Classes.Base64.decode(a))}catch(d){a=!1}else a=!1;o||t("#"+i).closest(".n2-ss-layer").triggerHandler("layerExtraAnimationRemoved"),(o||a)&&N2Classes.FrontendItemHeadingSplitText.prototype.constructor.call(this,e,i,n,s,o,r,a,l)}return i.prototype=Object.create(N2Classes.FrontendItemHeadingSplitText.prototype),i.prototype.constructor=i,i.prototype["delete"]=function(){this.$layer.off(".splitText"),this.splitTextIn&&this.layer.animations.removeExtraAnimation("in","splitText"),this.splitTextOut&&this.layer.animations.removeExtraAnimation("out","splitText")},i.prototype.start=function(e,i,n,s,o,r){this.$layer.triggerHandler("deleteSplitText"),N2R("SSEditor",t.proxy(this.started,this,e,i,n,s,o,r))},i.prototype.started=function(e,i,n,s,o,r){N2Classes.FrontendItemHeadingSplitText.prototype.started.apply(this,arguments),this.$layer.on("deleteSplitText.splitText",t.proxy(this["delete"],this)),this.setZero(),this.$layer.on("AnimationSetZero.splitText",t.proxy(this.setZero,this)),n&&(this.layer=this.$layer.data("layerObject"),this.layer.readyDeferred.done(t.proxy(function(){this.layer.animations.addExtraAnimation("in","splitText",s,{label:"Split Text In",duration:this.timelineIn?this.timelineIn.totalDuration():0,editCallback:t.proxy(this.editIn,this),changeDelayCallback:t.proxy(this.changeIn,this)})},this))),o&&(this.layer=this.$layer.data("layerObject"),this.layer.readyDeferred.done(t.proxy(function(){this.layer.animations.addExtraAnimation("out","splitText",r,{label:"Split Text Out",duration:this.timelineOut?this.timelineOut.totalDuration():0,editCallback:t.proxy(this.editOut,this),changeDelayCallback:t.proxy(this.changeOut,this)})},this)))},i.prototype.changeIn=function(e){t("#item_headingsplit-text-delay-in").val(1e3*e).trigger("change")},i.prototype.editIn=function(e){t("#item_headingsplit-text-animation-in").parent().find(".n2-form-element-button").trigger("click")},i.prototype.changeOut=function(e){t("#item_headingsplit-text-delay-out").val(1e3*e).trigger("change")},i.prototype.editOut=function(e){t("#item_headingsplit-text-animation-out").parent().find(".n2-form-element-button").trigger("click")},i.prototype.setZero=function(t,e){for(var i=0;i<this.modes.length;i++)NextendTween.set(this.splitText[this.modes[i]],{opacity:1,scale:1,x:0,y:0,rotationX:0,rotationY:0,rotationZ:0})},i}),N2D("PluginActivatable",function(t,e){"use strict";function i(){this.isActive=!1,this.preventActivation=!1}return i.prototype.activate=function(t,e,i){return this.preventActivation?!1:(document.activeElement&&document.activeElement.blur(),t&&(t.ctrlKey||t.metaKey)&&this.fragmentEditor.mainContainer.getSelectedLayer()?!this.select():t&&3==t.which&&this.fragmentEditor.selectMode?!1:(i||this.fragmentEditor.exitSelectMode(),t&&this.positionSidebar(),this.fragmentEditor.mainContainer.getSelectedLayer()!==this&&(this.layerRow.addClass("n2-active"),this.layer.addClass("n2-active"),this.layer.triggerHandler("n2-ss-activate"),this.fragmentEditor.changeActiveLayer(this,i),nextend.activeLayer=this.layer,this.fragmentEditor.ui.onActivateLayer(this)),this.isActive=!0,!0))},i.prototype.deActivate=function(){this.isActive=!1,this.layer===e&&console.error(),this.layer.removeClass("n2-active"),this.layerRow.removeClass("n2-active"),this.layer.triggerHandler("n2-ss-deactivate")},i}),N2D("PluginAnimatable",function(t,e){"use strict";function i(){this.animations=null}return i.prototype.addProperties=function(t){this.createProperty("mouseenter","",t),this.createProperty("click","",t),this.createProperty("mouseleave","",t),this.createProperty("play","",t),this.createProperty("pause","",t),this.createProperty("stop","",t)},i.prototype.updateAnimations=function(){N2Classes.LayerAnimationManager.get().layerWindowEditor.update(this),this.layerRow.toggleClass("n2-ss-layer-has-animations",this.animations.hasAnimation())},i.prototype.createLayerAnimations=function(t,e){var i=[];if(this.animations){new N2Classes.FrontendLayerAnimations(this.layer);var n=new N2Classes.FrontendLayerAnimationManager(this.layer,this.fragmentEditor.editor.frontend.getPerspective());n.setLinear(this,t,e)&&i.push(n)}if(this.container)for(var s=this.container.getSortedLayers(),o=0;o<s.length;o++)i.push.apply(i,s[o].createLayerAnimations(t,e));return i},i}),N2D("PluginEditableName",function(t,e){"use strict";function i(){}var n=300,s=null;return i.prototype.addProperties=function(t){this.createProperty("name",this.label,t),this.createProperty("nameSynced",1,t)},i.prototype.makeNameEditable=function(){this.layerTitleSpan.on({mouseup:t.proxy(function(e){s?(clearTimeout(s),s=null,this.editName()):(this.activate(e),s=setTimeout(t.proxy(function(){s=null},this),n))},this)})},i.prototype.editName=function(){var e=new N2Classes.InlineField;e.$input.on({valueChanged:t.proxy(function(t,e){this.rename(e,!0),this.layerTitleSpan.css("display","inline")},this),cancel:t.proxy(function(){this.layerTitleSpan.css("display","inline")},this)}),this.layerTitleSpan.css("display","none"),e.injectNode(this.layerTitle,this.property.name)},i.prototype.rename=function(t,e){if(this.property.nameSynced||e){if(e&&(this.property.nameSynced=0),""==t){if(e)return this.property.nameSynced=1,this.item.reRender(),!1;t="Layer #"+(this.group.getLayerCount()+1)}t=t.substr(0,35),this.property.name!=t&&(this.property.name=t,this.layerTitleSpan.html(t),this.$.trigger("layerRenamed",t))}},i}),N2D("PluginShowOn",function(t,e){"use strict";function i(){}return i.prototype.addProperties=function(t){this.showsOnCurrent=!0,this.createProperty("generatorvisible","",t),this.createProperty("desktopPortrait",1,t),this.createProperty("desktopLandscape",1,t),this.createProperty("tabletPortrait",1,t),this.createProperty("tabletLandscape",1,t),this.createProperty("mobilePortrait",1,t),this.createProperty("mobileLandscape",1,t)},i.prototype._hide=function(){this.layer.css("display","none"),this.showsOnCurrent=!1,this.update()},i.prototype._show=function(){parseInt(this.property[this.fragmentEditor.getMode()])&&(this.layer.css("display",""),this.showsOnCurrent=!0),this.update()},i.prototype._syncdesktopPortrait=function(){var t=this.getProperty("desktopPortrait");this.__syncShowOnDevice("desktopPortrait",t)},i.prototype._syncdesktopLandscape=function(){var t=this.getProperty("desktopLandscape");this.__syncShowOnDevice("desktopLandscape",t)},i.prototype._synctabletPortrait=function(){var t=this.getProperty("tabletPortrait");this.__syncShowOnDevice("tabletPortrait",t)},i.prototype._synctabletLandscape=function(){var t=this.getProperty("tabletLandscape");this.__syncShowOnDevice("tabletLandscape",t)},i.prototype._syncmobilePortrait=function(){var t=this.getProperty("mobilePortrait");this.__syncShowOnDevice("mobilePortrait",t)},i.prototype._syncmobileLandscape=function(){var t=this.getProperty("mobileLandscape");this.__syncShowOnDevice("mobileLandscape",t)},i.prototype.__syncShowOnDevice=function(t,e){if(this.getMode()==t){var e=parseInt(e);e?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.placement.doAction("triggerLayerResized")}},i}),N2D("Col",["ContentAbstract"],function(t,e){"use strict";function i(t,e,i){this.label="Col",this.type="col",this.innerContainer="> .n2-ss-layer-col",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default")}return i.prototype=Object.create(N2Classes.ContentAbstract.prototype),i.prototype.constructor=i,i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"><div class="n2-ss-layer-content n2-ss-layer-col"></div></div>').attr("data-sstype",this.type)},i.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createProperty("colwidth","1",t),this.createProperty("link","#|*|_self",t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","1|*|1|*|1|*|1",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","none",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":e},this,"stylemode"),t),this.createDeviceProperty("order",{desktopPortrait:0},t)},i.prototype.create=function(){N2Classes.ContentAbstract.prototype.create.call(this),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},i.prototype.load=function(t,i){N2Classes.ContentAbstract.prototype.load.call(this,t,i),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady();var n=t.data("rowcolumns")+"";if(n!=e&&"resolved"==this.group.readyDeferred.state()){for(var s=n.split("+"),o=0;o<s.length;o++)s[o]=new Fraction(s[o]);this.group.setColsWidth(s)}},i.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"normal","> .n2-ss-layer",["row","layer"]),this.container.setLayerContainerElement(this.$content),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner");var e=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));this._createLayerListRow([t('<div class="n2-actions"></div>').append(i).append(e)]).addClass("n2-ss-layer-content-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-col"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype._start=function(t){N2Classes.ContentAbstract.prototype._start.call(this,t),t&&this.highlight(2e3)},i.prototype.getRealOrder=function(){var t=this.getProperty("order");return 0==t?10:t},i.prototype._syncorder=function(){var t=this.getProperty("order");0==t?this.layer.css("order",""):this.layer.css("order",2*t),this.group.refreshUI()},i.prototype._synccolwidth=function(){this.widthPercentage=100*new Fraction(this.getProperty("colwidth")).valueOf(),this.group.refreshUI()},i.prototype.getWidthPercentage=function(){return this.widthPercentage},i.prototype._synclink=function(){},i.prototype._syncborderradius=i.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");t>0&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},i.prototype._syncborderwidth=i.prototype._syncbordercolor=i.prototype._syncborderstyle=i.prototype["_syncborderstyle-hover"]=i.prototype["_syncbordercolor-hover"]=i.prototype["_syncborderwidth-hover"]=function(){this._syncborder()},i.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),i=this.getProperty("bordercolor"),n=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,i,n));var s="",o=!1,r=this.getProperty("borderstyle-hover"),a=this.getProperty("bordercolor-hover"),l=this.getProperty("borderwidth-hover");r!==e&&r!=t&&(o=!0),a!==e&&a!=i&&(o=!0),l!==e&&l!=n&&(o=!0),o&&(r===e&&(r=t),a===e&&(a=i),l===e&&(l=n),s=this.getBorderCSS(r,a,l)),this.addLocalStyle("hover","border",s),this.update()},i.prototype.getBorderCSS=function(t,e,i){var n="";if("none"!=t){n+="border-color:"+N2Color.hex2rgbaCSS(e)+";",n+="border-style:"+t+";",i=i.split("|*|");var s="px";n+="border-width:"+i.join(s+" ")+s+";"}return n},i.prototype._syncboxshadow=i.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var i="",n=this.getProperty("boxshadow-hover");n!==e&&n!=t&&(i=this.getBoxShadowCSS(n.split("|*|"))),this.addLocalStyle("hover","boxshadow",i)},i.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},i.prototype["delete"]=function(){this.group.container.getLayerCount()>1?this._delete():this.group["delete"]()},i.prototype.getHTML=function(t){var e=N2Classes.ComponentAbstract.prototype.getHTML.call(this,t);return e.attr("data-rowcolumns",this.group.getColumns()),e},i.prototype.renderModeProperties=function(t){this._syncorder(),N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t)},i.prototype.update=function(){this.group._syncwrapafter(),N2Classes.ComponentAbstract.prototype.update.call(this)},i.prototype.setPropertystylemode=function(){N2Classes.ContentAbstract.prototype.setPropertystylemode.apply(this,arguments),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},i.prototype.getOrderedIndex=function(){return this.group.getOrderedColumns().indexOf(this)},i});var dependencies=["LayerDataStorage","PluginEditableName"];dependencies.push("PluginAnimatable"),N2D("ComponentAbstract",dependencies,function(t,e){"use strict";function i(e,s,o){this.wraps={},this.counter=n++,window.layers[this.counter]=this,this.self=this,this.originalProperties=o||{},N2Classes.LayerDataStorage.prototype.constructor.call(this),this.readyDeferred=t.Deferred(),this.readyDeferred.done(t.proxy(this.onReady,this)),this.isDeleteStarted=!1,this.isDeleted=!1,this._lastClasses=!1,this.$=t(this),this.proxyRefreshBaseSize=t.proxy(this.refreshBaseSize,this),this.status=i.STATUS.UNDEFINED,this.fragmentEditor=e,this.group=s,this.classElements=[],this.localStyleSyncThrottled=NextendThrottle(this.localStyleSync,50),N2Classes.PluginActivatable.prototype.constructor.call(this),N2Classes.PluginAnimatable.prototype.constructor.call(this),this.placement=new N2Classes.Placement(this),this.readyDeferred.done(t.proxy(this.addUILabels,this))}var n=0;window.layers=[],i.STATUS={UNDEFINED:0,NORMAL:1,LOCKED:2,HIDDEN:3},i.STATUS_INV={0:"UNDEFINED",1:"NORMAL",2:"LOCKED",3:"HIDDEN"};for(var s in N2Classes.PluginActivatable.prototype)i.prototype[s]=N2Classes.PluginActivatable.prototype[s];for(var s in N2Classes.LayerDataStorage.prototype)i.prototype[s]=N2Classes.LayerDataStorage.prototype[s];for(var s in N2Classes.PluginEditableName.prototype)i.prototype[s]=N2Classes.PluginEditableName.prototype[s];for(var s in N2Classes.PluginAnimatable.prototype)i.prototype[s]=N2Classes.PluginAnimatable.prototype[s];for(var s in N2Classes.PluginShowOn.prototype)i.prototype[s]=N2Classes.PluginShowOn.prototype[s];return i.prototype.addUILabels=function(){this.markTimer=null,this.uiLabel=t('<div class="n2-ss-layer-ui-label-container"><div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-self">'+this.getUILabel()+"</div></div>").appendTo(this.layer),nextend.tooltip.addElement(t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-up n2-ss-layer-ui-label-action"><i class="n2-i n2-i-uplevel"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(t){this.up(t)},this)}).appendTo(this.uiLabel),"Select parent"),t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-action"><i class="n2-i n2-i-mini-duplicate"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(){this.duplicate()},this)}).appendTo(this.uiLabel),t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-action"><i class="n2-i n2-i-mini-trash"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(){this["delete"]()},this)}).appendTo(this.uiLabel)},i.prototype.getUILabel=function(){return this.label},i.prototype.up=function(t){t.stopImmediatePropagation(),this.group.activate(t)},i.prototype.addProperties=function(t){this.createProperty("id",null,t,this),this.createProperty("uniqueclass",null,t,this),this.createProperty("class","",t),this.createProperty("crop","visible",t),this.createProperty("rotation",0,t),this.createProperty("parallax",0,t),
this.createProperty("adaptivefont",0,t),this.createDeviceProperty("fontsize",{desktopPortrait:100},t),N2Classes.PluginAnimatable.prototype.addProperties.call(this,t),N2Classes.PluginShowOn.prototype.addProperties.call(this,t),N2Classes.PluginEditableName.prototype.addProperties.call(this,t)},i.prototype.getRootElement=function(){return this.layer},i.prototype.create=function(t,e){e=e||!1,e||this.addProperties(!1),"function"==typeof t?this.layer=t.call(null,this):this.layer=this._createLayer(),this.layer.addClass("n2-ss-layer-under-creation"),e&&this.addProperties(this.layer),this.layer.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.group.container.insert(this),this.group.onChildCountChange(),this.$.triggerHandler("create"),this._start(!0)},i.prototype.load=function(t,e){this.addProperties(t),this.layer=t.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.$.triggerHandler("load"),this._start(!1);var n=t.data("status");null!==n&&"undefined"!=typeof n?this.changeStatus(n):this.changeStatus(i.STATUS.NORMAL),e||this.regenerateUniqueClass()},i.prototype._start=function(e){this.createRow();var i=this.layer.find("> .n2-ss-layer-mask");i.length&&(this.wraps.mask=i),this._synccrop(),this._syncrotation(),this.placement.start(),this.placement.setMode(this.group.container.allowedPlacementMode,this.originalProperties),this.animations=new N2Classes.LayerAnimations(this),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),this.animations.load(),e&&(this.refreshBaseSize(),this.$.triggerHandler("created")),setTimeout(t.proxy(function(){this.isDeleted||(this.placement.onResize(!0),this.layer.css("visibility",""),this.layer.removeClass("n2-ss-layer-under-creation"))},this),300)},i.prototype._onReady=function(){this.originalProperties={},this.readyDeferred.resolve(),this.layer.on({mouseover:t.proxy(this.markOver,this),mouseout:t.proxy(this.markOut,this)})},i.prototype.isReady=function(){return"resolved"==this.readyDeferred.state()},i.prototype.getName=function(){return this.property.name},i.prototype.setGroup=function(t){this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group=t,this.placement.setMode(t.container.allowedPlacementMode),t.container.syncLayerRow(this),this.isReady()&&this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize)},i.prototype.changeGroup=function(t,e){var i=this.group;i.$.off("baseSizeUpdated.sslayer"+this.counter),this.group=e;var n=this.placement.setMode(e.container.allowedPlacementMode);e.container.syncLayerRow(this),this.refreshBaseSize(),e.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.userGroupChange(i,t,n,e,this.getIndex()),i.update()},i.prototype.userGroupChange=function(t,e,i,n,s){if(t==n)this.userIndexChange(e,s);else{var o=N2Classes.History.get().addValue(this,this.historyUserGroupChange,[]);o&&o.setValues({historyGroup:t,index:e,placementData:i},{historyGroup:n,index:s})}},i.prototype.historyUserGroupChange=function(t){var e=this.group,i=t.historyGroup.getSelf(),n=t.index;i.container.insertLayerAt(this,n),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group=i,t.placementData&&this.layer.data(t.placementData),this.placement.setMode(i.container.allowedPlacementMode),i.container.syncLayerRow(this),this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),i.onChildCountChange(),t.placementData&&this.placement.sync(),e.update()},i.prototype.userIndexChange=function(t,e){var i=N2Classes.History.get().addValue(this,this.historyUserIndexChange);i&&i.setValues(t,e),this.group.container.insertLayerAt(this,e)},i.prototype.historyUserIndexChange=function(t){this.group.container.insertLayerAt(this,t)},i.prototype._createLayerListRow=function(e){return this.layerRow=t('<li class="n2-ss-layerlist-row"></li>').data("layer",this).on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerRowClicked")}).appendTo(this.group.container.$ul),this.layerTitleSpan=t('<span class="n2-ucf">'+this.property.name+"</span>"),this.makeNameEditable(),this.layerTitle=t('<div class="n2-ss-layer-title"></div>').on({mouseenter:t.proxy(function(){this.fragmentEditor.highlight(this)},this),mouseleave:t.proxy(function(){this.fragmentEditor.deHighlight(this)},this)}).append(this.layerTitleSpan).append(e).appendTo(this.layerRow).on({mouseup:t.proxy(function(t){nextend.shouldPreventMouseUp||"DIV"!==t.target.tagName||this.activate(t)},this)}),nextend.tooltip.add(this.layerRow),this.layerRow.nUILayerListItem({UIManager:this.fragmentEditor.mainContainer.layerListUIManager,layer:this,$item:this.layerRow}),this.layerRow},i.prototype.select=function(t){return this.fragmentEditor.selectLayer(this,!0)},i.prototype.update=function(){this.readyDeferred.done(t.proxy(this.placement.updatePositionThrottled,this.placement))},i.prototype.updateThrottled=function(){this.placement.updatePositionThrottled()},i.prototype.positionSidebar=function(){this.fragmentEditor.layerWindow.show(this,this.layer)},i.prototype.showEditor=function(){this.fragmentEditor.layerWindow._show()},i.prototype.highlight=function(e){e=e||2e3,this.isHighlighted&&(clearTimeout(this.isHighlighted),this.isHighlighted=!1),this.layer.addClass("n2-highlight"),this.isHighlighted=setTimeout(t.proxy(function(){this.layer.removeClass("n2-highlight")},this),e)},i.prototype.setPropertydesktopPortrait=i.prototype.setPropertydesktopLandscape=i.prototype.setPropertytabletPortrait=i.prototype.setPropertytabletLandscape=i.prototype.setPropertymobilePortrait=i.prototype.setPropertymobileLandscape=function(t,e,i){this._setProperty(t,parseInt(e),i)},i.prototype.getHTML=function(t){var i=this._createLayer();for(var n in this.property)"width"!=n&&"height"!=n&&"left"!=n&&"top"!=n&&i.attr("data-"+n.toLowerCase(),this.property[n]);for(var n in this.deviceProperty)for(var s in this.deviceProperty[n])i.attr("data-"+n.toLowerCase()+s,this.deviceProperty[n][s]);for(var n in this.deviceProperty.desktop)i.css(n,this.deviceProperty.desktop[n]+"px");if(this.container!=e){var o=i;this.innerContainer!=e&&(o=i.find(this.innerContainer)),o.append(this.container.getHTML(t))}var r=this.getProperty("id");return r&&""!=r&&i.attr("id",r),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&i.attr("data-status",this.status),i.attr("data-animations",this.animations.getAnimationsCode()),i},i.prototype.duplicate=function(e){var i=this.getHTML(!1);if("absolute"==this.placement.getType()){var n=i.attr("id");n&&(n=t.fn.uid(),i.attr("id",n),i.attr("data-id",n)),i.attr("data-parentid")?(i.data("desktopportraittop",0),i.data("desktopportraitleft",0)):(i.data("desktopportraittop",i.data("desktopportraittop")+40),i.data("desktopportraitleft",i.data("desktopportraitleft")+40)),i.attr("data-parentid","")}var s=this.fragmentEditor.insertComponentWithNode(this.group,i,this.getIndex()+1,!1,!0);return this.layerRow.trigger("mouseleave"),e&&s.activate(),N2Classes.History.get().addSimple(this,this.historyDeleteDuplicated,this.historyDuplicate,[s,s.container?s.container.getAllLayers():!1]),s},i.prototype.historyDeleteDuplicated=function(t){t.getSelf()["delete"]()},i.prototype.historyDuplicate=function(t,e){var i=this.duplicate(!1,!1);if(t.setSelf(i),e)for(var n=i.container.getAllLayers(),s=0;s<n.length;s++)e[s].setSelf(n[s])},i.prototype.historyDelete=function(){this["delete"]()},i.prototype.historyRestore=function(t,e,i,n){var s=this.fragmentEditor.insertComponentWithNode(this.group.getSelf(),t.clone(),i,!1,!0);if(this.setSelf(s),n)for(var o=s.container.getAllLayers(),r=0;r<o.length;r++)n[r].setSelf(o[r])},i.prototype["delete"]=function(){N2Classes.PositionDisplay.get().hide(),nextend.tooltip.onLeave(),this._delete()},i.prototype._delete=function(){if(this.isDeleteStarted=!0,this.fragmentEditor.mainContainer.getSelectedLayer()==this&&this.fragmentEditor.layerWindow.hide(),this.isHighlighted&&(clearTimeout(this.isHighlighted),this.isHighlighted=!1),N2Classes.History.get().startBatch(),N2Classes.History.get().addSimple(this,this.historyRestore,this.historyDelete,[this.getHTML(!1),this.group,this.getIndex(),this.container?this.container.getAllLayers():!1]),this.deActivate(),this.container!=e){N2Classes.History.get().off();for(var t=this.container.getSortedLayers(),i=0;i<t.length;i++)t[i]._delete();N2Classes.History.get().on()}N2Classes.History.get().endBatch(),this.item!=e&&this.item["delete"](),this.placement["delete"](),this.layer.trigger("mouseup"),this.isDeleted=!0,this.fragmentEditor.mainContainer.layerDeleted(this),this.layer.triggerHandler("LayerDeleted"),this.getRootElement().remove(),this.layerRow.remove(),this.group.update(),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.$.trigger("layerDeleted"),this.markTimer&&clearTimeout(this.markTimer),delete this.layer,delete this.itemEditor,delete this.animation,this.group.onChildCountChange()},i.prototype.getData=function(e){var i={type:this.type,lastplacement:this.placement.getType()};i.animations=this.animations.getData(),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&(i.status=this.status);var n=t.extend({},this.property);for(var s in this.deviceProperty)for(var o in this.deviceProperty[s]){delete n[o];var r=this.deviceProperty[s][o];if("undefined"!=typeof r){switch(o){case"width":case"height":this.isDimensionPropertyAccepted(r)||(r=parseFloat(r));break;case"fontsize":case"left":case"top":case"gutter":case"wrap":r=parseFloat(r)}i[s.toLowerCase()+o]=r}}for(var a in n)i[a.toLowerCase()]=n[a];return i},i.prototype.onChildCountChange=function(){},i.prototype.getDataWithChildren=function(e,i){return-1==t.inArray(this,i)&&(i.push(this),e.push(this.getData({layersIncluded:!0,itemsIncluded:!0})),this.layer.triggerHandler("LayerGetDataWithChildren",[e,i])),e},i.prototype.markOver=function(t){this.layer.addClass("n2-ss-mouse-over"),t.stopPropagation(),this.group.markEnter(),this.markTimer&&clearTimeout(this.markTimer),this.layer.addClass("n2-ss-mouse-over-delayed"),this.uiLabel.removeClass("invisible")},i.prototype.markOut=function(e){this.layer.removeClass("n2-ss-mouse-over"),e&&e.stopPropagation(),this.group.markLeave(),this.markTimer&&clearTimeout(this.markTimer),this.isActive||this.uiLabel.addClass("invisible"),this.markTimer=setTimeout(t.proxy(function(){this.layer.removeClass("n2-ss-mouse-over-delayed"),this.uiLabel.removeClass("invisible"),this.markTimer=null},this),10)},i.prototype.markEnter=function(t){this.layer.addClass("n2-ss-mouse-hover"),this.group.markEnter()},i.prototype.markLeave=function(t){this.layer.removeClass("n2-ss-mouse-hover"),this.group.markLeave()},i.prototype.formSetname=function(t,e){},i.prototype.formSetnameSynced=function(t,e){},i.prototype.formSetdesktopPortrait=function(t,e){t.currentForm.desktopPortrait.data("field").insideChange(e)},i.prototype.formSetdesktopLandscape=function(t,e){t.currentForm.desktopLandscape.data("field").insideChange(e)},i.prototype.formSettabletPortrait=function(t,e){t.currentForm.tabletPortrait.data("field").insideChange(e)},i.prototype.formSettabletLandscape=function(t,e){t.currentForm.tabletLandscape.data("field").insideChange(e)},i.prototype.formSetmobilePortrait=function(t,e){t.currentForm.mobilePortrait.data("field").insideChange(e)},i.prototype.formSetmobileLandscape=function(t,e){t.currentForm.mobileLandscape.data("field").insideChange(e)},i.prototype.sync=function(){if(this._syncid(),this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].sync();this.placement.sync()},i.prototype._syncid=function(){var t=this.getProperty("id");t&&""!=t?this.layer.attr("id",t):this.layer.removeAttr("id")},i.prototype.requestID=function(){var e=this.getProperty("id");return e||(e=t.fn.uid(),this.setProperty("id",e,"layer")),e},i.prototype.requestUniqueClass=function(){var e=this.getProperty("uniqueclass");return e||(e=t.fn.generateUniqueClass("n-uc-"),this.setProperty("uniqueclass",e,"layer")),e},i.prototype.regenerateUniqueClass=function(){this.getProperty("uniqueclass")&&this.setProperty("uniqueclass",t.fn.generateUniqueClass("n-uc-"),"layer")},i.prototype._syncuniqueclass=function(){for(var t=this.getProperty("uniqueclass"),e=0;e<this.classElements.length;e++)this.classElements[e].$el.removeClass(function(t,e){return(e.match(/n-uc-[a-z0-9\-]+/gi)||[]).join(" ")}).addClass(t+this.classElements[e].postfix)},i.prototype._syncfontsize=function(){this.adjustFontSize(this.getProperty("adaptivefont"),this.getProperty("fontsize"),!0)},i.prototype._syncadaptivefont=function(){this.adjustFontSize(this.getProperty("adaptivefont"),this.getProperty("fontsize"),!0)},i.prototype.adjustFontSize=function(t,e,i){e=parseInt(e),parseInt(t)?this.layer.css("font-size",16*e/100+"px"):100!=e?this.layer.css("font-size",e+"%"):this.layer.css("font-size",""),this.refreshBaseSize(),i&&this.update()},i.prototype.refreshBaseSize=function(){var t=this.getFontSize();this.isAdaptiveFont()?this.baseSize=16*t/100:this.baseSize=this.group.baseSize*t/100,this.$.triggerHandler("baseSizeUpdated")},i.prototype.getFontSize=function(){return parseInt(this.getProperty("fontsize"))},i.prototype.isAdaptiveFont=function(){return parseInt(this.getProperty("adaptivefont"))},i.prototype._synccrop=function(){var t=this.getProperty("crop");"auto"==t&&(t="hidden"),"mask"==t?(t="hidden",this.addWrap("mask","<div class='n2-ss-layer-mask'></div>")):(this.removeWrap("mask"),this.layer.data("animatableselector",null)),this.layer.css("overflow",t)},i.prototype._syncrotation=function(){var t=parseFloat(this.getProperty("rotation"));if(t/360!=0){var e=this.addWrap("rotation","<div class='n2-ss-layer-rotation'></div>");NextendTween.set(e[0],{rotationZ:t})}else this.removeWrap("rotation")},i.prototype.addWrap=function(i,n){if(this.wraps[i]===e){var s=t(n);switch(this.wraps[i]=s,i){case"mask":s.appendTo(this.layer),this.wraps.rotation!==e?s.append(this.wraps.rotation):s.append(this.getContents()),this.layer.data("animatableselector",".n2-ss-layer-mask:first");break;case"rotation":this.wraps.mask!==e?s.appendTo(this.wraps.mask):s.appendTo(this.layer),s.append(this.getContents())}}return this.wraps[i]},i.prototype.removeWrap=function(t){if(this.wraps[t]!==e){switch(t){case"mask":this.wraps.rotation!==e?this.layer.append(this.wraps.rotation):this.layer.append(this.getContents());break;case"rotation":this.wraps.mask!==e?this.wraps.mask.append(this.getContents()):this.layer.append(this.getContents())}this.wraps[t].remove(),delete this.wraps[t]}},i.prototype.getContents=function(){return!1},i.prototype._syncclass=function(){this._lastClasses!==!1&&this.layer.removeClass(this._lastClasses);var t=this.fragmentEditor.editor.generator.fill(this.getProperty("class"));t&&""!=t?(this.layer.addClass(t),this._lastClasses=t):this._lastClasses=!1},i.prototype._syncparallax=function(){},i.prototype._syncgeneratorvisible=function(){},i.prototype._syncmouseenter=i.prototype._syncclick=i.prototype._syncmouseleave=i.prototype._syncplay=i.prototype._syncpause=i.prototype._syncstop=function(){},i.prototype.renderModeProperties=function(t){N2Classes.LayerDataStorage.prototype.renderModeProperties.call(this),this.placement.renderModeProperties(t)},i.prototype.getIndex=function(){return this.group.container.getLayerIndex(this.layer)},i.prototype.toString=function(){return this.type+" #"+this.counter},i.prototype.setSelf=function(t){t===e&&console.error(t),this.self!=this&&this.self.setSelf(t),this.self=t},i.prototype.getSelf=function(){return this.self!==this&&(this.self=this.self.getSelf()),this.self},i.prototype.historyStoreOnPlacement=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,1),this.placement.current[arguments[1]].apply(this.placement.current,t)},i.prototype.getDroppable=function(){return!1},i.prototype.onCanvasUpdate=function(t,e,i){if(this.group===e)t!=i&&this.userIndexChange(t,i);else{var n;if(this.fragmentEditor.isCol(this.group))for(n=this;n&&(!n.placement||"absolute"!==n.placement.getType());)n=n.group;this.changeGroup(t,e),e.onChildCountChange();for(var s=this;s&&(!s.placement||"absolute"!==s.placement.getType());)s=s.group;n&&n!=s&&n.placement.updatePosition(),s&&s.placement.updatePosition()}},i.prototype.setStatusNormal=function(){this.changeStatus(i.STATUS.NORMAL)},i.prototype.changeStatus=function(t){var e=this.status;switch(t==this.status&&(t=i.STATUS.NORMAL),this.status){case i.STATUS.HIDDEN:this.getRootElement().removeAttr("data-visibility"),this.layerRow.removeClass("n2-ss-layer-status-hidden");break;case i.STATUS.LOCKED:this.layer.removeClass("n2-ss-layer-locked"),this.layerRow.removeClass("n2-ss-layer-status-locked")}switch(this.status=t,this.status){case i.STATUS.HIDDEN:this.getRootElement().attr("data-visibility","hidden"),this.layerRow.addClass("n2-ss-layer-status-hidden");break;case i.STATUS.LOCKED:this.layer.addClass("n2-ss-layer-locked"),this.layerRow.addClass("n2-ss-layer-status-locked")}this.placement.current.changeStatus(e,this.status)},i.prototype.moveX=function(t){"absolute"==this.placement.getType()&&this.placement.current.moveX(t)},i.prototype.moveY=function(t){"absolute"==this.placement.getType()&&this.placement.current.moveY(t)},i.prototype.localStyleSync=function(){if(this.localStyle!==e){var i=[],n="";this.$localStyle!==e&&(this.$localStyle.remove(),delete this.$localStyle);for(var s=0;s<this.localStyle.length;s++){var o="@rule"+this.localStyle[s].selector,r="";if(i.push(o),1!==Object.keys(this.localStyle[s].css).length||this.localStyle[s].css.transition===e){for(var a in this.localStyle[s].css)r+=this.localStyle[s].css[a];""!=r&&(n+=o+"{"+r+"}")}}var l=this.getProperty("uniqueclass");if(l)for(var s=0;s<i.length;s++)nextend.css.deleteRule(i[s].replace(/@rule/g,window.nextend.pre+"."+l));""!=n&&(l||(l=this.requestUniqueClass()),this.$localStyle=t("<style>"+n.replace(/@rule/g,window.nextend.pre+"."+l)+"</style>").appendTo("head"))}},i.prototype.addLocalStyle=function(t,i,n){for(var s=0;s<this.localStyle.length;s++)if(this.localStyle[s].group===t){""===n?this.localStyle[s].css[i]!==e&&delete this.localStyle[s].css[i]:this.localStyle[s].css[i]=n,this.localStyleSyncThrottled();break}},i.prototype.addClassElement=function(t,e){arguments.length<2&&(e=""),this.classElements.push({$el:t,postfix:e})},i}),N2D("Content",["ContentAbstract"],function(t,e){"use strict";function i(e,i,n){this.label=n2_("Content"),this.type="content",this.innerContainer="> .n2-ss-layer-content",this._defaults=t.extend({verticalalign:"center"},this._defaults),this.localStyle=[{group:"normal",selector:"",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:":HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,e,i,n),this.placement.allow("content"),e.setMainContent(this)}return i.prototype=Object.create(N2Classes.ContentAbstract.prototype),i.prototype.constructor=i,i.prototype.addUILabels=function(){this.markTimer=null,this.uiLabel=t('<div class="n2-ss-layer-ui-label-container"><div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-self">'+this.getUILabel()+"</div></div>").appendTo(this.layer)},i.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},t)},i.prototype.getRootElement=function(){return this.layer},i.prototype.getBackgroundElement=function(){return this.layer},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer n2-ss-content-empty"><div class="n2-ss-section-main-content n2-ss-layer-content"></div></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){this.addClassElement(this.layer),this.$content=this.layer.find(".n2-ss-layer-content:first");var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this));this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"normal","> .n2-ss-layer",["row","layer"]),this.container.setLayerContainerElement(this.$content),t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(i)]).addClass("n2-ss-layer-content-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-col"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype.create=function(){this.originalProperties.adaptivefont=1,N2Classes.ContentAbstract.prototype.create.call(this),this._syncselfalign(),this._onReady()},i.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncselfalign(),this._onReady()},i.prototype._onReady=function(){N2Classes.ContentAbstract.prototype._onReady.call(this),this.startUISizing()},i.prototype.startUISizing=function(){this.layer.nUINormalSizing({start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.setProperty("maxwidth",e.value)},this)})},i.prototype["delete"]=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]["delete"]()},i.prototype.remove=function(){this._delete()},i.prototype.update=function(){this.fragmentEditor.editor.getMainContainerElement().triggerHandler("updateSize")},i.prototype.onChildCountChange=function(){var t=this.container.getSortedLayers();this.layer.toggleClass("n2-ss-content-empty",0==t.length)},i.prototype.renderModeProperties=function(t){N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t),this._syncselfalign()},i.prototype._syncselfalign=function(){this.layer.attr("data-cssselfalign",this.getProperty("selfalign"))},i.prototype.duplicate=function(t){console.error("Content can not be duplicated!")},i}),N2D("ContentAbstract",["LayerContainer","ComponentAbstract"],function(t,e){"use strict";function i(e,i,n){this._defaults=t.extend({verticalalign:"flex-start"},this._defaults),this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.stylemode="",N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,n)}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.addProperties=function(i){this.createProperty("opened",1,i,this),N2Classes.ComponentAbstract.prototype.addProperties.call(this,i),this.createProperty("bgimage","",i),this.createProperty("bgimagex",50,i),this.createProperty("bgimagey",50,i),this.createProperty("bgimageparallax",0,i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":e},this,"stylemode"),i),this.createProperty("verticalalign",this._defaults.verticalalign,i),this.createDeviceProperty("maxwidth",{desktopPortrait:0},i),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},i),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},i),this.$.on("baseSizeUpdated.contentAbstract",t.proxy(this._syncpadding,this))},i.prototype.getBackgroundElement=function(){return this.$content},i.prototype.getPaddingElement=function(){return this.$content},i.prototype.create=function(){N2Classes.ComponentAbstract.prototype.create.call(this),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled(),this.container.startWithExistingNodes(e)},i.prototype.initUI=function(){this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){!nextend.shouldPreventMouseUp&&this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){e.stopPropagation(),t('[data-tab="layer"]').trigger("click")},this)}),this.getPaddingElement().nUISpacing({handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var n in e.changed)i+="Padding "+n+": "+e.changed[n]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.onSpacingStop,this)})},i.prototype.onSpacingStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var n=this.getPadding().split("|*|"),s=1,o=1;"px+"==n[n.length-1]&&Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)>1&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical());for(var r in i.changed){var a=i.changed[r];switch(r){case"top":n[0]=Math.round(a/o);break;case"right":n[1]=Math.round(a/s);break;case"bottom":n[2]=Math.round(a/o);break;case"left":n[3]=Math.round(a/s)}}this.setProperty("padding",n.join("|*|")),t("#layercol-padding").data("field").insideChange(n.join("|*|"))},i.prototype.switchOpened=function(t){t.preventDefault(),this.getProperty("opened")?this.setProperty("opened",0):this.setProperty("opened",1)},i.prototype._syncopened=function(){this.getProperty("opened")?(this.openerElement.removeClass("n2-closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.openerElement.addClass("n2-closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},i.prototype.getPadding=function(){return this.getProperty("padding")},i.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"==e&&i>0){e="em";for(var n=0;n<t.length;n++)t[n]=parseInt(t[n])/i}var s=t.join(e+" ")+e;this.getPaddingElement().css("padding",s),this.update(),this.getPaddingElement().nUISpacing("option","current",s)},i.prototype._syncmaxwidth=function(){var t=parseInt(this.getProperty("maxwidth"));0>=t||isNaN(t)?this.layer.css("maxWidth","").attr("data-has-maxwidth","0"):this.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.update()},i.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},i.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign())},i.prototype.getVerticalAlign=function(){return this.getProperty("verticalalign")},i.prototype._syncverticalalign=function(){this.$content.attr("data-verticalalign",this.getVerticalAlign())},i.prototype._syncbgimage=i.prototype._syncbgimagex=i.prototype._syncbgimagey=i.prototype._syncbgimageparallax=i.prototype._syncbgcolor=i.prototype._syncbgcolorgradient=i.prototype._syncbgcolorgradientend=i.prototype["_syncbgcolor-hover"]=i.prototype["_syncbgcolorgradient-hover"]=i.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},i.prototype._syncbgThrottled=function(){var t="",i=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),n="";if(""!=i){var s=parseInt(this.getProperty("bgimagex"));isFinite(s)||(s=50);var o=parseInt(this.getProperty("bgimagey"));isFinite(o)||(o=50),t+='URL("'+nextend.imageHelper.fixed(i)+'") '+s+"% "+o+"% / cover no-repeat"+(1==this.getProperty("bgimageparallax")?" fixed":""),n=" "+s+"% "+o+"% / cover no-repeat"+(1==this.getProperty("bgimageparallax")?" fixed":"")}var r=this.getProperty("bgcolor"),a=this.getProperty("bgcolorgradient"),l=this.getProperty("bgcolorgradientend"),d=this.getBackgroundCSS(r,a,l,t,n);this.addLocalStyle("normal","bgcolor",d);var h="",p=!1,c=this.getProperty("bgcolor-hover"),u=this.getProperty("bgcolorgradient-hover"),y=this.getProperty("bgcolorgradientend-hover");c!==e&&c!=r&&(p=!0),u!==e&&u!=a&&(p=!0),y!==e&&y!=l&&(p=!0),p&&(c===e&&(c=r),u===e&&(u=a),y===e&&(y=l),h=this.getBackgroundCSS(c,u,y,t,n)),this.addLocalStyle("hover","bgcolor",h)},i.prototype.getBackgroundCSS=function(t,e,i,n,s){if(0!=N2Color.hex2alpha(t)||"off"!=e&&0!=N2Color.hex2alpha(i)){var o="";switch(""!=n&&(o=s+","+n),e){case"horizontal":return"background:-moz-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:-moz-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:-moz-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:-moz-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!=n?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!=n)return"background:"+n+";";return""},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.layersIncluded&&(e.layers=this.container.getData(t)),e},i.prototype.onChildCountChange=function(){this.layer.toggleClass("n2-ss-content-empty",0==this.container.getLayerCount()),this.update()},i.prototype.renderModeProperties=function(t){N2Classes.ComponentAbstract.prototype.renderModeProperties.call(this,t),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign()},i.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!=N2Classes.ComponentAbstract.STATUS.HIDDEN&&this.status!=N2Classes.ComponentAbstract.STATUS.LOCKED?{$container:this.$content,layer:this,placement:"normal",axis:"y"}:"hidden"},i.prototype.getLLDroppable=function(t){switch(t.type){case"layer":case"row":return{$container:this.container.$ul,layer:this}}return!1},i.prototype.getContents=function(){return this.$content},i.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend")},i.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},i}),N2D("Group",["LayerContainer","ComponentAbstract","PluginShowOn"],function(t,e){"use strict";function i(t,e,i){this.label=n2_("Group"),this.type="group",N2Classes.ComponentAbstract.prototype.constructor.call(this,t,e,i),
this.placement.allow("group")}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype._createLayer=function(){return t('<div class="n2-ss-layer-group"></div>').attr("data-sstype",this.type)},i.prototype.addProperties=function(t){this.createProperty("opened",1,t,this),N2Classes.ComponentAbstract.prototype.addProperties.call(this,t)},i.prototype.create=function(){N2Classes.ComponentAbstract.prototype.create.call(this),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.container.startWithExistingNodes(e),this._onReady()},i.prototype.createRow=function(){this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"absolute","> .n2-ss-layer",["row","layer"]);var e=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));this.openerElement=t('<a href="#" class="n2-button n2-button-icon n2-button-m n2-ss-layer-list-group-opener" onclick="return false;"><i class="n2-i n2-i-folderopened"></i></a>').on("click",t.proxy(this.switchOpened,this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(t('<div class="n2-ss-layer-status"></div>').append(this.openerElement)),t('<div class="n2-actions"></div>').append(i).append(e)]).addClass("n2-ss-layer-group-row"),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype.addLayers=function(t){this.container.moveLayersToGroup(t)},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.layers=this.container.getData(t)),e},i.prototype.switchOpened=function(t){t.preventDefault(),this.getProperty("opened")?this.setProperty("opened",0):this.setProperty("opened",1)},i.prototype._syncopened=function(){this.getProperty("opened")?(this.openerElement.removeClass("n2-closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.openerElement.addClass("n2-closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},i.prototype.positionSidebar=function(){this.fragmentEditor.layerWindow.show(this,t("#n2-ss-layer-list"))},i.prototype.activate=function(){N2Classes.PluginActivatable.prototype.activate.call(this,arguments)&&(this.fragmentEditor.startSelection(!0),this.fragmentEditor.addSelection(this.container.getSortedLayers(),!0))},i.prototype.deActivate=function(){this.fragmentEditor.endSelection(!0),N2Classes.PluginActivatable.prototype.deActivate.call(this)},i.prototype.select=function(){this.fragmentEditor.selectLayer(this,!1),this.fragmentEditor.addSelection(this.container.getSortedLayers(),!1)},i.prototype.doAction=function(e,i){for(var n=t.extend([],this.container.layersSorted),s=0;s<n.length;s++)n[s][e].apply(n[s],i)},i.prototype.getLLDroppable=function(t){switch(t.type){case"layer":case"row":return{$container:this.container.$ul,layer:this}}return!1},i}),N2D("Layer",["ComponentAbstract"],function(t,e){"use strict";function i(e,i,n){this.label=n2_("Layer"),this.type="layer",this.parent=!1,this.itemEditor=e.itemEditor,N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,n),this.placement.allow("absolute"),this.placement.allow("normal"),this.$.on("load create",t.proxy(this.startItem,this))}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.create=function(){N2Classes.ComponentAbstract.prototype.create.apply(this,arguments),this.initUI(),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._onReady()},i.prototype.startItem=function(){var t=this.layer.find(".n2-ss-item");new(N2Classes[this.itemEditor.getItemClass(t.data("item"))])(t,this,this.itemEditor),this.layer.nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,layer:this,$layer:this.layer}),this.item.needSize&&this.layer.addClass("n2-ss-layer-needsize")},i.prototype.initUI=function(){this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){N2Classes.WindowManager.get().isPreventDblClick||(e.stopPropagation(),t('[data-tab="item"]').trigger("click"),this.item.itemEditor.focusFirst("dblclick"))},this)})},i.prototype.getContent=function(){var t=this.layer,e=t.data("animatableselector");return e&&(t=t.find(e)),t},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),n=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(n).append(i)]).addClass("n2-ss-layer-layer-row")},i.prototype.activate=function(t,e,i){N2Classes.PluginActivatable.prototype.activate.call(this,t,e,i),this.item?this.item.activate(null,e):console.error("The layer do not have item on it!")},i.prototype.getHTML=function(t){var e=N2Classes.ComponentAbstract.prototype.getHTML.call(this,t),i=this.item.getHTML(t);return e.attr("style",e.attr("style")+this.getStyleText()).append(i),e},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.item=this.item.getData()),e},i.prototype.getStyleText=function(){var t="",e=this.property.crop;return"auto"!=e&&"mask"!=e||(e="hidden"),t+="overflow:"+e+";"},i.prototype.getContents=function(){return this.item.$item},i.prototype.setSelf=function(t){this.self!=this&&this.self.setSelf(t),this.self=t,this.item.setSelf(t.item)},i.prototype.getSelf=function(){return this.self!==this&&(this.self=this.self.getSelf()),this.self},i}),N2D("LayerAdvancedProperty",function(t,e){"use strict";function i(t,e,i,n,s){this.basename=t,this.def=e,this.modesDef=i,this.obj=n,this.propName=s}return i.prototype.getBaseName=function(){return this.basename},i.prototype.getNames=function(){var t={};t[this.basename]=this.def;for(var e in this.modesDef)t[this.basename+e]=this.modesDef[e];return t},i.prototype.getCurrentMode=function(){return this.obj[this.propName]},i.prototype.getName=function(){var t=this.getCurrentMode();return""!==t?this.basename+t:this.basename},i.prototype.getDefault=function(){var t=this.getCurrentMode();return""!==t?this.modesDef[t]:this.def},i.prototype.resetMode=function(t){if(this.propName==t){var e=this.getCurrentMode();if(""!==e){var i=this.obj.property[this.basename+e];this.obj.property[this.basename+e]=this.modesDef[e],this.obj.syncAdvancedField(this.basename),this.obj.render(this.basename+e,i,"manager")}}},i}),N2D("MainContainer",["LayerContainer"],function(t,e){"use strict";function i(e){this.baseSize=16,this.activeLayer=null,this.$=e.$,this.isActiveGroupBlurred=!0,this.isMainGroup=!0,this.fragmentEditor=e,this.layer=e.editor.getMainContainerElement(),this.layer.nUICanvas({mainContainer:this,tolerance:5,smartguides:t.proxy(function(t){return t.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this),display:{hidden:!0,show:t.proxy(function(){N2Classes.PositionDisplay.get().show("Canvas")},this),update:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","L: "+parseInt(0|e.left)+"px<br />T: "+parseInt(0|e.top)+"px")},this),hide:t.proxy(function(){N2Classes.PositionDisplay.get().hide("Canvas")},this)},start:t.proxy(function(t,e){this.fragmentEditor.canvasDragStart(t,e)},this),drag:t.proxy(function(t,e){this.fragmentEditor.canvasDragMove(t,e),e.layer&&e.layer.placement.current.triggerLayerResized()},this),stop:t.proxy(function(t,e){this.fragmentEditor.canvasDragStop(t,e),e.layer&&e.layer.placement.current.triggerLayerResized()},this)}),this.canvasUIManager=this.layer.nUICanvas("instance"),this.layer.nUILayerList({mainContainer:this,$fixed:t("#n2-ss-layers"),$scrolled:t("#n2-ss-layer-list")}),this.layerListUIManager=this.layer.nUILayerList("instance"),this.layer.parent().prepend('<div class="n2-ss-slide-border n2-ss-slide-border-left" /><div class="n2-ss-slide-border n2-ss-slide-border-top" /><div class="n2-ss-slide-border n2-ss-slide-border-right" /><div class="n2-ss-slide-border n2-ss-slide-border-bottom" />'),this.container=new N2Classes.LayerContainer(this,t("#n2-ss-layer-list").find("ul"),"absolute","> .n2-ss-layer, > .n2-ss-layer-group",["content","row","layer","group"]),this.layerRow=this.container.$ul,this.$.on("layerCreated",t.proxy(function(){this.refreshHasLayers()},this))}return i.prototype.lateInit=function(){this.container.startWithExistingNodes(!0),this.layer.parent().on("click",t.proxy(function(){this.fragmentEditor.shouldPreventActivationBubble?this.blurActiveGroup():this.unBlurActiveGroup(),this.fragmentEditor.allowActivation()},this))},i.prototype.onResize=function(t){for(var e=this.getEverySortedLayers(),i=0;i<e.length;i++)e[i].placement.doLinearResize(t)},i.prototype.getEverySortedLayers=function(){for(var t=this.container.getChildLayersRecursive(!1),e={},i=t.length-1;i>=0;i--)"undefined"!=typeof t[i].property.parentid&&t[i].property.parentid&&("undefined"==typeof e[t[i].property.parentid]&&(e[t[i].property.parentid]=[]),e[t[i].property.parentid].push(t[i]),t.splice(i,1));for(var i=0;i<t.length;i++)"undefined"!=typeof t[i].property.id&&t[i].property.id&&"undefined"!=typeof e[t[i].property.id]&&(e[t[i].property.id].unshift(0),e[t[i].property.id].unshift(i+1),t.splice.apply(t,e[t[i].property.id]),delete e[t[i].property.id]);return t},i.prototype.deleteLayers=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]["delete"]()},i.prototype.blurActiveGroup=function(){this.isActiveGroupBlurred=!0},i.prototype.unBlurActiveGroup=function(){this.isActiveGroupBlurred=!1},i.prototype.getActiveGroup=function(){if(this.isActiveGroupBlurred){var t=this,e=this.activeLayer;switch(this.fragmentEditor.isGroup(e)||this.fragmentEditor.isCol(e)||this.fragmentEditor.isContent(e)?t=e:this.fragmentEditor.isRow(e)?t=e.container.getSortedLayers()[0]:e&&(t=e.group),this.fragmentEditor.currentEditorMode){case"content":t==this&&(t=this.fragmentEditor.mainContent);break;case"canvas":t==this.fragmentEditor.mainContent&&(t=this)}return t}switch(this.fragmentEditor.currentEditorMode){case"content":return this.fragmentEditor.mainContent}return this},i.prototype.getSelectedLayer=function(){return null==this.activeLayer?!1:this.activeLayer},i.prototype.getLayerData=function(t){if(t===e)return[];for(var i=[],n=[],s=0;s<t.length;s++)t[s].getDataWithChildren(i,n);return i},i.prototype.layerDeleted=function(t){for(var e=this.fragmentEditor.selectedLayers.length;e--;)t==this.fragmentEditor.selectedLayers[e]&&this.fragmentEditor.selectedLayers.splice(e,1);this._afterLayerDeletedDeBounced(t),this.refreshHasLayers()},i.prototype._afterLayerDeletedDeBounced=NextendDeBounce(function(t){this.activeLayer&&!this.activeLayer.isDeleted||this.fragmentEditor.resetActiveLayer()},50),i.prototype.refreshHasLayers=function(){t("body").toggleClass("n2-ss-has-layers",this.container.getLayerCount()>0),nextend.triggerResize()},i.prototype.getName=function(){return"Slide"},i.prototype.update=function(){},i.prototype.onChildCountChange=function(){},i.prototype.markEnter=function(t){},i.prototype.markLeave=function(t){},i.prototype.getSelf=function(){return this},i.prototype.createLayerAnimations=function(){for(var t=this.fragmentEditor.editor.getHorizontalRatio(),e=this.fragmentEditor.editor.getVerticalRatio(),i=[],n=this.container.getSortedLayers(),s=0;s<n.length;s++)i.push.apply(i,n[s].createLayerAnimations(t,e));return i},i.prototype.getDroppables=function(e){var i,n=this.fragmentEditor.currentEditorMode,s=[];if("canvas"==n){s.push(this.getDroppable()),i=this.container.getSortedLayers();var o=t.inArray(this.fragmentEditor.mainContent,i);o>-1&&i.splice(o,1)}else"content"==n&&(i=[this.fragmentEditor.mainContent]);for(var r=0;r<i.length;r++)if(i[r]!=e){var a=i[r].getDroppable();"object"==typeof a&&s.push(a),"hidden"!=a&&i[r].container&&s.push.apply(s,i[r].container.getDroppables(e))}return s},i.prototype.getLLDroppables=function(t){return this.container.getLLDroppables(t)},i.prototype.getDroppable=function(){return{$container:this.layer,layer:this,placement:"absolute"}},i.prototype.getLLDroppable=function(t){switch(t.type){case"layer":case"row":case"group":case"content":return{$container:this.container.$ul,layer:this}}return!1},i.prototype.replaceLayers=function(e){this._idTranslation={};var i=this.dataToLayers(t.extend(!0,[],e).reverse()),n=[];this.deleteLayers(),this.fragmentEditor.mainContent.remove();for(var s=0;s<i.length;s++)n.push(this.container.append(i[s]));return this.fragmentEditor.refreshMode(),this.container.layerContainerElement.n2imagesLoaded().always(t.proxy(this.fragmentEditor.refreshMode,this.fragmentEditor)),this.getSelectedLayer()||n.length>0&&n[0].activate(),N2Classes.History.get().isEnabled()&&N2Classes.History.get().addSimple(this,this.historyDeleteAll,this.historyReplaceLayers,[e,n,this.container.getAllLayers()]),n},i.prototype.historyDeleteAll=function(t,e){for(var i=0;i<e.length;i++)e[i].getSelf()["delete"]();this.fragmentEditor.mainContent.getSelf().remove()},i.prototype.historyReplaceLayers=function(t,e,i){this.replaceLayers(t);for(var n=this.container.getAllLayers(),s=0;s<i.length;s++)i[s].setSelf(n[s])},i.prototype.addLayers=function(e,i){this._idTranslation={};for(var n=this.dataToLayers(t.extend(!0,[],e)),s=[],o=0;o<n.length;o++)s.push(i.container.append(n[o]));return this.fragmentEditor.refreshMode(),N2Classes.History.get().addSimple(this,this.historyDeleteLayers,this.historyAddLayers,[e,s,i]),s},i.prototype.historyDeleteLayers=function(t,e,i){for(var n=0;n<e.length;n++)e[n].getSelf()["delete"]()},i.prototype.historyAddLayers=function(t,e,i){for(var n=this.addLayers(t,i.getSelf()),s=0;s<e.length;s++)e[s].setSelf(n[s])},i.prototype.dataToLayers=function(t,e){for(var i=[],n=0;n<t.length;n++)switch(t[n].type){case"group":console.error("Group data to layer not implemented!");break;case"row":i.push(this.buildRowNode(t[n],e));break;case"col":i.push(this.buildColNode(t[n],e));break;case"content":i.push(this.buildContentNode(t[n],e));break;case"layer":default:i.push(this.buildLayerNode(t[n],e))}return i},i.prototype._buildNodePrepareID=function(e,i){if(i.id){var n=t.fn.uid(),s=!1;"object"==typeof this._idTranslation[i.id]&&(s=this._idTranslation[i.id]),this._idTranslation[i.id]=n,i.id=n,e.attr("id",n),s&&s.resolve(i.id,n)}if(i.parentid)switch(typeof this._idTranslation[i.parentid]){case"string":i.parentid=this._idTranslation[i.parentid];break;case"undefined":this._idTranslation[i.parentid]=t.Deferred();case"object":this._idTranslation[i.parentid].done(t.proxy(function(t,e,i){t.data("parentid",i)},this,e));break;default:i.parentid=""}},i.prototype._buildNodeAnimations=function(t){"object"==typeof t.animations&&(t.animations=N2Classes.Base64.encode(JSON.stringify(t.animations)))},i.prototype.buildContentNode=function(i,n){var s=t("<div class='n2-ss-layer' data-sstype='content'/>"),o=t("<div class='n2-ss-section-main-content n2-ss-layer-content' />").appendTo(s);this._buildNodeAnimations(i);for(var r in i)s.data(r,i[r]);return n!==e&&s.appendTo(n),this.dataToLayers(i.layers,o),s},i.prototype.buildRowNode=function(i,n){var s=t("<div class='n2-ss-layer' data-sstype='row'/>"),o=t("<div class='n2-ss-layer-row' />").appendTo(s);this._buildNodePrepareID(s,i),this._buildNodeAnimations(i);for(var r in i)s.data(r,i[r]);return n!==e&&s.appendTo(n),this.dataToLayers(i.cols,o),s},i.prototype.buildColNode=function(i,n){var s=t("<div class='n2-ss-layer' data-sstype='col'/>"),o=t("<div class='n2-ss-layer-col n2-ss-layer-content' />").appendTo(s);this._buildNodeAnimations(i);for(var r in i)s.data(r,i[r]);return n!==e&&s.appendTo(n),this.dataToLayers(i.layers,o),s},i.prototype.buildLayerNode=function(i,n){var s=t("<div class='n2-ss-layer' data-sstype='layer'></div>").attr("style",i.style),o=1;i.zIndex&&(o=i.zIndex),this._buildNodePrepareID(s,i),i.items!==e&&(i.item=i.items[0],delete i.items),t('<div class="n2-ss-item n2-ss-item-'+i.item.type+'"></div>').data("item",i.item.type).data("itemvalues",i.item.values).appendTo(s),delete i.style,delete i.item,this._buildNodeAnimations(i);for(var r in i)s.data(r,i[r]);return n!==e&&s.appendTo(n),s},i}),N2D("Row",["LayerContainer","ComponentAbstract"],function(t,e){"use strict";function i(e,i,n){this.label=n2_("Row"),this.type="row",this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.innerContainer="> .n2-ss-layer-row > .n2-ss-layer-row-inner",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],this.columnsField=t("#layerrow-columns").data("field"),this.refreshUI=NextendDeBounce(this.refreshUI,100),this.stylemode="",N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,n),this.placement.allow("absolute"),this.placement.allow("normal")}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.addProperties=function(i){this.createProperty("opened",1,i,this),N2Classes.ComponentAbstract.prototype.addProperties.call(this,i),this.createProperty("link","#|*|_self",i),this.createProperty("bgimage","",i),this.createProperty("bgimagex",50,i),this.createProperty("bgimagey",50,i),this.createProperty("bgimageparallax",0,i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":e},this,"stylemode"),i),this.createProperty("fullwidth",1,i),this.createProperty("stretch",0,i),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},i),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},i),this.createDeviceProperty("gutter",{desktopPortrait:20},i),this.createDeviceProperty("wrapafter",{desktopPortrait:0,mobilePortrait:1,mobileLandscape:1},i),this.$.on("baseSizeUpdated.row",t.proxy(this._syncpadding,this))},i.prototype.historyDeleteSelf=function(){this["delete"]()},i.prototype.historyCreateSelf=function(t,e,i){var n=new N2Classes.Row(this.fragmentEditor,t.getSelf(),{});n.create(e),this.setSelf(n);for(var s=n.container.getSortedLayers(),o=0;o<s.length;o++)i[o].setSelf(s[o])},i.prototype.create=function(e){var i,n=function(e){return t("<div class='n2-ss-layer' />").append(t("<div class='n2-ss-layer-row' />").append(t("<div class='n2-ss-layer-row-inner' />").append(e))).attr("data-sstype","row")},s=function(e){return t("<div class='n2-ss-layer' data-sstype='col'/>").append(t("<div class='n2-ss-layer-col n2-ss-layer-content' />").append(e))};switch(e){case"2col":i=function(t){return n([s(),s()])};break;case"2col-60-40":i=function(t){return n([s().data("colwidth","6/10"),s().data("colwidth","4/10")])};break;case"2col-40-60":i=function(t){return n([s().data("colwidth","4/10"),s().data("colwidth","6/10")])};break;case"2col-80-20":i=function(t){return n([s().data("colwidth","8/10"),s().data("colwidth","2/10")])};break;case"2col-20-80":i=function(t){return n([s().data("colwidth","2/10"),s().data("colwidth","8/10")])};break;case"3col":i=function(t){return n([s(),s(),s()])};break;case"3col-20-60-20":i=function(t){return n([s().data("colwidth","2/10"),s().data("colwidth","6/10"),s().data("colwidth","2/10")])};break;case"4col":i=function(t){return n([s(),s(),s(),s()])};break;case"special":i=function(t){var e=n([s(),s()]);return n([s().data("colwidth","1/5"),s(e).data("colwidth","4/5")])};break;default:i=function(t){return n([s()])}}"absolute"===this.group.container.allowedPlacementMode&&(this.originalProperties=t.extend({width:"100%",align:"center",valign:"top",top:20},this.originalProperties)),N2Classes.ComponentAbstract.prototype.create.call(this,i,!0),this.initUI(),this.container.startWithExistingNodes(!1),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborderradius(),this._syncboxshadow(),this.renderModeProperties(),this.container.renderModeProperties(),N2Classes.History.get().addSimple(this,this.historyDeleteSelf,this.historyCreateSelf,[this.group,e,this.container.getSortedLayers()]),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this.container.startWithExistingNodes(e),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},i.prototype.initUI=function(){this.layer.nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,layer:this,$layer:this.layer}),this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){!nextend.shouldPreventMouseUp&&this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){e.stopPropagation(),t('[data-tab="row"]').trigger("click")},this)}),this.$row.nUISpacing({handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var n in e.changed)i+="Padding "+n+": "+e.changed[n]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.____makeLayerResizeableStop,this)}),this.$row.nUIColumns({columns:"1",gutter:this.getGutter(),start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Columns")},this),colwidth:t.proxy(function(t,e){this.updateColumnWidth(e.currentPercent),N2Classes.PositionDisplay.get().update(t,"Columns",Math.round(100*e.currentPercent[e.index])+"% &mdash; "+Math.round(100*e.currentPercent[e.index+1])+"%")},this),stop:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("Columns"),this.setRealColsWidth(e.currentFractions)},this)});var e={};this.$rowInner.nUISortableRow({distance:10,helper:"clone_hide",forceHelperSize:!0,forcePlaceholderSize:!0,items:"> .n2-ss-layer",handle:" > .n2-ss-layer-ui-label-container > .n2-ss-layer-ui-label-self",start:t.proxy(function(t,i){e.originalPrevLayer=i.item.prevAll(".n2-ss-layer").not(i.placeholder).first().data("layerObject");var n=this.getColumns().split("+");i.placeholder.css({width:100*new Fraction(n[i.item.data("layerObject").getIndex()]).valueOf()+"%",visibility:"visible",margin:this.getGutter()+"px"}),i.helper.hasClass("n2-ss-last-in-row")&&i.placeholder.addClass("n2-ss-last-in-row"),i.placeholder.css("order",i.helper.css("order")),i.placeholder.attr("data-r",i.helper.attr("data-r"))},this),beforestop:t.proxy(function(t,i){i.placeholder.detach(),e.layer=i.item.data("layerObject"),e.oldIndex=e.layer.getOrderedIndex()},this),stop:t.proxy(function(t,i){var n=e.layer,s=e.oldIndex,o=0;switch(e.originalPrevLayer?n.layer.insertAfter(e.originalPrevLayer.layer):n.layer.prependTo(n.group.container.layerContainerElement),i.lastPosition[1]){case"before":o=i.lastPosition[0].data("layerObject").getOrderedIndex(),o>s&&o--;break;case"after":o=i.lastPosition[0].data("layerObject").getOrderedIndex(),s>o&&o++}s!==o&&this.moveCol(s,o)},this)})},i.prototype.____makeLayerResizeableStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var n=this.getPadding().split("|*|"),s=1,o=1;"px+"==n[n.length-1]&&Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)>1&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical());for(var r in i.changed){var a=i.changed[r];switch(r){case"top":n[0]=Math.round(a/o);break;case"right":n[1]=Math.round(a/s);break;case"bottom":n[2]=Math.round(a/o);break;case"left":n[3]=Math.round(a/s)}}this.setProperty("padding",n.join("|*|")),t("#layerrow-padding").data("field").insideChange(n.join("|*|"))},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"><div class="n2-ss-layer-row"><div class="n2-ss-layer-row-inner"></div></div></div>').attr("data-sstype",this.type)},i.prototype.historyDeleteCol=function(t,e){e.getSelf()["delete"]()},i.prototype.historyCreateCol=function(t,e){var i=t.getSelf().createCol();e.setSelf(i)},i.prototype.createCol=function(){var t=new N2Classes.Col(this.fragmentEditor,this,{});return N2Classes.History.get().addSimple(this,this.historyDeleteCol,this.historyCreateCol,[this,t]),t.create(),this.isReady()&&this.placement.updatePosition(),t},i.prototype.createRow=function(){this.$row=this.layer.find(".n2-ss-layer-row:first"),this.$rowInner=this.$row.find(".n2-ss-layer-row-inner:first"),0===this.$rowInner.length&&(this.$rowInner=t('<div class="n2-ss-layer-row-inner"></div>').append(this.$row.find("> *")).appendTo(this.$row)),this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"default"," > .n2-ss-layer",["col"]),this.container.setLayerContainerElement(this.$rowInner),this.addClassElement(this.layer),this.addClassElement(this.$row,"-inner");var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),n=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(n).append(i)]).addClass("n2-ss-layer-row-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-row"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype.activate=function(){N2Classes.PluginActivatable.prototype.activate.apply(this,arguments),this.columnsField.setRow(this)},i.prototype.switchOpened=function(t){t.preventDefault(),this.getProperty("opened")?this.setProperty("opened",0):this.setProperty("opened",1)},i.prototype._syncopened=function(){this.getProperty("opened")?(this.openerElement.removeClass("n2-closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.openerElement.addClass("n2-closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},i.prototype.getColumns=function(){for(var t=this.container.getSortedLayers(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},i.prototype.getColumnsOrdered=function(){for(var t=this.getOrderedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},i.prototype._synccolumns=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]._synccolwidth();this.update()},i.prototype.getPadding=function(){return this.getProperty("padding")},i.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"==e&&i>0){e="em";for(var n=0;n<t.length;n++)t[n]=parseInt(t[n])/i}var s=t.join(e+" ")+e;this.$row.css("padding",s),this.$row.nUISpacing("option","current",s),this.update()},i.prototype.getGutter=function(){return this.getProperty("gutter")},i.prototype._syncgutter=function(){var t=this.getGutter(),e=t/2,i=this.container.getSortedLayers();if(i.length>0)for(var n=i.length-1;n>=0;n--)i[n].layer.css("margin",e+"px");this.$rowInner.css({width:"calc(100% + "+(t+1)+"px)",margin:-e+"px"}),this.$row.nUIColumns("option","gutter",this.getGutter()),this._syncwrapafter(),this.update()},i.prototype._syncwrapafter=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t,e=parseInt(this.getProperty("wrapafter")),i=this.getOrderedColumns(),n=!1;for(t=i.length-1;t>=0;t--)i[t].showsOnCurrent||i.splice(t,1);var s=i.length;if(e>0&&s>e&&(n=!0),this.$row.attr("row-wrapped",n?1:0),n){var o=[];for(t=0;s>t;t++){var r=Math.floor(t/e);"undefined"==typeof o[r]&&(o[r]=[]),o[r].push(i[t]),i[t].layer.attr("data-r",r).toggleClass("n2-ss-last-in-row",(t+1)%e===0||t===s-1)}var a=this.getGutter();for(t=0;t<o.length;t++){var l,d=o[t],h=0;for(l=0;l<d.length;l++)h+=d[l].getWidthPercentage();for(l=0;l<d.length;l++)d[l].layer.css("width","calc("+d[l].getWidthPercentage()/h*100+"% - "+a+"px)")}}else{var h=0;for(t=0;s>t;t++)h+=i[t].getWidthPercentage();for(t=0;s>t;t++)i[t].layer.css("width",i[t].getWidthPercentage()/h*100+"%").removeClass("n2-ss-last-in-row").attr("data-r",0);s>0&&i[s-1].layer.addClass("n2-ss-last-in-row")}this.update()}},i.prototype.getOrderedColumns=function(){return this.container.getSortedLayers().sort(function(t,e){return t.getRealOrder()-e.getRealOrder()})},i.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},i.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign())},i.prototype._syncfullwidth=function(){this.layer.attr("data-frontend-fullwidth",0==this.getProperty("fullwidth")?"0":"1")},i.prototype._syncstretch=function(){this.layer.toggleClass("n2-ss-stretch-layer",1==this.getProperty("stretch"))},i.prototype._syncborderradius=i.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");t>0&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},i.prototype._syncboxshadow=i.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var i="",n=this.getProperty("boxshadow-hover");n!==e&&n!=t&&(i=this.getBoxShadowCSS(n.split("|*|"))),this.addLocalStyle("hover","boxshadow",i)},i.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";";
},i.prototype._synclink=function(){},i.prototype._syncbgimage=i.prototype._syncbgimagex=i.prototype._syncbgimagey=i.prototype._syncbgimageparallax=i.prototype._syncbgcolor=i.prototype._syncbgcolorgradient=i.prototype._syncbgcolorgradientend=i.prototype["_syncbgcolor-hover"]=i.prototype["_syncbgcolorgradient-hover"]=i.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},i.prototype._syncbgThrottled=function(){var t="",i=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),n="";if(""!=i){var s=parseInt(this.getProperty("bgimagex"));isFinite(s)||(s=50);var o=parseInt(this.getProperty("bgimagey"));isFinite(o)||(o=50),t+='URL("'+nextend.imageHelper.fixed(i)+'") '+s+"% "+o+"% / cover no-repeat"+(1==this.getProperty("bgimageparallax")?" fixed":""),n=" "+s+"% "+o+"% / cover no-repeat"+(1==this.getProperty("bgimageparallax")?" fixed":"")}var r=this.getProperty("bgcolor"),a=this.getProperty("bgcolorgradient"),l=this.getProperty("bgcolorgradientend"),d=this.getBackgroundCSS(r,a,l,t,n);this.addLocalStyle("normal","bgcolor",d);var h="",p=!1,c=this.getProperty("bgcolor-hover"),u=this.getProperty("bgcolorgradient-hover"),y=this.getProperty("bgcolorgradientend-hover");c!==e&&c!=r&&(p=!0),u!==e&&u!=a&&(p=!0),y!==e&&y!=l&&(p=!0),p&&(c===e&&(c=r),u===e&&(u=a),y===e&&(y=l),h=this.getBackgroundCSS(c,u,y,t,n)),this.addLocalStyle("hover","bgcolor",h)},i.prototype.getBackgroundCSS=function(t,e,i,n,s){if(0!=N2Color.hex2alpha(t)||"off"!=e&&0!=N2Color.hex2alpha(i)){var o="";switch(""!=n&&(o=s+","+n),e){case"horizontal":return"background:-moz-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(left, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:-moz-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(top, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:-moz-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:-moz-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:-webkit-linear-gradient(-45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!=n?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!=n)return"background:"+n+";";return""},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.cols=this.container.getData(t)),e},i.prototype.moveCol=function(t,e){if("desktopPortrait"==this.getMode()){this._moveCol(t,e);var i=N2Classes.History.get().addValue(this,this.historyMoveCol,[]);i&&i.setValues({oldIndex:e,newIndex:t},{oldIndex:t,newIndex:e})}else{var n=this.getOrderedColumns(),s=n[t];n.splice(t,1),n.splice(e,0,s);for(var o=0;o<n.length;o++)n[o].setProperty("order",o+1);this.refreshUI()}},i.prototype._moveCol=function(t,e){var i=this.container.getSortedLayers();this.container.insertLayerAt(i[t],e),this.refreshUI()},i.prototype.historyMoveCol=function(t){this._moveCol(t.oldIndex,t.newIndex)},i.prototype.setColsWidth=function(t){for(var e=this.container.getSortedLayers(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},i.prototype.setRealColsWidth=function(t){for(var e=this.getOrderedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},i.prototype.updateColumnWidth=function(t){var e,i=parseInt(this.getProperty("wrapafter")),n=this.getOrderedColumns();for(e=n.length-1;e>=0;e--)n[e].showsOnCurrent||(n.splice(e,1),t.splice(e,1));var s=n.length;if(i>0&&s>i){var o=[];for(e=0;s>e;e++){var r=Math.floor(e/i);"undefined"==typeof o[r]&&(o[r]=[]),n[e]._tempWidth=t[e],o[r].push(n[e])}var a=this.getGutter();for(e=0;e<o.length;e++){var l,d=o[e],h=0;for(l=0;l<d.length;l++)h+=d[l]._tempWidth;for(l=0;l<d.length;l++)d[l].layer.css("width","calc("+d[l]._tempWidth/h*100+"% - "+a+"px)")}}else for(e=0;s>e;e++)n[e].layer.css("width",100*t[e]+"%");this.update()},i.prototype.activateColumn=function(t,e){this.container.getSortedLayers()[t].activate(e)},i.prototype.onChildCountChange=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=this.container.getSortedLayers(),e=t.length;if(e){for(var i=this.getColumns().split("+"),n=0,s=0;s<i.length;s++)n=new Fraction(i[s]).add(n);if(1!=n.valueOf())for(var s=0;e>s;s++)t[s].setProperty("colwidth","1/"+e);else for(var s=0;e>s;s++)t[s]._synccolwidth();this.refreshUI()}this._syncgutter()}},i.prototype.renderModeProperties=function(t){N2Classes.ComponentAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding(),this._syncinneralign(),this._syncgutter(),this.isActive&&this.columnsField.setRow(this)},i.prototype.hightlightStructure=function(e){e=e||4e3,this.isStructureHighlighted&&(clearTimeout(this.isStructureHighlighted),this.isStructureHighlighted=!1),this.layer.addClass("n2-highlight-structure"),this.isStructureHighlighted=setTimeout(t.proxy(function(){this.isDeleted||this.layer.removeClass("n2-highlight-structure")},this),e)},i.prototype.refreshUI=function(){this.isDeleteStarted||(this.isActive&&this.columnsField.setRow(this),this._syncwrapafter(),this.$row.nUIColumns("option","columns",this.getColumnsOrdered()))},i.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!=N2Classes.ComponentAbstract.STATUS.HIDDEN&&this.status!=N2Classes.ComponentAbstract.STATUS.LOCKED?{$container:this.$row,layer:this,placement:"normal",axis:"x"}:"hidden"},i.prototype.getLLDroppable=function(t){switch(t.type){case"col":if(t.group==this)return{$container:this.container.$ul,layer:this}}return!1},i.prototype.getContents=function(){return this.$row},i.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend"),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow")},i.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},i}),N2D("ComponentSettings",function(t,e){"use strict";function i(e){this.componentType="undefined",this.placementType="undefined",t("html").attr("data-component","").attr("data-placement",""),this.currentForm={},this.forms={undefined:null,placement:{absolute:{},normal:{},"default":{}},component:{content:{},layer:{},row:{},col:{},group:{}},global:{id:t("#layerid"),uniqueclass:t("#layeruniqueclass"),desktopPortrait:t("#layershow-desktop-portrait"),desktopLandscape:t("#layershow-desktop-landscape"),tabletPortrait:t("#layershow-tablet-portrait"),tabletLandscape:t("#layershow-tablet-landscape"),mobilePortrait:t("#layershow-mobile-portrait"),mobileLandscape:t("#layershow-mobile-landscape"),"class":t("#layerclass"),generatorvisible:t("#layergenerator-visible"),crop:t("#layercrop"),rotation:t("#layerrotation"),parallax:t("#layerparallax"),fontsize:t("#layerfont-size"),adaptivefont:t("#layeradaptive-font"),mouseenter:t("#layeronmouseenter"),click:t("#layeronclick"),mouseleave:t("#layeronmouseleave"),play:t("#layeronplay"),pause:t("#layeronpause"),stop:t("#layeronstop")}},e.editor.generator.registerField(this.forms.global["class"]),this.fragmentEditor=e;var i=e.editor.getAvailableDeviceModes();i.desktopLandscape||this.forms.global.desktopLandscape.closest(".n2-mixed-group").css("display","none"),i.tabletPortrait||this.forms.global.tabletPortrait.closest(".n2-mixed-group").css("display","none"),i.tabletLandscape||this.forms.global.tabletLandscape.closest(".n2-mixed-group").css("display","none"),i.mobilePortrait||this.forms.global.mobilePortrait.closest(".n2-mixed-group").css("display","none"),i.mobileLandscape||this.forms.global.mobileLandscape.closest(".n2-mixed-group").css("display","none"),this.forms.placement.absolute={parentid:t("#layerparentid"),parentalign:t("#layerparentalign"),parentvalign:t("#layerparentvalign"),left:t("#layerleft"),top:t("#layertop"),responsiveposition:t("#layerresponsive-position"),width:t("#layerwidth"),height:t("#layerheight"),responsivesize:t("#layerresponsive-size"),align:t("#layeralign"),valign:t("#layervalign")},this.forms.placement.normal={margin:t("#layernormal-margin"),height:t("#layernormal-height"),maxwidth:t("#layernormal-maxwidth"),selfalign:t("#layernormal-selfalign")},this.forms.component.content={maxwidth:t("#layercontent-maxwidth"),selfalign:t("#layercontent-selfalign"),padding:t("#layercontent-padding"),inneralign:t("#layercontent-inneralign"),verticalalign:t("#layercontent-verticalalign"),stylemode:t("#layercontent-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layercontent-background-color"),bgimage:t("#layercontent-background-image"),bgimagex:t("#layercontent-background-focus-x"),bgimagey:t("#layercontent-background-focus-y"),bgimageparallax:t("#layercontent-background-parallax"),bgcolorgradient:t("#layercontent-background-gradient"),bgcolorgradientend:t("#layercontent-background-color-end"),opened:t("#layercontent-opened")},e.editor.generator.registerField(this.forms.component.content.bgimage),this.forms.component.row={padding:t("#layerrow-padding"),gutter:t("#layerrow-gutter"),fullwidth:t("#layerrow-fullwidth"),stretch:t("#layerrow-stretch"),wrapafter:t("#layerrow-wrap-after"),inneralign:t("#layerrow-inneralign"),link:t("#layerrow-link"),bgimage:t("#layerrow-background-image"),bgimagex:t("#layerrow-background-focus-x"),bgimagey:t("#layerrow-background-focus-y"),bgimageparallax:t("#layerrow-background-parallax"),stylemode:t("#layerrow-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layerrow-background-color"),bgcolorgradient:t("#layerrow-background-gradient"),bgcolorgradientend:t("#layerrow-background-color-end"),borderradius:t("#layerrow-border-radius"),boxshadow:t("#layerrow-boxshadow"),opened:t("#layerrow-opened")},e.editor.generator.registerField(this.forms.component.row.bgimage),this.forms.component.col={maxwidth:t("#layercol-maxwidth"),padding:t("#layercol-padding"),inneralign:t("#layercol-inneralign"),verticalalign:t("#layercol-verticalalign"),link:t("#layercol-link"),bgimage:t("#layercol-background-image"),bgimagex:t("#layercol-background-focus-x"),bgimagey:t("#layercol-background-focus-y"),bgimageparallax:t("#layercol-background-parallax"),stylemode:t("#layercol-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layercol-background-color"),bgcolorgradient:t("#layercol-background-gradient"),bgcolorgradientend:t("#layercol-background-color-end"),borderradius:t("#layercol-border-radius"),boxshadow:t("#layercol-boxshadow"),borderwidth:t("#layercol-border-width"),borderstyle:t("#layercol-border-style"),bordercolor:t("#layercol-border-color"),opened:t("#layercol-opened"),colwidth:t("#layercol-colwidth"),order:t("#layercol-order")},e.editor.generator.registerField(t("#col-linklayerlink-1")),e.editor.generator.registerField(this.forms.component.col.bgimage),this.forms.component.group={parallax:t("#layergroup-parallax"),desktopPortrait:t("#layergroup-show-desktop-portrait"),desktopLandscape:t("#layergroup-show-desktop-landscape"),tabletPortrait:t("#layergroup-show-tablet-portrait"),tabletLandscape:t("#layergroup-show-tablet-landscape"),mobilePortrait:t("#layergroup-show-mobile-portrait"),mobileLandscape:t("#layergroup-show-mobile-landscape"),fontsize:t("#layergroup-font-size"),adaptivefont:t("#layergroup-adaptive-font"),generatorvisible:t("#layergroup-generator-visible")}}return i.prototype.changeActiveComponent=function(e,i,n,s){if(this.currentLayer=e,this.componentType!=i){t("html").attr("data-component",i);var o=t("#n2-tabbed-slide-editor-settings").data("pane");switch(i){case"content":o.showTabs(["content","animations","position"]);break;case"layer":o.showTabs(["item","style","animations","position"]);break;case"group":o.showTabs(["group","animations"]);break;case"row":o.showTabs(["row","animations","position"]);break;case"col":o.showTabs(["column","animations","position"])}this.componentType=i}this.changeActiveComponentPlacement(n),this.syncFields(s)},i.prototype.changeActiveComponentPlacement=function(e,i){this.placementType!=e&&(t("html").attr("data-placement",e),this.placementType=e),this.syncFields(i)},i.prototype.syncFields=function(i){if("object"==typeof i){this.currentForm=t.extend({},this.forms.global,this.forms.component[this.componentType],this.forms.placement[this.placementType]);for(var n in i)typeof i[n]!==e?this.updateField(n,i[n]):console.error("Value is undefined for: "+n);this.currentLayer.onSyncFields();for(var s in this.currentForm)this.currentForm[s].off(".layeroptions").on("outsideChange.layeroptions",t.proxy(this.activeComponentPropertyChanged,this,s))}},i.prototype.onUpdateField=function(t,e,i){t.target==this.currentLayer&&this.updateField(e,i)},i.prototype.updateField=function(t,i){if("function"==typeof this.currentLayer["formSet"+t])this.currentLayer["formSet"+t](this,i);else if(this.currentForm[t]!==e){var n=this.currentForm[t].data("field");n!==e&&n.insideChange(i)}},i.prototype.activeComponentPropertyChanged=function(t,e){if(this.currentLayer&&!this.currentLayer.isDeleted)this.updateLayerProperty(t);else{var i=this.currentForm[t].data("field");"undefined"!=typeof i&&null!==i&&i.insideChange("")}},i.prototype.updateLayerProperty=function(t){var e=this.currentForm[t].val();this.currentLayer.setProperty(t,e,"manager")},i.prototype.startFeatures=function(){this.layerFeatures=new N2Classes.LayerFeatures(this.forms.placement.absolute,this.fragmentEditor);var e=t("#n2-ss-layer-adaptive-font").on("click",t.proxy(function(){this.currentForm.adaptivefont.data("field").onoff.trigger("click")},this));this.forms.global.adaptivefont.on("nextendChange",t.proxy(function(){1==this.currentForm.adaptivefont.val()?e.addClass("n2-active"):e.removeClass("n2-active")},this)),this.forms.component.group.adaptivefont.on("nextendChange",t.proxy(function(){1==this.currentForm.adaptivefont.val()?e.addClass("n2-active"):e.removeClass("n2-active")},this)),new N2Classes.FormElementNumber("n2-ss-layer-font-size",-Number.MAX_VALUE,Number.MAX_VALUE),new N2Classes.FormElementNumberSlider("n2-ss-layer-font-size",{min:50,max:300,step:5});var i=t("#n2-ss-layer-font-size").on("outsideChange",t.proxy(function(){var t=parseInt(i.val());this.currentForm.fontsize.val(t).trigger("change")},this));this.forms.global.fontsize.on("nextendChange",t.proxy(function(){i.data("field").insideChange(this.forms.global.fontsize.val())},this)),this.forms.component.group.fontsize.on("nextendChange",t.proxy(function(){i.data("field").insideChange(this.currentForm.fontsize.val())},this))},i.prototype.resetStyleMode=function(t,e){this.currentLayer.resetStyleMode(t)},i}),N2D("BgAnimationEditor",["NextendFragmentEditorController"],function(t,e){function i(){this.parameters={shiftedBackgroundAnimation:0},this.$css=t("<style></style>").appendTo("head"),this.backgroundAnimations={color:"eeeeeeff"},N2Classes.NextendFragmentEditorController.prototype.constructor.call(this,!1),this.bgAnimationElement=t(".n2-bg-animation"),this.slides=t(".n2-bg-animation-slide"),this.bgImages=t(".n2-bg-animation-slide-bg"),NextendTween.set(this.bgImages,{rotationZ:1e-4}),this.directionTab=new N2Classes.FormElementRadio("n2-background-animation-preview-tabs",["0","1"]),this.directionTab.element.on("nextendChange.n2-editor",t.proxy(this.directionTabChanged,this)),nModernizr.csstransforms3d&&nModernizr.csstransformspreserve3d||N2Classes.Notification.error("Background animations are not available in your browser. It works if the <i>transform-style: preserve-3d</i> feature available. "),this.$colorField=t("#n2-background-animationcolor").on("nextendChange",t.proxy(this.changeColor,this))}return i.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="backgroundanimation",this.current=0,this.animationProperties=!1,this.direction=0},i.prototype.get=function(){return null},i.prototype.load=function(t,e,i,n){this.lightbox.addClass("n2-editor-loaded")},i.prototype.setTabs=function(t){},i.prototype.directionTabChanged=function(){this.direction=parseInt(this.directionTab.element.val())},i.prototype.start=function(i){i.color!==e?(this.$colorField.data("field").insideChange(i.color),this.backgroundAnimations.color=i.color):(t("#n2-tab-background-animation-form").remove(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+nextend.currentEditor.frontend.parameters.bgAnimationsColor+";}")),this.animationProperties&&(this.timeline?this.timeline.play():this.next())},i.prototype.changeColor=function(){this.backgroundAnimations.color=this.$colorField.val(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+N2Color.hex2rgbaCSS(this.backgroundAnimations.color)+";}")},i.prototype.pause=function(){this.timeline&&this.timeline.pause()},i.prototype.next=function(){this.timeline=new NextendTimeline({paused:!0,onComplete:t.proxy(this.ended,this)});var e=this.bgImages.eq(this.current),i=this.bgImages.eq(1-this.current);nModernizr.csstransforms3d&&nModernizr.csstransformspreserve3d?(this.currentAnimation=new N2Classes["SmartSliderBackgroundAnimation"+this.animationProperties.type](this,e,i,this.animationProperties,1,this.direction),this.slides.eq(this.current).css("zIndex",2),this.slides.eq(1-this.current).css("zIndex",3),this.timeline.to(this.slides.eq(this.current),.5,{opacity:0},this.currentAnimation.getExtraDelay()),this.timeline.to(this.slides.eq(1-this.current),.5,{opacity:1},this.currentAnimation.getExtraDelay()),this.currentAnimation.postSetup()):(this.timeline.to(this.slides.eq(this.current),1.5,{opacity:0},0),this.timeline.to(this.slides.eq(1-this.current),1.5,{opacity:1},0)),this.current=1-this.current,this.timeline.play()},i.prototype.ended=function(){this.currentAnimation&&this.currentAnimation.ended(),this.next()},i.prototype.setAnimationProperties=function(t){var e=this.animationProperties;this.animationProperties=t,e||this.next()},i}),N2D("BgAnimationManager",["NextendVisualManagerMultipleSelection"],function(t,e){function i(){this.type="backgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="backgroundanimation",this.labels={visual:"Background animation",visuals:"Background animations"}},i.prototype.initController=function(){return new N2Classes.BgAnimationEditor},i.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},i.prototype.show=function(e,i){var n={},s=t("#sliderbackground-animation-color");s.length&&(n.color=s.val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,e,i,n)},i.prototype.getAsString=function(){var e=t("#sliderbackground-animation-color");return e.length&&e.val(t("#n2-background-animationcolor").val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},i}),N2D("PostBgAnimationEditor",["NextendFragmentEditorController"],function(t,e){function i(){N2Classes.NextendFragmentEditorController.prototype.constructor.call(this,!1),this.bgAnimationElement=t(".n2-postbg-animation-slider").on("click",t.proxy(this.clickFocusPoint,this)),this.bgImage=this.bgAnimationElement.find(".n2-postbg-animation-slide"),nModernizr.csstransforms3d||N2Classes.Notification.error("Background animations are not available in your browser. It works if the <i>3D transform</i> feature available. "),this.transformOriginField=t("#n2-post-backgroundtransformorigin").on("nextendChange",t.proxy(this.changeFocus,this))}return i.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="postbackgroundanimation",this.tween=null,this.animationProperties=!1,this.transformOrigin="50||50"},i.prototype.clickFocusPoint=function(t){var e=this.bgAnimationElement.offset(),i=Math.round((t.pageX-e.left)/this.bgAnimationElement.width()*100),n=Math.round((t.pageY-e.top)/this.bgAnimationElement.height()*100);this.transformOriginField.data("field").insideChange(i+"|*|"+n)},i.prototype.changeFocus=function(){this.transformOrigin=this.transformOriginField.val(),this.animationProperties&&this.setAnimationProperties(this.animationProperties)},i.prototype.setImage=function(){if(nextend.currentEditor!==e){var t=nextend.currentEditor.frontend;if(t!==e){this.bgImage.html(""),t.currentSlide.background.elements.image?t.currentSlide.background.elements.image.$background.clone().appendTo(this.bgImage):console.error("Background image missing");var i=this.bgAnimationElement.parent().width()-40,n=t.dimensions.width,s=t.dimensions.height;n>i&&(s=s*i/n,n=i),this.bgAnimationElement.css({width:n,height:s})}}},i.prototype.get=function(){return null},i.prototype.load=function(t,e,i,n){this.lightbox.addClass("n2-editor-loaded")},i.prototype.setTabs=function(t){},i.prototype.start=function(t){this.setImage(),this.transformOriginField.data("field").insideChange(t[0]+"|*|"+t[1])},i.prototype.pause=function(){this.tween&&this.tween.pause()},i.prototype.next=function(){var i=t.extend(!0,{},this.animationProperties);i.from.transformOrigin===e&&NextendTween.set(this.bgImage,{transformOrigin:this.transformOrigin.split("|*|").join("% ")+"%"}),i.to.delay=.5,i.to.onComplete=t.proxy(this.next,this),this.tween=NextendTween.fromTo(this.bgImage,i.duration,i.from,i.to)},i.prototype.setAnimationProperties=function(t){this.animationProperties=t,this.pause(),NextendTween.set(this.bgImage,{scale:1,x:0,y:0,rotationZ:1e-4,transformOrigin:"50% 50%"}),this.next()},i}),N2D("PostBgAnimationManager",["NextendVisualManagerMultipleSelection"],function(t,e){function i(){this.type="postbackgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="postbackgroundanimation",this.labels={visual:"Ken Burns effect",visuals:"Ken Burns effects"}},i.prototype.initController=function(){return new N2Classes.PostBgAnimationEditor},i.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},i.prototype.show=function(t,e){var i=[];""!==t&&(t=t.split("|*|"),i[0]=t[0],i[1]=t[1],t=t[2]),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,t,e,i)},i.prototype.getAsString=function(){return this.controller.transformOrigin+"|*|"+N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},i}),N2D("NextendSplitTextAnimation",["NextendVisualWithSetRow"],function(t,e){function i(){N2Classes.NextendVisualWithSetRow.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.NextendVisualWithSetRow.prototype),i.prototype.constructor=i,i.prototype.activate=function(t){"undefined"!=typeof t&&t.preventDefault(),this.visualManager.changeActiveVisual(this),"undefined"!=typeof this.value.transformOrigin&&this.visualManager.controller.loadTransformOrigin(this.value.transformOrigin),this.visualManager.controller.load(this.value.animation,!1,this.visualManager.showParameters)},i}),N2D("NextendSplitTextAnimationEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={mode:{element:t("#n2-splittextanimation-editormode"),events:{"outsideChange.n2-editor":t.proxy(this.changeMode,this)}},sort:{element:t("#n2-splittextanimation-editorsort"),events:{"outsideChange.n2-editor":t.proxy(this.changeSort,this)}},duration:{element:t("#n2-splittextanimation-editorduration"),events:{"outsideChange.n2-editor":t.proxy(this.changeDuration,this)}},stagger:{element:t("#n2-splittextanimation-editorstagger"),events:{"outsideChange.n2-editor":t.proxy(this.changeStagger,this)}},easing:{element:t("#n2-splittextanimation-editoreasing"),events:{"outsideChange.n2-editor":t.proxy(this.changeEasing,this)}},opacity:{element:t("#n2-splittextanimation-editoropacity"),events:{"outsideChange.n2-editor":t.proxy(this.changeOpacity,this)}},offset:{element:t("#n2-splittextanimation-editoroffset"),events:{"outsideChange.n2-editor":t.proxy(this.changeOffset,this)}},rotate:{element:t("#n2-splittextanimation-editorrotate"),events:{"outsideChange.n2-editor":t.proxy(this.changeRotate,this)}},scale:{element:t("#n2-splittextanimation-editorscale"),events:{"outsideChange.n2-editor":t.proxy(this.changeScale,this)}},transformOrigin:{element:t("#n2-splittextanimation-editortransformorigin"),events:{"outsideChange.n2-editor":t.proxy(this.changeTransformOrigin,this)}}}}return i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype),i.prototype.constructor=i,i.prototype.load=function(t){this._off(),this.fields.mode.element.data("field").insideChange(t.mode),t.sort||(t.sort="normal"),this.fields.sort.element.data("field").insideChange(t.sort),this.fields.duration.element.data("field").insideChange(1e3*t.duration),this.fields.stagger.element.data("field").insideChange(1e3*t.stagger),this.fields.easing.element.data("field").insideChange(t.ease),this.fields.opacity.element.data("field").insideChange(100*t.opacity),this.fields.offset.element.data("field").insideChange(t.x+"|*|"+t.y),this.fields.rotate.element.data("field").insideChange(t.rotationX+"|*|"+t.rotationY+"|*|"+t.rotationZ),this.fields.scale.element.data("field").insideChange(100*t.scale),this.fields.transformOrigin.element.data("field").insideChange(nextend.splittextanimationManager.controller.transformOrigin),this._on()},i.prototype.changeMode=function(){this.trigger("mode",this.fields.mode.element.val())},i.prototype.changeSort=function(){this.trigger("sort",this.fields.sort.element.val())},i.prototype.changeDuration=function(){this.trigger("duration",this.fields.duration.element.val()/1e3)},i.prototype.changeStagger=function(){this.trigger("stagger",this.fields.stagger.element.val()/1e3)},i.prototype.changeEasing=function(){this.trigger("ease",this.fields.easing.element.val())},i.prototype.changeOpacity=function(){this.trigger("opacity",this.fields.opacity.element.val()/100)},i.prototype.changeOffset=function(){var t=this.fields.offset.element.val().split("|*|");this.trigger("x",t[0]),this.trigger("y",t[1])},i.prototype.changeRotate=function(){var t=this.fields.rotate.element.val().split("|*|");this.trigger("rotationX",t[0]),this.trigger("rotationY",t[1]),this.trigger("rotationZ",t[2])},i.prototype.changeScale=function(){this.trigger("scale",this.fields.scale.element.val()/100)},i.prototype.changeTransformOrigin=function(){nextend.splittextanimationManager.controller.refreshTransformOrigin(this.fields.transformOrigin.element.val(),!0)},i}),N2D("NextendSplitTextAnimationEditorController",["NextendFragmentEditorControllerWithEditor"],function($,undefined){function NextendSplitTextAnimationEditorController(){this.timeline=new NextendTimeline,N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments),this.preview=$("#n2-splittextanimation-editor-preview").css({fontSize:"16px",margin:"100px 30px"}),this.initBackgroundColor()}return NextendSplitTextAnimationEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype),NextendSplitTextAnimationEditorController.prototype.constructor=NextendSplitTextAnimationEditorController,NextendSplitTextAnimationEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="splittextanimation",this.group="in",this.preview=null,this.playing=!1,this.transformOrigin="0|*|0|*|0",this.mySplitText=null,this.repeatTimeout=null},NextendSplitTextAnimationEditorController.prototype.initRenderer=function(){return new N2Classes.NextendVisualRenderer(this)},NextendSplitTextAnimationEditorController.prototype.initEditor=function(){return new N2Classes.NextendSplitTextAnimationEditor},NextendSplitTextAnimationEditorController.prototype._load=function(t,e,i){this.group=i.group,N2Classes.NextendFragmentEditorControllerWithEditor.prototype._load.call(this,$.extend(!0,{},this.getEmptyVisual(),t),e,i),this.render(i.previewHTML)},NextendSplitTextAnimationEditorController.prototype.propertyChanged=function(t,e,i){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.propertyChanged.call(this,t,e,i),this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.get=function(t){return"saveAsNew"==t?{transformOrigin:this.transformOrigin,animation:this.currentVisual}:this.currentVisual},NextendSplitTextAnimationEditorController.prototype.getEmptyVisual=function(){return{mode:"chars",sort:"normal",duration:.4,stagger:.05,ease:"easeOutCubic",opacity:1,scale:1,x:0,y:0,rotationX:0,rotationY:0,rotationZ:0}},NextendSplitTextAnimationEditorController.prototype.initBackgroundColor=function(){new N2Classes.FormElementText("n2-splittextanimation-editor-background-color"),new N2Classes.FormElementColor("n2-splittextanimation-editor-background-color",0);var t=this.lightbox.find(".n2-editor-preview-box");$("#n2-splittextanimation-editor-background-color").on("nextendChange",function(){t.css("background","#"+$(this).val())})},NextendSplitTextAnimationEditorController.prototype.render=function(html){var fontClassName=nextend.splittextanimationManager.fontClassName,styleClassName=nextend.splittextanimationManager.styleClassName;html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html),this.visible&&this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.refreshTimeline=function(){this.killPreview();var t=$.extend({},this.currentVisual),e=t.mode;"chars"==e&&(e+=",words"),this.mySplitText=new NextendSplitText(this.preview.find("span"),{type:e});var i=[];switch(t.mode){case"words":i=this.mySplitText.words;break;case"lines":i=this.mySplitText.lines;break;default:i=this.mySplitText.chars}delete t.mode,this.timeline=new NextendTimeline({repeat:-1});var n=t.duration,s=t.stagger;delete t.duration,delete t.stagger,NextendTween.set(i,{transformOrigin:this.transformOrigin.split("|*|").join("% ")+"px"});var o=null;switch(t.sort){case"reversed":i.reverse();break;case"random":var r=function(t,e,i,n){for(i=t.length;i;)e=Math.random()*i--|0,n=t[i],t[i]=t[e],t[e]=n};r(i);break;case"side":case"center":var a=[];for(o=[];i.length>1;)a.push(i.shift()),o.push(i.pop());1==i.length&&a.push(i.shift()),i=a,"center"==t.sort&&(i.reverse(),o.reverse());break;case"sideShifted":case"centerShifted":for(var a=[];i.length>1;)a.push(i.shift()),
a.push(i.pop());1==i.length&&a.push(i.shift()),i=a,"centerShifted"==t.sort&&i.reverse()}if(delete t.sort,"out"==this.group){var l=this.getEmptyVisual();delete l.mode,delete l.sort,delete l.duration,delete l.easing,delete l.stagger,this.timeline.staggerFromTo(i,n,l,t,-s,.3),o&&o.length&&this.timeline.staggerFromTo(o,n,l,t,-s,.3)}else this.timeline.staggerFrom(i,n,t,s,.3),o&&o.length&&this.timeline.staggerFrom(o,n,t,s,.3);this.timeline.eventCallback("onComplete",$.proxy(function(){this.repeatTimeout=setTimeout($.proxy(function(){this.timeline.play(0,!1)},this),500)},this)),this.timeline.play()},NextendSplitTextAnimationEditorController.prototype.killPreview=function(){this.repeatTimeout&&clearTimeout(this.repeatTimeout),this.timeline.pause(),this.mySplitText&&this.mySplitText.revert()},NextendSplitTextAnimationEditorController.prototype.show=function(){this.loadTransformOrigin(nextend.splittextanimationManager.transformOriginElement.val()),N2Classes.NextendFragmentEditorControllerWithEditor.prototype.show.call(this),this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.close=function(){this.killPreview(),N2Classes.NextendFragmentEditorControllerWithEditor.prototype.close.call(this)},NextendSplitTextAnimationEditorController.prototype.loadTransformOrigin=function(t){this.editor.fields.transformOrigin.element.data("field").insideChange(t),this.refreshTransformOrigin(t,!1)},NextendSplitTextAnimationEditorController.prototype.refreshTransformOrigin=function(t,e){this.transformOrigin=t,NextendTween.set(this.preview.parent().get(0),{perspective:"1000px"}),e&&this.refreshTimeline()},NextendSplitTextAnimationEditorController}),N2D("NextendSplitTextAnimationManager",["NextendVisualManagerSetsAndMore"],function(t,e){function i(){N2Classes.NextendVisualManagerSetsAndMore.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.NextendVisualManagerSetsAndMore.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendVisualManagerSetsAndMore.prototype.loadDefaults.apply(this,arguments),this.type="splittextanimation",this.labels={visual:"Split text animation",visuals:"Split text animations"},this.styleClassName="",this.fontClassName=""},i.prototype.initController=function(){return new N2Classes.NextendSplitTextAnimationEditorController},i.prototype.createVisual=function(t,e){return new N2Classes.NextendSplitTextAnimation(t,e,this)},i.prototype.setConnectedStyle=function(e){this.styleClassName=t("#"+e).data("field").renderStyle()},i.prototype.setConnectedFont=function(e){this.fontClassName=t("#"+e).data("field").renderFont()},i.prototype.setVisualAsStatic=function(t){if(null!==this.transformOriginElement){var e=this.transformOriginElement.data("field");e.insideChange(this.controller.transformOrigin),e.triggerOutsideChange()}switch(t.preventDefault(),this.mode){case"static":this.setAndClose(this.getBase64(n2_("Static"))),this.hide(t);break;default:N2Classes.NextendVisualManagerSetsAndMore.prototype.setVisualAsStatic.call(this,t)}},i.prototype.getBase64=function(t){return N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("set")}))},i.prototype.show=function(e,i,n){this.transformOriginElement=n.transformOrigin,N2Classes.NextendVisualManagerSetsAndMore.prototype.show.call(this,e,i,n),""==e&&t.when(this.activeSet._loadVisuals()).done(t.proxy(function(){for(var t in this.activeSet.visuals){this.activeSet.visuals[t].activate();break}},this))},i}),N2D("nUICanvasItem",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUICanvasItem",this.widgetEventPrefix="canvasItem",this.options=t.extend({canvasUIManager:null,layer:!1,$layer:null,distance:2,onCreate:function(){}},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){"function"==typeof this.options.$layer&&(this.options.$layer=this.options.$layer.call(this,this)),this._mouseInit()},i.prototype._mouseCapture=function(t,e){return this.options.canvasUIManager._mouseCapture(this.options,t,e)},i.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.canvasUIManager._mouseStart(this.options,t,e,i)},i.prototype._mouseDrag=function(t){return this.options.canvasUIManager._mouseDrag(this.options,t)},i.prototype._mouseStop=function(t,e){return this.options.canvasUIManager._mouseStop(this.options,t,e)},i.prototype._destroy=function(){return this._mouseDestroy(),this},N2Classes.nUIWidgetBase.register("nUICanvasItem"),i}),N2D("nUICanvas",["nUIWidgetBase"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUICanvas",this.widgetEventPrefix="canvas",this.options=t.extend({mainContainer:null,display:!1},this.options,i),N2Classes.nUIWidgetBase.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.nUIWidgetBase.prototype),i.prototype.constructor=i,i.plugins={},i.prototype._mouseCapture=function(e,i,n){return 0==t(i.target).closest(".nui-resizable-handle, .nui-normal-sizing-handle, .nui-spacing-handle").length},i.prototype._mouseStart=function(e,i,n,s){t("body").addClass("n2-ss-move-layer"),this.dragDeferred=t.Deferred(),this.options.mainContainer.fragmentEditor.layerWindow.hideWithDeferred(this.dragDeferred),this.context={placeholder:t('<div class="n2-ss-layer-placeholder" />'),mouse:{offset:{left:i.pageX,top:i.pageY}},canvas:{offset:this.options.mainContainer.layer.offset(),size:{width:this.options.mainContainer.layer.outerWidth(),height:this.options.mainContainer.layer.outerHeight()}},$layer:e.$layer};var o={position:"absolute",right:"auto",bottom:"auto"};e.layer?(this.startMode=e.layer.placement.getType(),this.context.layer={offset:e.$layer.offset()},this.context.originalIndex=e.layer.getIndex(),"normal"==this.startMode&&(o.width=e.$layer.width(),e.$layer.appendTo(this.options.mainContainer.layer))):(this.startMode="create",this.context.layer={offset:{left:0,top:0}},e.$layer.appendTo("body")),e.$layer.addClass("n2-canvas-item-drag").css(o),this._cacheMargins(e.$layer),this.context.size={width:e.$layer.outerWidth(),height:e.$layer.outerHeight()},this.context.droppables=this.options.mainContainer.getDroppables(e.layer),this._cacheContainers(),this._trigger("start",i,{layer:e.layer,mode:this.startMode}),this._mouseDrag(e,i)},i.prototype._mouseDrag=function(t,e){var i;i="create"==this.startMode?{top:e.pageY-this.context.canvas.offset.top-20,left:e.pageX-this.context.canvas.offset.left-20}:{top:this.context.layer.offset.top-this.context.canvas.offset.top+e.pageY-this.context.mouse.offset.top,left:this.context.layer.offset.left-this.context.canvas.offset.left+e.pageX-this.context.mouse.offset.left};var n=this._findInnerContainer(e);if(n===!1&&"create"!=this.startMode&&(n=this.context.droppables[0]),n)if("normal"==n.placement){"undefined"==typeof n.layers&&(n.layers=this._cacheContainerLayers(n));var s=this._findNormalIndex(e,n);s>0?(this.context.placeholder.css("order",n.layers[s-1].layer.layer.css("order")),this.context.placeholder.insertAfter(n.layers[s-1].layer.layer)):(this.context.placeholder.css("order",0),this.context.placeholder.prependTo(n.$container)),this.context.targetIndex=s}else this.context.placeholder.detach();else this.context.placeholder.detach();this.context.targetContainer=n,this._trigger("drag",e,{layer:t.layer,originalOffset:this.context.layer.offset,position:i,canvasOffset:this.context.canvas.offset,offset:{left:i.left+this.context.canvas.offset.left,top:i.top+this.context.canvas.offset.top}}),"create"==this.startMode&&(i.left+=this.context.canvas.offset.left,i.top+=this.context.canvas.offset.top),t.$layer.css(i),this._displayPosition(e,i)},i.prototype._mouseStop=function(i,n,s){this.context.placeholder.remove();var o=this.context.targetIndex,r=this.context.targetContainer;if(i.$layer.removeClass("n2-canvas-item-drag"),"create"==this.startMode)r&&i.onCreate.call(this,n,i,r,o),i.$layer.detach();else if(r===e&&(r=this.options.mainContainer.layer),"absolute"==this.startMode&&"absolute"==r.placement){var a=parseInt(i.$layer.css("left")),l=parseInt(i.$layer.css("top"));i.$layer.css({position:"",right:"",bottom:""}),i.layer.placement.current.setPosition(a,l)}else if("absolute"==r.placement){var a=parseInt(i.$layer.css("left")),l=parseInt(i.$layer.css("top"));i.$layer.css({position:"",right:"",bottom:""});var d=i.$layer.width(),h=i.$layer.height();i.layer.group.onChildCountChange();for(var p=i.layer;p&&(!p.placement||"absolute"!==p.placement.getType());)p=p.group;N2Classes.History.get().startBatch(),i.layer.changeGroup(this.context.originalIndex,this.options.mainContainer),N2Classes.History.get().addControl("skipForwardUndos"),"layer"==i.layer.type&&i.layer.item&&(i.layer.item.needSize||(h="auto",d++));var c=p?p.getProperty("align"):"center",u=p?p.getProperty("valign"):"middle";i.layer.placement.current._setPosition(c,u,a,l,d,h,!0),N2Classes.History.get().endBatch()}else if("normal"==r.placement)switch(i.$layer.css({position:"relative",width:"",left:"",top:""}),r.layer.type){case"content":case"col":o>0?i.$layer.insertAfter(r.layers[o-1].layer.layer):i.$layer.prependTo(r.$container),i.layer.onCanvasUpdate(this.context.originalIndex,r.layer,o);break;case"row":var y=r.layer.createCol();r.layer.moveCol(y.getIndex(),o),i.$layer.prependTo(y.$content),i.layer.onCanvasUpdate(this.context.originalIndex,y,0)}delete this.context,this.options.display&&this.options.display.hide(),this._trigger("stop",n,{layer:i.layer}),this.dragDeferred.resolve(),t("body").removeClass("n2-ss-move-layer")},i.prototype.cancel=function(t){},i.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.offset=e.$container.offset(),e.size={width:e.$container.outerWidth(),height:e.$container.outerHeight()},e.offset.right=e.offset.left+e.size.width,e.offset.bottom=e.offset.top+e.size.height}},i.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;e>=0;e--){var i=this.context.droppables[e];if(i.offset.left<=t.pageX&&i.offset.right>=t.pageX&&i.offset.top<=t.pageY&&i.offset.bottom>=t.pageY)return i}return!1},i.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),n=0;n<i.length;n++){var s={layer:i[n]};s.offset=s.layer.layer.offset(),s.size={width:s.layer.layer.outerWidth(),height:s.layer.layer.outerHeight()},s.offset.right=s.offset.left+s.size.width/2,s.offset.bottom=s.offset.top+s.size.height/2,e.push(s)}return e},i.prototype._findNormalIndex=function(t,e){var i=-1;switch(e.axis){case"y":for(var n=0;n<e.layers.length;n++){var s=e.layers[n];if(t.pageY<=s.offset.bottom){i=n;break}}break;case"x":for(var n=0;n<e.layers.length;n++){var s=e.layers[n];if(t.pageX<=s.offset.right){i=n;break}}}return-1===i&&(i=e.layers.length),i},i.prototype._displayPosition=function(t,e){this.options.display&&(this.context.targetContainer&&"absolute"==this.context.targetContainer.placement?(this.options.display.hidden&&this.options.display.show(),"create"==this.startMode&&(e.left-=this.context.canvas.offset.left,e.top-=this.context.canvas.offset.top),this.options.display.update(t,e)):this.options.display.hidden&&this.options.display.hide())},i.prototype._trigger=function(t,e,i){return i=i||{},this.callPlugin(t,[e,i]),N2Classes.nUIWidgetBase.prototype._trigger.apply(this,arguments)},i.prototype._cacheMargins=function(t){this.margins={left:parseInt(t.css("marginLeft"),10)||0,top:parseInt(t.css("marginTop"),10)||0,right:parseInt(t.css("marginRight"),10)||0,bottom:parseInt(t.css("marginBottom"),10)||0}},N2Classes.nUIWidgetBase.register("nUICanvas"),N2Classes.nUIWidgetBase.addPlugin(i,"smartguides",{start:function(e,i){var n=t(this).data("nUICanvas"),s=n.options;if("create"!=n.startMode&&(n.gridH=t('<div class="n2-grid n2-grid-h"></div>').appendTo(s.mainContainer.layer),n.gridV=t('<div class="n2-grid n2-grid-v"></div>').appendTo(s.mainContainer.layer),n.elements=[],"function"==typeof s.smartguides)){var o=t(s.smartguides(n.context)).not(n.context.$layer);o&&o.length&&o.each(function(){var e=t(this),i=e.offset();this!=n.element[0]&&n.elements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:Math.round(i.top),left:Math.round(i.left),backgroundColor:""})});var r=s.mainContainer.layer.offset();n.elements.push({width:s.mainContainer.layer.width(),height:s.mainContainer.layer.height(),top:Math.round(r.top),left:Math.round(r.left),backgroundColor:"#ff4aff"})}},stop:function(e,i){var n=t(this).data("nUICanvas");"create"!=n.startMode&&(n.gridH.remove(),n.gridV.remove())},drag:function(e,i){var n=!1,s=!1,o=t(this).data("nUICanvas"),r=o.options,a=r.tolerance,l=r.tolerance;if("create"!=o.startMode&&(o.gridH.css({display:"none"}),o.gridV.css({display:"none"}),o.context.targetContainer&&"absolute"==o.context.targetContainer.placement)){var d=o.elements[o.elements.length-1],h=function(t){o.gridV.css({left:Math.min(t,d.width-1),display:"block"})},p=function(t){o.gridH.css({top:Math.min(t,d.height-1),display:"block"})},c=e.ctrlKey||e.metaKey,u=e.altKey;if(c&&u)return;c?n=!0:u&&(s=!0);var y=i.offset.left,g=y+o.context.size.width,f=i.offset.top,m=f+o.context.size.height,v=(y+g)/2,b=(f+m)/2;if(!n)for(var x=o.elements.length-1;x>=0&&0!=a;x--){var C,w=o.elements[x].left,S=w+o.elements[x].width,k=(w+S)/2,N=!0;(C=Math.abs(w-g))<a?(i.position.left=w-o.context.size.width-o.context.canvas.offset.left-o.margins.left,h(i.position.left+o.context.size.width)):(C=Math.abs(w-y))<a?(i.position.left=w-o.context.canvas.offset.left-o.margins.left,h(i.position.left)):(C=Math.abs(S-y))<a?(i.position.left=S-o.context.canvas.offset.left-o.margins.left,h(i.position.left)):(C=Math.abs(S-g))<a?(i.position.left=S-o.context.size.width-o.context.canvas.offset.left-o.margins.left,h(i.position.left+o.context.size.width)):(C=Math.abs(k-g))<a?(i.position.left=k-o.context.size.width-o.context.canvas.offset.left-o.margins.left,h(i.position.left+o.context.size.width)):(C=Math.abs(k-y))<a?(i.position.left=k-o.context.canvas.offset.left-o.margins.left,h(i.position.left)):(C=Math.abs(k-v))<a?(i.position.left=k-o.context.size.width/2-o.context.canvas.offset.left-o.margins.left,h(i.position.left+o.context.size.width/2)):N=!1,N&&(n=o.elements[x],a=Math.min(C,a))}if(!s)for(var x=o.elements.length-1;x>=0&&0!=l;x--){var C,P=o.elements[x].top,D=P+o.elements[x].height,A=(P+D)/2,T=!0;(C=Math.abs(P-m))<l?(i.position.top=P-o.context.size.height-o.context.canvas.offset.top-o.margins.top,p(i.position.top+o.context.size.height)):(C=Math.abs(P-f))<l?(i.position.top=P-o.context.canvas.offset.top-o.margins.top,p(i.position.top)):(C=Math.abs(D-f))<l?(i.position.top=D-o.context.canvas.offset.top-o.margins.top,p(i.position.top)):(C=Math.abs(D-m))<l?(i.position.top=D-o.context.size.height-o.context.canvas.offset.top-o.margins.top,p(i.position.top+o.context.size.height)):(C=Math.abs(A-m))<l?(i.position.top=A-o.context.size.height-o.context.canvas.offset.top-o.margins.top,p(i.position.top+o.context.size.height)):(C=Math.abs(A-f))<l?(i.position.top=A-o.context.canvas.offset.top-o.margins.top,p(i.position.top)):(C=Math.abs(A-b))<l?(i.position.top=A-o.context.size.height/2-o.context.canvas.offset.top-o.margins.top,p(i.position.top+o.context.size.height/2)):T=!1,T&&(s=o.elements[x],l=Math.min(C,l))}n&&n!==!0&&o.gridV.css("backgroundColor",n.backgroundColor),s&&s!==!0&&o.gridH.css("backgroundColor",s.backgroundColor)}}}),i}),N2D("nUIColumns",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUIColumns",this.widgetEventPrefix="columns",this.options=t.extend({columns:"1",gutter:0,denominators:{1:100,2:100,3:144,4:100,5:100,6:144},drag:null,start:null,stop:null},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){this._setupHandles(),t(window).on("resize",t.proxy(this._resize,this)),this._mouseInit()},i.prototype._destroy=function(){return this._mouseDestroy(),this.element.removeData("uiNextendColumns").off(".columns").find("> .ui-column-width-handle").remove(),this},i.prototype.getDenominator=function(t){return this.options.denominators[t]===e&&(this.options.denominators[t]=15*t),this.options.denominators[t]},i.prototype._setupHandles=function(){var e,i,n=this.options;this.fractions=[];for(var s=n.columns.split("+"),e=0;e<s.length;e++)this.fractions.push(new Fraction(s[e]));this.currentDenominator=this.getDenominator(this.fractions.length);var o=0;for(e=0;e<this.fractions.length-1;e++)i=t("<div class='ui-column-width-handle'>"),o+=100*this.fractions[e].valueOf(),i.data("i",e).data("percent",o).appendTo(this.element).on("mousedown",t.proxy(this._mouseDown,this));this.handles=this.element.find("> .ui-column-width-handle"),this.handles.css({"-ms-user-select":"none","-moz-user-select":"-moz-none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"}),this._resize()},i.prototype._resize=function(){this.paddingLeft=parseInt(this.element.css("paddingLeft")),this.paddingRight=parseInt(this.element.css("paddingRight"));var t=this.element.width();this.outerWidth=t+this.paddingLeft+this.paddingRight,this.innerWidth=t-this.handles.length*this.options.gutter;for(var e=0;e<this.handles.length;e++){var i=this.handles.eq(e).data("percent");this._updateResizer(e,i)}},i.prototype._updateResizer=function(t,e){this.handles.eq(t).css({left:e+"%",marginLeft:-2+this.paddingLeft+(t+.5)*this.options.gutter+(this.innerWidth-this.outerWidth)*e/100})},i.prototype._removeHandles=function(){this.handles.remove()},i.prototype.setOption=function(t,e){switch(N2Classes.nUIWidgetBase.prototype.setOption.apply(this,arguments),t){case"columns":this._removeHandles(),this._setupHandles();break;case"gutter":this._resize()}},i.prototype._mouseCapture=function(t){var e,i,n=!1;for(e=0;e<this.handles.length;e++)i=this.handles[e],i===t.target&&(n=!0);return!this.options.disabled&&n},i.prototype._mouseStart=function(e){var i=t(e.target).data("i"),n=this.element.offset().left+10,s=this.element.width()-20;this.resizeContext={index:i,cLeft:n,containerWidth:s,startX:Math.max(0,Math.min(e.clientX-n,s))},this.currentFractions=[],this.currentPercent=[];for(var o=0;o<this.fractions.length;o++)this.currentFractions.push(this.fractions[o].clone()),this.currentPercent.push(this.fractions[o].valueOf());return this.resizing=!0,t("body").css("cursor","ew-resize"),this.element.addClass("ui-column-width-resizing"),this._trigger("start",e,this.ui()),!0},i.prototype._mouseDrag=function(t){var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.resizeContext.containerWidth)),i=new Fraction(Math.round((e-this.resizeContext.startX)/(this.resizeContext.containerWidth/this.currentDenominator)),this.currentDenominator);i.compare(this.fractions[this.resizeContext.index].clone().mul(-1))<0&&(i=this.fractions[this.resizeContext.index].clone().mul(-1)),i.compare(this.fractions[this.resizeContext.index+1])>0&&(i=this.fractions[this.resizeContext.index+1].clone()),this.currentFractions[this.resizeContext.index]=this.fractions[this.resizeContext.index].add(i),this.currentFractions[this.resizeContext.index+1]=this.fractions[this.resizeContext.index+1].sub(i);var n=0;this.currentPercent=[];for(var s=0;s<this.currentFractions.length;s++){var o=this.currentFractions[s].valueOf();this.currentPercent.push(o),n+=100*o,this._updateResizer(s,n)}this._trigger("colwidth",t,this.ui())},i.prototype._mouseStop=function(e){return this.resizing=!1,t("body").css("cursor","auto"),this._trigger("stop",e,this.ui()),this.fractions=this.currentFractions,nextend.preventMouseUp(),!1},i.prototype.ui=function(){return{element:this.element,originalFractions:this.fractions,currentFractions:this.currentFractions,currentPercent:this.currentPercent,index:this.resizeContext.index}},N2Classes.nUIWidgetBase.register("nUIColumns"),i}),N2D("nUILayerListItem",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUILayerListItem",this.widgetEventPrefix="layerListItem",this.options=t.extend({UIManager:null,layer:!1,$layer:null,distance:2},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){this._mouseInit()},i.prototype._mouseCapture=function(t,e){return this.options.UIManager._mouseCapture(this.options,t,e)},i.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.UIManager._mouseStart(this.options,t,e,i)},i.prototype._mouseDrag=function(t){return this.options.UIManager._mouseDrag(this.options,t)},i.prototype._mouseStop=function(t,e){return this.options.UIManager._mouseStop(this.options,t,e)},i.prototype._destroy=function(){return this._mouseDestroy(),this},N2Classes.nUIWidgetBase.register("nUILayerListItem"),i}),N2D("nUILayerList",["nUIWidgetBase"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUILayerList",this.widgetEventPrefix="layerList",this.options=t.extend({$fixed:null,$scrolled:null},this.options,i),N2Classes.nUIWidgetBase.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIWidgetBase.prototype),i.prototype.constructor=i,i.prototype.create=function(){this.scrollTimeout=null},i.prototype._mouseCapture=function(t,e,i){return!0},i.prototype._mouseStart=function(e,i,n,s){this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight=this.options.$scrolled.height(),this.scrolledScroll=this.options.$scrolled.scrollTop(),this.scrolledMaxHeight=this.options.$scrolled[0].scrollHeight-this.scrolledHeight,t("body").addClass("n2-ss-layer-list-move-layer"),this.context={placeholder:t('<div class="nextend-sortable-placeholder"><div></div></div>'),mouse:{y:i.pageY,topModifier:e.$item.offset().top-i.pageY},$item:e.$item,$clone:e.$item.clone()},this.context.$clone.addClass("n2-ss-ll-dragging").appendTo(this.options.$scrolled.find("> ul")),this.context.droppables=this.options.mainContainer.getLLDroppables(e.layer),this._cacheContainers(),this._trigger("start",i),this._mouseDrag(e,i)},i.prototype._scrollUp=function(){this.scrolledTop>0&&null===this.scrollTimeout&&(this.scrollTimeout=setInterval(t.proxy(function(){this.scrolledScroll-=30,this.options.$scrolled.scrollTop(this.scrolledScroll)},this),100),this.scrolledScroll-=30,this.options.$scrolled.scrollTop(this.scrolledScroll))},i.prototype._scrollDown=function(){null===this.scrollTimeout&&(this.scrollTimeout=setInterval(t.proxy(function(){this.scrolledScroll+=30,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight))},this),100),this.scrolledScroll+=30,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight)))},i.prototype._mouseDrag=function(t,e){this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight>60&&(e.pageY<this.scrolledTop+30?this._scrollUp():e.pageY>this.scrolledTop+this.scrolledHeight-30?this._scrollDown():(clearInterval(this.scrollTimeout),this.scrollTimeout=null)),this.scrolledScroll=this.options.$scrolled.scrollTop();var i=e.pageY-this.scrolledTop+this.scrolledScroll,n=this._findInnerContainer(i);n===!1&&(n=this.context.droppables[0]),"undefined"==typeof n.layers&&(n.layers=this._cacheContainerLayers(n));var s=this._findNormalIndex(i,n);s>0?this.context.placeholder.insertAfter(n.layers[s-1].layer.layerRow):this.context.placeholder.prependTo(n.$container),this.context.targetIndex=s,this.context.targetContainer&&this.context.targetContainer!=n&&this.context.targetContainer.layer.layerRow.removeClass("n2-ss-ll-dragging-parent"),this.context.targetContainer=n,this.context.targetContainer.layer.layerRow.addClass("n2-ss-ll-dragging-parent"),this.context.$clone.css({top:i+this.context.mouse.topModifier})},i.prototype._mouseStop=function(e,i,n){null!==this.scrollTimeout&&(clearInterval(this.scrollTimeout),this.scrollTimeout=null),this.context.placeholder.remove(),this.context.$clone.remove(),this.context.targetContainer.layer.layerRow.removeClass("n2-ss-ll-dragging-parent");var s=this.context.targetIndex,o=this.context.targetContainer,r=e.layer.getIndex(),a=-1;if(0===this.context.targetContainer.layers.length)a=0;else{var l=!1,d=!1;this.context.targetContainer.layers[s]&&(l=this.context.targetContainer.layers[s].layer),this.context.targetContainer.layers[s-1]&&(d=this.context.targetContainer.layers[s-1].layer),l===e.layer||d===e.layer?a=-1:"absolute"===o.layer.container.allowedPlacementMode?l?a=l.getIndex()+1:d&&(a=d.getIndex()):d?a=d.getIndex()+1:l&&(a=l.getIndex())}a>=0&&(a>r&&a--,"col"===e.layer.type?o.layer.moveCol(r,a):(o.layer.container.insertLayerAt(e.layer,a),e.layer.onCanvasUpdate(r,o.layer,a))),delete this.context,this._trigger("stop",i),t("body").removeClass("n2-ss-layer-list-move-layer")},i.prototype.cancel=function(t){},i.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.top=e.$container.offset().top-this.scrolledTop+this.scrolledScroll-15,e.height=e.$container.outerHeight(),e.bottom=e.top+e.height+15}},i.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;e>=0;e--){var i=this.context.droppables[e];if(i.top<=t&&i.bottom>=t)return i}return!1},i.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),n=0;n<i.length;n++){var s={layer:i[n]};s.top=s.layer.layerRow.offset().top-this.scrolledTop+this.scrolledScroll,s.height=s.layer.layerRow.outerHeight(),s.bottom=s.top+s.height/2,s.index=n,e.push(s)}return"absolute"==t.layer.container.allowedPlacementMode&&e.reverse(),e},i.prototype._findNormalIndex=function(t,e){for(var i=0;i<e.layers.length;i++){var n=e.layers[i];if(t<=n.bottom)return i}return e.layers.length},N2Classes.nUIWidgetBase.register("nUILayerList"),i}),N2D("TimelineAnimation",["TimelineAnimationAbstract"],function(t,e){"use strict";function i(e,i,n){this.resizable=!0,this.$=t(this),this.group=n,this.data=t.extend({},N2Classes.TimelineAnimationAbstract.defaults,i),N2Classes.TimelineAnimationAbstract.prototype.constructor.call(this,e,i,n)}return i.prototype=Object.create(N2Classes.TimelineAnimationAbstract.prototype),i.prototype.constructor=i,i.prototype.save=function(t){t!==!1&&(this.data=t,this.$.trigger("animationChanged"))},i.prototype["delete"]=function(t){t&&t.stopPropagation(),this.animations.removeAnimation(this),this.$.trigger("animationDeleted")},i.prototype.getOptimizedData=function(){return nextend.deepDiff.map(t.extend({},this.data),N2Classes.TimelineAnimationAbstract.defaults)},N2Classes.NextendSmartSliderTimelineAnimation=i,i}),N2D("TimelineAnimationAbstract",function(t,e){"use strict";function i(e,i,s){this.animations=e,this.layerAnimationManager=N2Classes.LayerAnimationManager.get(),this.group=s,this.delay=t('<span class="n2-ss-animation-delay n2-h5"></span>'),this.renderDelay(this.data.delay),this.duration=t('<span class="n2-ss-animation-duration n2-h5"></span>'),this.renderDuration(this.data.duration),this.bar=t('<div class="n2-ss-layer-animation n2-ss-layer-animation-'+this.group+'"></div>').css(n2const.rtl.marginLeft,this.layerAnimationManager.durationToOffsetX(this.data.delay)).css({width:this.layerAnimationManager.durationToOffsetX(this.data.duration)}).data("animation",this).append(this.delay).append(this.duration).nUIDraggable({scroll:!0,axis:"x",start:t.proxy(function(e,i){if(1==this.animations.layer.fragmentEditor.selectMode){var s=this.animations.layer;n=t.grep(this.animations.layer.fragmentEditor.selectedLayers,function(t){return t!=s});for(var o=0;o<n.length;o++)n[o].animations.shiftStartMultiSelect()}i.originalPosition[n2const.rtl.marginLeft]=parseInt(i.helper.css(n2const.rtl.marginLeft)),i.originalPosition.delay=this.getDelay()},this),drag:t.proxy(function(t,e){var i;i=n2const.rtl.isRtl?Math.max(0,-1*(e.position.left-e.originalPosition[n2const.rtl.marginLeft])):Math.max(0,e.position.left+e.originalPosition[n2const.rtl.marginLeft]);var s=this.layerAnimationManager.normalizeOffsetX(i);e.position.left=0,e.helper.css(n2const.rtl.marginLeft,s),e.position[n2const.rtl.marginLeft]=s;var o=this.layerAnimationManager.offsetXToDuration(s);if(this.renderDelay(o),n)for(var r=o-e.originalPosition.delay,a=0;a<n.length;a++)n[a].animations.shiftDragMultiSelect(r)},this),stop:t.proxy(this.onBarDragStop,this)}),this.resizable&&this.bar.nUIResizable({handles:"e, w",start:function(t,e){e.originalPosition[n2const.rtl.marginLeft]=parseInt(e.helper.css(n2const.rtl.marginLeft))},resize:t.proxy(function(t,e){var i;n2const.rtl.isRtl?(e.size.width=e.originalSize.width-(e.size.width-e.originalSize.width),i=Math.max(0,-1*(e.position.left-e.originalPosition[n2const.rtl.marginLeft]))):i=Math.max(0,e.position.left+e.originalPosition[n2const.rtl.marginLeft]);var n=this.layerAnimationManager.normalizeOffsetX(i),s=i-n;e.size.width=this.layerAnimationManager.normalizeOffsetX(e.size.width+s),this.renderDuration(this.layerAnimationManager.offsetXToDuration(e.size.width)),e.position.left=0,e.helper.css(n2const.rtl.marginLeft,n),e.position[n2const.rtl.marginLeft]=n,this.renderDelay(this.layerAnimationManager.offsetXToDuration(n))},this),stop:t.proxy(this.onBarResizeStop,this)}),this.bar.on("click",t.proxy(this.click,this)),this.$.on("animationChanged",t.proxy(this.animationChanged,this)).on("animationMoved",t.proxy(this.animationMoved,this)).on("animationDeleted",t.proxy(this.animationDeleted,this))}var n=null;return i.defaults={name:"Animation",duration:.8,delay:0,ease:"easeOutCubic",opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,n2blur:0},i.prototype.getBar=function(){return this.bar},i.prototype.click=function(t){t.stopPropagation(),this.animations.showEdit(t,this.group)},i.prototype.onBarResizeStop=function(t,e){this.animations._startHistory();var i=this.layerAnimationManager.offsetXToDuration(e.position[n2const.rtl.marginLeft]),n=this.layerAnimationManager.offsetXToDuration(e.size.width);this.renderDelay(i),this.renderDuration(n),this.setDelay(i),this.setDuration(n),this.fixTimelineTotalDuration(),this.animations._endHistory()},i.prototype.onBarDragStop=function(t,e){this.animations._startHistory();var i=this.layerAnimationManager.offsetXToDuration(e.position[n2const.rtl.marginLeft]);if(this.renderDelay(i),this.setDelay(i),n)for(var s=i-e.originalPosition.delay,o=0;o<n.length;o++)n[o].animations.shiftEndMultiSelect(s);this.fixTimelineTotalDuration(),this.animations._endHistory()},i.prototype.animationChanged=function(){this.bar.css(n2const.rtl.marginLeft,this.layerAnimationManager.durationToOffsetX(this.data.delay)).css({width:this.layerAnimationManager.durationToOffsetX(this.data.duration)}),this.renderDelay(this.data.delay),this.renderDuration(this.data.duration),this.fixTimelineTotalDuration()},i.prototype.updateDelayUI=function(t){t=Math.max(t,0),this.bar.css(n2const.rtl.marginLeft,this.layerAnimationManager.durationToOffsetX(t)),this.renderDelay(t)},i.prototype.setDelay=function(t){this.data.delay=t,this.animations.layer.updateAnimations()},i.prototype.renderDelay=function(t){.15>t?this.delay.css("display","none"):this.delay.css("display","inline").html(Math.round(t*this.layerAnimationManager.oneSecMs))},i.prototype.getDelay=function(){return this.data.delay},i.prototype.setDuration=function(t){this.data.duration=t,this.animations.layer.updateAnimations()},i.prototype.renderDuration=function(t){this.duration.html(Math.round(t*this.layerAnimationManager.oneSecMs))},i.prototype.animationMoved=function(t,e,i,n,s){this.group!=n&&console.error("Unable to change the animation group");var o=this.animations[this.group];this.bar.detach().removeClass("n2-ss-layer-animation-"+e).addClass("n2-ss-layer-animation-"+n),
"out"==n&&"in"==this.group&&(s+=o.find(".n2-ss-layer-animation-in").length),0==s?this.bar.prependTo(o):this.bar.insertAfter(o.children().eq(s-1)),"in"==this.group&&this.animations.specialZeroInChanged(),this.fixTimelineTotalDuration()},i.prototype.animationDeleted=function(){this.bar.remove(),this.$.off("animationChanged animationMoved animationDeleted")},i.prototype.fixTimelineTotalDuration=function(){this.animations.fixTimelineTotalDuration(this.group)},i}),N2D("TimelineAnimationLoop",function(t,e){"use strict";function i(e,i,n){this.group="loop",this.$=t(this),this.animations=e,this.loopDummy=n,this.data=t.extend({},N2Classes.TimelineAnimationAbstract.defaults,i),this.$.on({animationChanged:t.proxy(this.loopDummy.refresh,this.loopDummy),animationMoved:t.proxy(this.animationMoved,this),animationDeleted:t.proxy(this.loopDummy.remove,this.loopDummy,this)})}return i.prototype.animationMoved=function(t,e,i,n,s){this.loopDummy.animationMoved(i,s)},i.prototype.getOptimizedData=function(){return nextend.deepDiff.map(t.extend({},this.data),N2Classes.TimelineAnimationAbstract.defaults)},i.prototype["delete"]=function(){this.animations.removeAnimation(this),this.loopDummy.remove(),this.$.trigger("animationDeleted")},i.prototype.save=function(t){t!==!1&&(this.data=t,this.$.trigger("animationChanged"))},i}),N2D("TimelineAnimationLoopDummy",["TimelineAnimationAbstract"],function(t,e){"use strict";function i(e){this.resizable=!1,this.group="loop",this.data={duration:0,delay:0},this.loops=[],this.$=t(""),N2Classes.TimelineAnimationAbstract.prototype.constructor.call(this,e,null,"loop")}return i.prototype=Object.create(N2Classes.TimelineAnimationAbstract.prototype),i.prototype.constructor=i,i.prototype.setDelay=function(t){this.animations.data.repeatStartDelay=t},i.prototype.getDelay=function(){return this.animations.data.repeatStartDelay},i.prototype.setDuration=function(t){},i.prototype.add=function(t){this.loops.push(t),this.bar.appendTo(this.animations[this.group]),this.refresh()},i.prototype.remove=function(e){var i=t.inArray(e,this.loops);this.loops.splice(i,1),this.refresh()},i.prototype.refresh=function(){if(0==this.loops.length)return void this.bar.detach();var t=0,e=0,i=this.loops.length;if(1==i){var n=this.loops[0].data;e=360!=n.rotationX&&360!=n.rotationY&&360!=n.rotationZ||1!=n.opacity||0!=n.x||0!=n.y||0!=n.z||1!=n.scaleX||1!=n.scaleY||1!=n.scaleZ||0!=n.skewX||0!=n.n2blur?2*(n.duration+n.delay):n.duration+n.delay}else{t=this.loops[this.loops.length-1].data.duration;for(var s=0;i>s;s++){var o=this.loops[s].data;e+=o.duration+o.delay}}var r=this.animations.data;0!=r.repeatCount&&(e*=r.repeatCount),this.data.duration=e+t,this.data.delay=r.repeatStartDelay,this.animationChanged()},i.prototype.animationMoved=function(t,e){var i=this.loops[t];this.loops.splice(t,1),this.loops.splice(e,0,i),this.refresh()},i.prototype.renderDuration=function(t){var e;e=0==this.animations.data.repeatCount?n2_("LOOP"):Math.round(t*this.layerAnimationManager.oneSecMs),this.duration.html(e)},i}),N2D("LayerAnimationManager",function(t,e){"use strict";function i(e){this.fragmentEditor=e,this.oneSecWidth=200,this.oneSecMs=1e3,this.fps=20,this.pxToFrame=this.oneSecWidth/this.fps,this.element=t("#n2-ss-layers-table"),this.element.on({enterPreviewMode:t.proxy(this.onEnterPreview,this),exitPreviewMode:t.proxy(this.onExitPreview,this)}),this.scrollable=this.element.find(".n2-ss-timeline-content-scrollable"),this.contentContainer=t('<div class="n2-ss-timeline-content-layers-container"></div>').appendTo(this.scrollable),n=this,this.initTimeFrame(),this.initCurrentTimeIndicator(),this.timelineControl=new N2Classes.TimelineControl(this),this.makeScrollable(),this.addContextMenu(),this.layerWindowEditor=new N2Classes.LayerWindowAnimationEditor(this)}var n;return i.get=function(){return n},i.prototype.durationToOffsetX=function(t){return t*this.oneSecWidth},i.prototype.offsetXToDuration=function(t){return t/this.oneSecWidth},i.prototype.normalizeOffsetX=function(t){return Math.round(t/this.pxToFrame)*this.pxToFrame},i.prototype.getActiveLayer=function(){return this.fragmentEditor.mainContainer.getSelectedLayer()},i.prototype.clear=function(t,e){e&&e.preventDefault(),this.getActiveLayer().animations.clear(t)},i.prototype.storeNewAnimation=function(e,i,n){if(n.animations.length>0){var s=this.getActiveLayer().animation;s.setTransformOrigin(e,n.transformOrigin),s.setRepeatable(n.repeatable),"in"==e?(s.setSpecialZero(e,n.specialZero),s.setEvent(e,"PlayEvent",n.playEvent)):"loop"==e?(s.setRepeatCount(e,n.repeatCount),s.setRepeatStartDelay(e,n.repeatStartDelay),s.setEvent(e,"PlayEvent",n.playEvent),s.setEvent(e,"PauseEvent",n.pauseEvent),s.setEvent(e,"StopEvent",n.stopEvent),s.setRepeatSelfOnly(e,n.repeatSelfOnly)):"out"==e&&(s.setEvent(e,"PlayEvent",n.playEvent),s.setInstantOut(n.instantOut));for(var o=0;o<n.animations.length;o++)s.addAnimation(e,n.animations[o]);t(window).triggerHandler("AnimationAdded")}},i.prototype.initTimeFrame=function(){this.timeMarker=this.element.find(".n2-ss-timeline-content-timeframe").on("mousedown",t.proxy(function(e){var i=this.offsetXToDuration(e.pageX-t(e.currentTarget).offset().left-21);this.disablePreviewModeWidthCTI(i)||this.setCTI(i),this.slideCTI.trigger(e),t(document).one("mouseup",t.proxy(function(t){this.timelineControl.unHold(),this.slideCTI.trigger(t)},this))},this)),this._extendTimeFrame(0)},i.prototype.refreshDuration=NextendDeBounce(function(){this._extendTimeFrame(this.getMinimumSlideDuration())},200),i.prototype._extendTimeFrame=function(e){e=Math.floor(e)+1;var i=this.timeMarker.find(".n2-time-marker"),n=i.length;for(10>e&&(e=10),n>e&&(i.slice(e).remove(),n=e);e>=n;n++)t('<div class="n2-time-marker n2-h5">'+n+"s</div>").appendTo(this.timeMarker);this.scrollable.css("width",n*this.oneSecWidth+21),nextend.triggerResize()},i.prototype.getMinimumSlideDuration=function(){this.contentContainer.css("min-width",0);var t=this.offsetXToDuration(this.contentContainer.width());return this.contentContainer.css("min-width","100%"),t},i.prototype.initCurrentTimeIndicator=function(){this.slideCTI=t('<div class="n2-ss-timeline-cti"></div>').append('<div class="n2-ss-timeline-cti-dot"></div>').appendTo(this.scrollable).nUIDraggable({axis:"x",cursor:"ew-resize",start:t.proxy(function(t,e){this.timelineControl.enterPreviewMode(),this.timelineControl.pause(),this.slideDurationPx=this.timelineControl.timeline.totalDuration()*this.oneSecWidth},this),drag:t.proxy(function(t,e){e.position.left=Math.max(e.position.left,-.05*this.oneSecWidth),e.position.left=Math.min(e.position.left,this.slideDurationPx),this.setCTI(this.offsetXToDuration(e.position.left))},this),stop:t.proxy(function(t,e){this.timelineControl.unHold(),this.disablePreviewModeWidthCTI(this.offsetXToDuration(e.position.left)),delete this.slideDurationPx},this)})},i.prototype.disablePreviewModeWidthCTI=function(t){return null==t||0>t?this.timelineControl.exitPreviewMode():!1},i.prototype.setCTI=function(t){this.timelineControl.setPosition(Math.max(0,t)),this.timelineControl.hold()},i.prototype.onEnterPreview=function(){},i.prototype.onExitPreview=function(){this.slideCTI.css(n2const.rtl.left,-10)},i.prototype.makeScrollable=function(){var e=t(".n2-ss-timeline-content");this.tinyscrollbar=e.tinyscrollbar({axis:"x",wheel:!1,wheelLock:!1}).data("plugin_tinyscrollbar"),"function"==typeof e.get(0).move&&(e.get(0).move=null)},i.prototype.appendRow=function(t,e){t.group.isMainGroup?this.contentContainer.append(e):t.group.animations.contentArea.append(e)},i.prototype.addContextMenu=function(){t("#n2-ss-layer-list").nextendContextMenu({selector:".n2-ss-layerlist-row",onShow:t.proxy(function(e,i){e.stopPropagation();var n=t(e.currentTarget).data("layer");n.animations.hasAnimation()&&i.addItem("Copy animation","n2-i-copy",t.proxy(function(){t.jStorage.set("layerAnimationCopied",JSON.stringify(n.animations.getData()))},this));var s=t.jStorage.get("layerAnimationCopied");null!==s&&i.addItem("Paste animation","n2-i-paste",t.proxy(function(){n.animations.loadData(JSON.parse(s))},this))},this)})},i}),N2D("LayerAnimations",function(t,e){"use strict";function i(i){this._loaded=!1,this.active=!1,this.layer=i,this.layerAnimationManager=N2Classes.LayerAnimationManager.get(),this.data=null,this.ins=[],this.loops=[],this.outs=[],i.animations=this,this.sidebar=i.layerRow,this.contentArea=this.content=t('<div class="n2-ss-timeline-content-layers"></div>').on({mouseenter:t.proxy(function(){this.layer.fragmentEditor.highlight(this.layer)},this),mouseleave:t.proxy(function(){this.layer.fragmentEditor.deHighlight(this.layer)},this),click:t.proxy(function(t){this.layer.activate()},this)}),i.container!=e&&(this.contentArea=t('<div class="n2-ss-timeline-content-layers-area"></div>').append(this.contentArea),this.containerArea=t('<div class="n2-ss-timeline-content-layers-container2"></div>').appendTo(this.contentArea)),this.getTargetTimelineContainer().append(this.contentArea),this.layer.layer.on({"n2-ss-activate":t.proxy(function(){this.content.addClass("n2-active")},this),"n2-ss-deactivate":t.proxy(function(){this.content.removeClass("n2-active")},this),opened:t.proxy(function(){this.contentArea.removeClass("n2-ss-group-closed")},this),closed:t.proxy(function(){this.contentArea.addClass("n2-ss-group-closed")},this)}),this.inContainer=t('<div class="n2-ss-animation-in-container"></div>').appendTo(this.content),this["in"]=t('<div class="n2-ss-animation-in-row-1"></div>').appendTo(this.inContainer),this.in2=t('<div class="n2-ss-animation-in-row-2"></div>').appendTo(this.inContainer),this.loopContainer=t('<div class="n2-ss-animation-loop-container"></div>').appendTo(this.content),this.loop=t('<div class="n2-ss-animation-loop-row-1"></div>').appendTo(this.loopContainer),this.loop2=t('<div class="n2-ss-animation-loop-row-2"></div>').appendTo(this.loopContainer),this.outContainer=t('<div class="n2-ss-animation-out-container"></div>').appendTo(this.content),this.out=t('<div class="n2-ss-animation-out-row-1"></div>').appendTo(this.outContainer),this.out2=t('<div class="n2-ss-animation-out-row-2"></div>').appendTo(this.outContainer),t('<div data-n2tip="'+n2_("Add animation")+'" class="n2-ss-animation-action n2-button n2-button-icon n2-button-m n2-button-m-narrow n2-radius-s"><i class="n2-i n2-i-animation"></i></div>').on("click",t.proxy(function(e){i!=this.layer.fragmentEditor.mainContainer.getSelectedLayer()?i.activate(e):i.showEditor(e),t('[data-tab="animations"]').trigger("click")},this)).appendTo(this.layer.layerRow.find(".n2-actions")),t('<div data-n2tip="'+n2_("Remove animations")+'" class="n2-ss-animation-clear-action n2-button n2-button-icon n2-button-m n2-button-m-narrow n2-radius-s"><i class="n2-i n2-i-clearanimation"></i></div>').on("click",t.proxy(function(t){this.layer.animations.clearAll()},this)).appendTo(this.layer.layerRow.find(".n2-actions")),nextend.tooltip.add(this.layer.layerRow),i.$.on({"layerDeleted.animations":t.proxy(this.deleted,this)}),this.extraAnimationBars={"in":{},loop:{},out:{}}}var n={repeatable:0,"in":[],specialZeroIn:0,transformOriginIn:"50|*|50|*|0",inPlayEvent:"",loop:[],repeatCount:0,repeatStartDelay:0,transformOriginLoop:"50|*|50|*|0",loopPlayEvent:"",loopPauseEvent:"",loopStopEvent:"",out:[],transformOriginOut:"50|*|50|*|0",outPlayEvent:"",instantOut:1};return i.prototype.onUpdate=function(){this.layer.updateAnimations();var e=1;(this.ins.length&&!t.isEmptyObject(this.extraAnimationBars["in"])||this.loops.length&&!t.isEmptyObject(this.extraAnimationBars.loop)||this.outs.length&&!t.isEmptyObject(this.extraAnimationBars.out))&&(e=2),this.content.attr("data-rows",e),this.layer.layerTitle.attr("data-rows",e)},i.prototype.deleted=function(){this.contentArea.remove(),this.layer.$.off(".animations")},i.prototype.syncRow=function(t,i){t!==e?this.contentArea.insertBefore(t.animations.contentArea):this.getTargetTimelineContainer().append(this.contentArea)},i.prototype.getTargetTimelineContainer=function(){return this.layer.group.isMainGroup?this.layerAnimationManager.contentContainer:this.layer.group.animations.containerArea},i.prototype.activate=function(){},i.prototype.addExtraAnimation=function(e,i,n,s){s=t.extend({label:"",duration:0,editCallback:null,changeDelayCallback:null,changeDurationCallback:null},s),this.extraAnimationBars[e][i]?this.extraAnimationBars[e][i].css(n2const.rtl.marginLeft,this.layerAnimationManager.durationToOffsetX(n)):(this.extraAnimationBars[e][i]=t('<div class="n2-ss-layer-extra-animation"><span class="n2-ss-animation-duration n2-h5">'+s.label+"</span></div>").css(n2const.rtl.marginLeft,this.layerAnimationManager.durationToOffsetX(n)).appendTo(this[e+"2"]).on("click",t.proxy(function(t){"function"==typeof s.editCallback?(this.layer.activate(),s.editCallback()):this.layer.activate(t)},this)),"function"==typeof s.changeDelayCallback&&this.extraAnimationBars[e][i].nUIDraggable({scroll:!0,axis:"x",start:t.proxy(function(t,e){e.originalPosition[n2const.rtl.marginLeft]=parseInt(e.helper.css(n2const.rtl.marginLeft))},this),drag:t.proxy(function(t,e){var i;i=n2const.rtl.isRtl?Math.max(0,-1*(e.position.left-e.originalPosition[n2const.rtl.marginLeft])):Math.max(0,e.position.left+e.originalPosition[n2const.rtl.marginLeft]);var n=this.layerAnimationManager.normalizeOffsetX(i);e.position.left=0,e.helper.css(n2const.rtl.marginLeft,n),e.position[n2const.rtl.marginLeft]=n},this),stop:t.proxy(function(t,e){this.layer.activate(),s.changeDelayCallback(this.layerAnimationManager.offsetXToDuration(e.position[n2const.rtl.marginLeft]))},this)}),"function"==typeof s.changeDurationCallback&&this.extraAnimationBars[e][i].nUIResizable({handles:"e, w",start:function(t,e){e.originalPosition[n2const.rtl.marginLeft]=parseInt(e.helper.css(n2const.rtl.marginLeft))},resize:t.proxy(function(t,e){var i;n2const.rtl.isRtl?(e.size.width=e.originalSize.width-(e.size.width-e.originalSize.width),i=Math.max(0,-1*(e.position.left-e.originalPosition[n2const.rtl.marginLeft]))):i=Math.max(0,e.position.left+e.originalPosition[n2const.rtl.marginLeft]);var n=this.layerAnimationManager.normalizeOffsetX(i),s=i-n;e.size.width=this.layerAnimationManager.normalizeOffsetX(e.size.width+s),e.position.left=0,e.helper.css(n2const.rtl.marginLeft,n),e.position[n2const.rtl.marginLeft]=n},this),stop:t.proxy(function(t,e){this.layer.activate();var i=this.layerAnimationManager.offsetXToDuration(e.position[n2const.rtl.marginLeft]),n=this.layerAnimationManager.offsetXToDuration(e.size.width);s.changeDelayCallback(i),s.changeDurationCallback(n)},this)})),s.duration>0&&this.extraAnimationBars[e][i].css("width",this.layerAnimationManager.durationToOffsetX(s.duration)),this.onUpdate()},i.prototype.removeExtraAnimation=function(t,e){this.extraAnimationBars[t][e].detach(),delete this.extraAnimationBars[t][e],this.onUpdate()},i.prototype.addAnimation=function(t,e){var i,n;"loop"==t?(this.loopDummy||(this.loopDummy=new N2Classes.TimelineAnimationLoopDummy(this)),n=this.loopDummy.getBar(),i=new N2Classes.TimelineAnimationLoop(this,e,this.loopDummy),this.loopDummy.add(i)):(i=new N2Classes.TimelineAnimation(this,e,t),n=i.getBar()),this[t].append(n),this[t+"s"].push(i),"in"==t&&this.specialZeroInChanged(),this.fixTimelineTotalDuration()},i.prototype.removeAnimation=function(e){var i=e.group,n=t.inArray(e,this[i+"s"]);-1!=n&&this[i+"s"].splice(n,1)},i.prototype.clearAll=function(){this._startHistory(),this._clear("in"),this._clear("loop"),this._clear("out"),this._endHistory(),this.onUpdate()},i.prototype.clear=function(t){this._startHistory(),this._clear(t),this._endHistory(),this.onUpdate()},i.prototype._clear=function(t){for(var e=this[t+"s"];e.length;)e[0]["delete"]()},i.prototype.getCurrentData=function(t){for(var e=[],i=0;i<this[t+"s"].length;i++)e.push(this[t+"s"][i].data);var n={animations:e,transformOrigin:this.data["transformOrigin"+this.ucfirst(t)],repeatable:this.data.repeatable};return"in"==t?(n.specialZero=this.data.specialZeroIn,n.playEvent=this.data.inPlayEvent):"loop"==t?(n.repeatCount=this.data.repeatCount,n.repeatStartDelay=this.data.repeatStartDelay,n.playEvent=this.data.loopPlayEvent,n.pauseEvent=this.data.loopPauseEvent,n.stopEvent=this.data.loopStopEvent):"out"==t&&(n.playEvent=this.data.outPlayEvent,n.instantOut=this.data.instantOut),n},i.prototype.getGroupAnimationData=function(t){for(var e=[],i=0;i<this[t+"s"].length;i++)e.push(this[t+"s"][i].data);var n={animations:e,transformOrigin:this.data["transformOrigin"+this.ucfirst(t)],repeatable:this.data.repeatable};return"in"==t&&(n.specialZero=this.data.specialZeroIn),n},i.prototype.showEdit=function(e,i){var n=this.layer;n!=n.fragmentEditor.mainContainer.getSelectedLayer()?n.activate(e):n.showEditor(e),t('[data-tab="animations"]').trigger("click"),t('[data-tab="animations-'+i+'"]').trigger("click")},i.prototype.edit=function(e,i){var n=nextend.animationManager;n.controller.setPreviewSize(this.layer.layer.width(),this.layer.layer.height()).setGroup(e);var s={repeatable:1},o=this.getGroupAnimationData(e);"in"==e?(s.specialZero=1,s.playEvent=1,o.playEvent=this.data.inPlayEvent,n.changeSetById(1e3),n.setTitle(n2_("In animation"))):"loop"==e?(s.repeat=1,o.repeatCount=this.data.repeatCount,o.repeatStartDelay=this.data.repeatStartDelay,s.playEvent=1,o.playEvent=this.data.loopPlayEvent,s.pauseEvent=1,o.pauseEvent=this.data.loopPauseEvent,s.stopEvent=1,o.stopEvent=this.data.loopStopEvent,s.repeatSelfOnly=1,o.repeatSelfOnly=this.data.loopRepeatSelfOnly,n.changeSetById(1200),n.setTitle(n2_("Loop animation"))):"out"==e&&(s.playEvent=1,s.instantOut=1,o.playEvent=this.data.outPlayEvent,o.instantOut=this.data.instantOut,n.changeSetById(1e3),n.setTitle(n2_("Out animation"))),n.show(s,o,t.proxy(this.storeAnimations,this,e,o),{previewMode:!1,previewHTML:!1}),i>0&&n.controller.tabField.options.eq(i).trigger("click")},i.prototype.storeAnimations=function(e,i,n,s){var o=N2Classes.History.get().addValue(this,this.historyStoreAnimations,[this.layer,e]);o&&o.setValues(t.extend(!0,{},i),t.extend(!0,{},s));for(var r=0,a=this[e+"s"];r<s.animations.length&&r<a.length;r++)a[r].save(s.animations[r]);for(;r<s.animations.length;r++)this.addAnimation(e,s.animations[r]);for(;r<a.length;r++)a[r]["delete"]();this.setTransformOrigin(e,s.transformOrigin),this.setRepeatable(s.repeatable),"in"===e?(this.setSpecialZero(e,s.specialZero),this.setEvent(e,"PlayEvent",s.playEvent)):"loop"===e?(this.setRepeatCount(e,s.repeatCount),this.setRepeatStartDelay(e,s.repeatStartDelay),this.setEvent(e,"PlayEvent",s.playEvent),this.setEvent(e,"PauseEvent",s.pauseEvent),this.setEvent(e,"StopEvent",s.stopEvent),this.setRepeatSelfOnly(e,s.repeatSelfOnly)):"out"===e&&(this.setEvent(e,"PlayEvent",s.playEvent),this.setInstantOut(s.instantOut)),this.onUpdate()},i.prototype.load=function(){if(this._loaded===!1){var e=this.layer.layer.data("animations");this.data={},t.extend(this.data,n);try{"undefined"!=typeof e&&t.extend(this.data,t.parseJSON(N2Classes.Base64.decode(e)))}catch(i){}this._load("in"),this._load("loop"),this._load("out"),this._loaded=!0,this.onUpdate()}},i.prototype._load=function(t){if("undefined"!=typeof this.data[t]){for(var e=0;e<this.data[t].length;e++)this.addAnimation(t,this.data[t][e]);delete this.data[t]}},i.prototype.setAnimations=function(t,e){this._startHistory(),this._clear(t);for(var i=0;i<e.animations.length;i++)this.addAnimation(t,e.animations[i]);for(var n in e)if("animations"!=n){var s=e[n];"transformOrigin"==n&&(n="transformOriginIn"),this.data[n]=s}this._endHistory(),this.onUpdate()},i.prototype.setData=function(t){for(var e in t)"animations"!=e&&(this.data[e]=t[e]);this.onUpdate()},i.prototype.getAnimationsCode=function(){if(this._loaded===!1)return this.layer.layer.data("animations");for(var e=t.extend({},this.data,{"in":[],loop:[],out:[]}),i=0;i<this.ins.length;i++){var s=this.ins[i];e["in"].push(s.getOptimizedData())}for(var i=0;i<this.loops.length;i++){var s=this.loops[i];e.loop.push(s.getOptimizedData())}for(var i=0;i<this.outs.length;i++){var s=this.outs[i];e.out.push(s.getOptimizedData())}var o=nextend.deepDiff.map(e,n);return t.isEmptyObject(o)?"":N2Classes.Base64.encode(JSON.stringify(o))},i.prototype.loadData=function(e){this._startHistory(),this._clear("in"),this._clear("loop"),this._clear("out"),this.data={},t.extend(this.data,n),t.extend(this.data,e),this._load("in"),this._load("loop"),this._load("out"),this._endHistory(),this.onUpdate()},i.prototype.getData=function(){for(var e=t.extend({},this.data,{"in":[],loop:[],out:[]}),i=0;i<this.ins.length;i++){var s=this.ins[i];e["in"].push(s.getOptimizedData())}for(var i=0;i<this.loops.length;i++){var s=this.loops[i];e.loop.push(s.getOptimizedData())}for(var i=0;i<this.outs.length;i++){var s=this.outs[i];e.out.push(s.getOptimizedData())}var o=nextend.deepDiff.map(e,n);return t.isEmptyObject(o)?"":o},i.prototype.setSpecialZero=function(t,e){e=parseInt(e)?1:0,e!=this.data["transformOrigin"+this.ucfirst(t)]&&(this.data.specialZeroIn=e,this.specialZeroInChanged())},i.prototype.setRepeatCount=function(t,e){this.data.repeatCount=e},i.prototype.setRepeatStartDelay=function(t,e){this.data.repeatStartDelay=e},i.prototype.setEvent=function(t,e,i){this.data[t+e]=i},i.prototype.setTransformOrigin=function(t,e){this.data["transformOrigin"+this.ucfirst(t)]=e},i.prototype.setRepeatable=function(t){this.data.repeatable=parseInt(t)?1:0},i.prototype.setRepeatSelfOnly=function(t,e){this.data[t+"RepeatSelfOnly"]=parseInt(e)},i.prototype.setInstantOut=function(t){this.data.instantOut=parseInt(t)?1:0},i.prototype.ucfirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},i.prototype.hasAnimation=function(){return!!(this.ins.length||this.loops.length||this.outs.length)},i.prototype.fixTimelineTotalDuration=function(){this.layerAnimationManager.refreshDuration()},i.prototype.getTotalDuration=function(){var t=this.content.find(".n2-ss-layer-animation:visible:last");if(0==t.length)return 0;var e=parseInt(t.position().left)+parseInt(t.css("marginLeft"))-20;return this.layerAnimationManager.offsetXToDuration(e+t.outerWidth())},i.prototype.specialZeroInChanged=function(){this.isLayerSpecialZeroIn()?this["in"].find(".n2-ss-layer-animation-in").css("display","").last().css("display","none"):(this["in"].find(".n2-ss-layer-animation-in").css("display",""),this.fixTimelineTotalDuration())},i.prototype.isLayerSpecialZeroIn=function(){return this.data.specialZeroIn},i.prototype.shiftStartMultiSelect=function(){this._currentlyShiftedAnimation=this.content.find(".n2-ss-layer-animation").data("animation"),this._currentlyShiftedAnimation?(this._currentlyShiftedAnimationDelay=this._currentlyShiftedAnimation.data.delay,this._startHistory()):this._currentlyShiftedAnimation=!1},i.prototype.shiftDragMultiSelect=function(t){this._currentlyShiftedAnimation&&this._currentlyShiftedAnimation.updateDelayUI(this._currentlyShiftedAnimationDelay+t)},i.prototype.shiftEndMultiSelect=function(t){this._currentlyShiftedAnimation&&(this._currentlyShiftedAnimation.updateDelayUI(this._currentlyShiftedAnimationDelay+t),this._currentlyShiftedAnimation.setDelay(this._currentlyShiftedAnimationDelay+t),this._endHistory(),delete this._currentlyShiftedAnimationDelay),delete this._currentlyShiftedAnimation},i.prototype._startHistory=function(){this._oldData={"in":t.extend(!0,{},this.getCurrentData("in")),loop:t.extend(!0,{},this.getCurrentData("loop")),out:t.extend(!0,{},this.getCurrentData("out"))}},i.prototype.getSelf=function(){return this},i.prototype._endHistory=function(){var e={"in":this.getCurrentData("in"),loop:this.getCurrentData("loop"),out:this.getCurrentData("out")};for(var i in e){var n=N2Classes.History.get().addValue(this,this.historyStoreAnimations,[this.layer,i]);n&&n.setValues(t.extend(!0,{},this._oldData[i]),t.extend(!0,{},e[i]))}this._oldData=null},i.prototype.historyStoreAnimations=function(e,i,n){i.getSelf().animations.storeAnimations(n,null,null,t.extend(!0,{},e))},i}),N2D("LayerWindowAnimationEditor",function(t,e){"use strict";function i(e){this.insideUpdate=!1,this.timeline=null,this.animationManager=e,this.mainTab=t("#n2-tabbed-slide-editor-settings").on("changetab",t.proxy(this.changeMainTab,this)).data("pane"),this.tab=t("#n2-tabbed-animations-tabbed").on("changetab",t.proxy(this.changeTab,this)).data("pane"),this.activeLayer=null,this.activeTimeline=-1,this.animationManager.fragmentEditor.$.on("activeLayerChanged",t.proxy(this.loadDataForLayer,this)),this.$heading=t('<div class="n2-editor-header n2-h2 n2-uc"><span></span><div class="n2-ss-button-container"></div></div>'),this.$headingName=this.$heading.find("span"),this.$headingButtonsLeft=t('<div class="n2-ss-button-container-left"></div>').appendTo(this.$heading),this.playButton=t('<a class="n2-button-single-animation-play n2-button n2-button-icon n2-button-s n2-radius-s n2-h5 n2-uc n2-button-grey n2-button-blue-active" href="#"><i class="n2-i n2-i-play"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.toggleTimeline()},this)).appendTo(this.$headingButtonsLeft),this.$headingButtonsRight=this.$heading.find(".n2-ss-button-container"),t('<a class="n2-button n2-button-icon n2-button-s n2-radius-s n2-button-darker n2-h5 n2-uc" href="#"><i class="n2-i n2-i-delete"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.activeLayer.animations.clear(n[this.tab._active])},this)).appendTo(this.$headingButtonsRight),this.$form=t("#n2-tab-animations-form").detach(),this.form={duration:{input:this.$form.find("#layer-anim-duration"),set:function(t){this.input.val(parseInt(1e3*t))},get:function(){return this.input.val()/1e3}},delay:{input:this.$form.find("#layer-anim-delay"),set:function(t){this.input.val(parseInt(1e3*t))},get:function(){return this.input.val()/1e3}},ease:{input:this.$form.find("#layer-anim-ease"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},opacity:{input:this.$form.find("#layer-anim-opacity"),set:function(t){this.input.val(parseInt(100*t))},get:function(){return this.input.val()/100}},x:{input:this.$form.find("#layer-anim-x"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}},y:{input:this.$form.find("#layer-anim-y"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}},rotationX:{input:this.$form.find("#layer-anim-rotationX"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}},rotationY:{input:this.$form.find("#layer-anim-rotationY"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}},rotationZ:{input:this.$form.find("#layer-anim-rotationZ"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}},scaleX:{input:this.$form.find("#layer-anim-scaleX"),set:function(t){this.input.val(parseInt(100*t))},get:function(){return this.input.val()/100}},scaleY:{input:this.$form.find("#layer-anim-scaleY"),set:function(t){this.input.val(parseInt(100*t))},get:function(){return this.input.val()/100}},n2blur:{input:this.$form.find("#layer-anim-n2blur"),set:function(t){this.input.val(t)},get:function(){return this.input.val()}}};for(var i in this.form)this.form[i].input.on("outsideChange.n2-editor",t.proxy(this.changeInlineField,this,i));this.globalForm={inPlayEvent:{input:t("#layerin-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},outPlayEvent:{input:t("#layerout-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopPlayEvent:{input:t("#layerloop-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopPauseEvent:{input:t("#layerloop-pause-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopStopEvent:{input:t("#layerloop-stop-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}}};var s=function(t,e){this.insideUpdate=!0;var i={};i[t]=this.globalForm[t].get(),this.activeLayer.animations.setData(i),this.insideUpdate=!1};for(var i in this.globalForm)this.globalForm[i].input.on("outsideChange.n2-editor",t.proxy(s,this,i))}var n={0:"in",1:"loop",2:"out"};return i.prototype.changeMainTab=function(){this.loadDataForLayer()},i.prototype.changeTab=function(){this.loadDataForLayer()},i.prototype.loadDataForLayer=function(){var t=!1;if("animations"==this.mainTab.headings.eq(this.mainTab._active).data("tab")){var e=this.animationManager.getActiveLayer();this.activeLayer!=e&&(this.activeLayer=e,t=!0),this.tab._active<3?(t||this.activeTimeline!=this.tab._active)&&this.updateCurrentTab():(t||this.activeTimeline!=this.tab._active)&&this.updateEventsTab()}},i.prototype.updateEventsTab=function(){var t=this.activeLayer.animations;for(var e in t.data)"undefined"!=typeof this.globalForm[e]&&this.globalForm[e].get()!=t.data[e]&&this.globalForm[e].set(t.data[e])},i.prototype.updateCurrentTab=function(){if(this.activeLayer&&!this.insideUpdate){var e=this.tab.contents[this.tab._active],i=n[this.tab._active],s=this.activeLayer.animations,o=s[n[this.tab._active]+"s"];if(this.updateEventsTab(),3!=this.tab._active){this.$heading.detach(),this.$form.detach(),e.empty();var r=t("<div />").appendTo(e);if(o.length>0){if(1==o.length){this.$headingName.html(o[0].data.name),r.append(this.$heading);var a=o[0].data;for(var l in this.form)this.form[l].get()!=a[l]&&this.form[l].set(a[l]);r.append(this.$form),t('<div class="n2-ss-small-more n2-button n2-button-normal n2-button-s n2-button-grey n2-radius-s n2-h5 n2-uc">'+n2_("More")+"</div>").on("click",t.proxy(function(){s.edit(i,0)},this)).appendTo(r)}else this.$headingName.html(n2_("Animation chain")),r.append(this.$heading),t('<div class="n2-button n2-button-normal n2-button-wide n2-button-l n2-button-green n2-radius-s n2-h4 n2-uc">'+n2_("Edit")+"</div>").on("click",t.proxy(function(){s.edit(i,0)},this)).appendTo(r);this._play=t.proxy(function(e,n){this.destroyTimeline(),this.playButton.addClass("n2-active"),t("body").addClass("n2-ss-animation-play-single");var o=this.activeLayer.layer,r=o.data("animatableselector");r&&(o=o.find(r)),this.timeline=new N2Classes.EditorAnimationsTimeline(this,o,i,s.getGroupAnimationData(i))},this),this.$heading.off("singlepreview").on({"mouseleave.singlepreview":t.proxy(this.destroyTimeline,this)})}else{var d=t('<ul class="n2-list"></ul>'),h=1e3;"loop"==i&&(h=1200),t.when(nextend.animationManager.sets[h]._loadVisuals()).done(t.proxy(function(){var e=nextend.animationManager.sets[h].visuals;for(var n in e)var o=t("<li></li>").on({mouseenter:t.proxy(function(e,n){this.destroyTimeline(),t("body").addClass("n2-ss-animation-play-single");var s=this.activeLayer.layer,o=s.data("animatableselector");o&&(s=s.find(o)),this.timeline=new N2Classes.EditorAnimationsTimeline(this,s,i,e.value)},this,e[n]),mouseleave:t.proxy(this.destroyTimeline,this)}).append(t('<a href="#">'+e[n].name+"</a>").on({click:t.proxy(function(e,n){n.preventDefault(),this.destroyTimeline(),s.setAnimations(i,t.extend(!0,{},e.value))},this,e[n])})).appendTo(d);d.appendTo(r)},this))}}}},i.prototype.toggleTimeline=function(){this.timeline?this.destroyTimeline():this._play()},i.prototype._play=function(){},i.prototype.destroyTimeline=function(){this.timeline&&(t("body").removeClass("n2-ss-animation-play-single"),this.timeline.destroy()),this.timeline=null,this.playButton.removeClass("n2-active")},i.prototype.update=function(t){t==this.activeLayer&&this.updateCurrentTab()},i.prototype.changeInlineField=function(e,i){this.insideUpdate=!0;var s=n[this.tab._active],o=this.activeLayer.animations,r=t.extend(!0,{},o.getGroupAnimationData(s));r.animations[0][e]=this.form[e].get(),o.setAnimations(s,t.extend(!0,{},r)),this.insideUpdate=!1,this.destroyTimeline(),t("body").addClass("n2-ss-animation-play-single");var a=this.activeLayer.layer,l=a.data("animatableselector");l&&(a=a.find(l)),this.timeline=new N2Classes.EditorAnimationsTimeline(this,a,s,r,!0)},i}),N2D("EditorAnimationsTimeline",function(t,e){"use strict";function i(t,e,i,n,s){
this.parent=t,this.playOnce=s||!1,this.timeline=null,this.preview=e,this.group=i,this.currentVisual=n.animations,this.transformOrigin=n.transformOrigin||"0|*|0|*|0",this.specialZero=n.specialZero||0,this.horizontalRatio=t.animationManager.fragmentEditor.getResponsiveRatioHorizontal(),this.verticalRatio=t.animationManager.fragmentEditor.getResponsiveRatioVertical(),this.createTimeline()}var n={opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,n2blur:0};return i.prototype.createTimeline=function(){this.timeline&&this.timeline.pause(0),this.timeline=new NextendTimeline({paused:1}),this.timeline.eventCallback("onComplete",t.proxy(function(){this.playOnce?this.parent.destroyTimeline():this.timeline.play(0,!1)},this)),this.timeline.set(this.preview.get(0),{transformOrigin:this.transformOrigin.split("|*|").join("% ")+"px"},0);var e=[];t.extend(!0,e,this.currentVisual);for(var i=0;i<e.length;i++)e[i]=t.extend({name:"Animation",duration:.8,delay:0,ease:"easeOutCubic",opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,n2blur:0},e[i]),e[i].delay>.5&&(e[i].delay=.5);switch(this.group){case"in":this.buildTimelineIn(this.timeline,this.preview.get(0),e,this.horizontalRatio,this.verticalRatio);break;case"loop":this.buildTimelineLoop(this.timeline,this.preview.get(0),e,this.horizontalRatio,this.verticalRatio);break;case"out":this.buildTimelineOut(this.timeline,this.preview.get(0),e,this.horizontalRatio,this.verticalRatio);break;default:console.log(this.group+" animation is not supported!")}this.timeline.totalDuration()>0&&this.timeline.play()},i.prototype.destroy=function(){this.timeline&&(this.timeline.pause(),this.repeatTimeout&&clearTimeout(this.repeatTimeout),this.timeline.progress(1,!0),NextendTween.set(this.preview.get(0),{opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,scaleZ:1,skewX:0,n2blur:0})),this.timeline=null},i.prototype.setCurrentZero=function(e){NextendTween.set(e,t.extend({},this.currentZero))},i.prototype.buildTimelineIn=function(t,e,i,s,o){this.currentZero=n,"in"==this.group&&("solo"!=this.currentPreviewMode||this.currentTabIndex==this.currentVisual.length-1)&&this.specialZero&&i.length>0&&(this.currentZero=i.pop(),delete this.currentZero.name,this.currentZero.x=this.currentZero.x*s,this.currentZero.y=this.currentZero.y*o,this.currentZero.rotationX=-this.currentZero.rotationX,this.currentZero.rotationY=-this.currentZero.rotationY,this.currentZero.rotationZ=-this.currentZero.rotationZ,this.setCurrentZero(e));var r=0,a=this._buildAnimationChainIn(i,s,o,this.currentZero),l=0;if(a.length>0)for(t.fromTo(e,a[l].duration,a[l].from,a[l].to,r),r+=a[l].duration+a[l].to.delay,l++;l<a.length;l++)t.to(e,a[l].duration,a[l].to,r),r+=a[l].duration+a[l].to.delay},i.prototype._buildAnimationChainIn=function(e,i,n,s){for(var o=[{from:s}],r=e.length-1;r>=0;r--){var a=e[r],l=a.delay,d=a.duration,h=a.ease;delete a.delay,delete a.duration,delete a.ease,delete a.name;var p=o[0].from;a.x=-a.x*i,a.y=-a.y*n,a.rotationX=-a.rotationX,a.rotationY=-a.rotationY,a.rotationZ=-a.rotationZ,o.unshift({duration:d,from:a,to:t.extend({},p,{ease:h,delay:l})})}return o.pop(),o},i.prototype.buildTimelineLoop=function(t,e,i,n,s){var o=this._buildAnimationChainLoop(i,n,s),r=0;if(o.length>0)for(t.fromTo(e,o[r].duration,o[r].from,o[r].to),r++;r<o.length;r++)t.to(e,o[r].duration,o[r].to)},i.prototype._buildAnimationChainLoop=function(e,i,s){if(delete e[0].name,1==e.length){var o=e[0],r=t.extend({},n);if(r.duration=o.duration,r.ease=o.ease,(360==o.rotationX||360==o.rotationY||360==o.rotationZ)&&1==o.opacity&&0==o.x&&0==o.y&&0==o.z&&1==o.scaleX&&1==o.scaleY&&1==o.scaleZ&&0==o.skewX&&0==o.n2blur)return[{duration:e[0].duration,from:t.extend({},n),to:e[0]}];e.unshift(r)}var a=0,l=[{duration:e[a].duration,to:e[a]}];for(a++;a<e.length;a++){var r=e[a],d=r.duration;delete r.duration,delete r.name;var h=t.extend({},l[l.length-1].to);delete h.delay,delete h.ease,r.x=r.x*i,r.y=r.y*s,l.push({duration:d,from:h,to:r})}return l.push({duration:l[0].duration,from:t.extend({},l[l.length-1].to),to:t.extend({},l[0].to)}),l.shift(),l},i.prototype.buildTimelineOut=function(t,e,i,n,s){var o=0,r=this._buildAnimationChainOut(i,n,s),a=0;if(r.length>0)for(t.fromTo(e,r[a].duration,r[a].from,r[a].to,o),o+=r[a].duration+r[a].to.delay,a++;a<r.length;a++)t.to(e,r[a].duration,r[a].to,o),o+=r[a].duration+r[a].to.delay},i.prototype._buildAnimationChainOut=function(e,i,s){for(var o=[{to:n}],r=0;r<e.length;r++){var a=e[r],l=a.duration;delete a.duration,delete a.name;var d=t.extend({},o[o.length-1].to);delete d.delay,delete d.ease,a.x=a.x*i,a.y=a.y*s,o.push({duration:l,from:d,to:a})}return o.shift(),o},i}),N2D("TimelineControl",function(t,e){"use strict";function i(e){this.timelineVisible=!0,this.status=0,this.layerAnimationManager=e,this.fragmentEditor=e.fragmentEditor,this.$overlay=t('<div style="position: fixed; width:100%; height:100%;left:0;top:0;z-index:9999;display:none;"></div>').on("click",t.proxy(function(t){this.exitPreviewMode()},this)).appendTo("body"),this.$playButton=t(".n2-play").on({mousedown:t.proxy(this.onPlayButton,this),click:function(t){t.preventDefault()}}),t(window).on("keydown",t.proxy(function(t){"INPUT"!=t.target.tagName&&"TEXTAREA"!=t.target.tagName&&(0==t.keyCode||32==t.keyCode?this.onPlayButton(t):27==t.keyCode&&this.onStopButton(t))},this)),t(".n2-ss-timeline-content-layers-container, .n2-ss-timeline-duration-marker, .n2-ss-layer-list-opener").on("mousedown",t.proxy(this.exitPreviewMode,this,!1))}var n={DISABLED:0,PAUSED:1,HOLD_PAUSED:2,PLAYING:3,HOLD_PLAYING:4};return i.prototype.isActivated=function(){return this.status!=n.DISABLED},i.prototype.onStopButton=function(t){t.preventDefault(),t.stopPropagation(),this.status!=n.DISABLED&&this.exitPreviewMode()},i.prototype.onPlayButton=function(t){switch(t.preventDefault(),this.status){case n.DISABLED:this.enterPreviewMode(),this.play();break;case n.PAUSED:this.play();break;case n.PLAYING:this.exitPreviewMode()}},i.prototype.enterPreviewMode=function(){if(this.status==n.DISABLED){this.$overlay.css("display","block"),t("body").addClass("n2-ss-preview-mode"),this.animations=this.fragmentEditor.mainContainer.createLayerAnimations(),this.timeline=new NextendTimeline({paused:1});for(var e=0;e<this.animations.length;e++){var i=this.animations[e];this.timeline.add(i.linearTimeline,0),i.linearTimeline.paused(!1)}this.timeline.eventCallback("onComplete",t.proxy(function(){this.timeline.totalDuration()>0&&this.timeline.restart()},this));var s=this.timeline.totalDuration(),o={};o[n2const.rtl.left]=0;var r={ease:"linear"};r[n2const.rtl.left]=N2Classes.LayerAnimationManager.get().durationToOffsetX(s),this.timeline.fromTo(this.layerAnimationManager.slideCTI,s,o,r,0),this.timeline.pause(0),this.$playButton.addClass("n2-button-blue"),this.layerAnimationManager.element.triggerHandler("enterPreviewMode"),this.status=n.PAUSED}},i.prototype.exitPreviewMode=function(e){if(this.status!=n.DISABLED){e&&(e.preventDefault(),e.stopPropagation()),this.$overlay.css("display","none"),this.status==n.PLAYING&&this.pause();for(var i=0;i<this.animations.length;i++)this.animations[i].setZero();return this.timeline.kill(),t("body").removeClass("n2-ss-preview-mode"),this.$playButton.removeClass("n2-button-blue"),this.layerAnimationManager.element.triggerHandler("exitPreviewMode"),this.status=n.DISABLED,!0}return!1},i.prototype.play=function(){return this.status==n.PAUSED?(this.status=n.PLAYING,this.$playButton.addClass("n2-active"),this.timeline.play(),!0):!1},i.prototype.pause=function(){return this.status==n.PLAYING?(this.status=n.PAUSED,this.$playButton.removeClass("n2-active"),this.timeline.pause(),!0):!1},i.prototype.hold=function(){this.status==n.PAUSED?this.status=n.HOLD_PAUSED:this.status==n.PLAYING&&(this.status=n.HOLD_PLAYING,this.timeline.pause())},i.prototype.unHold=function(){this.status==n.HOLD_PAUSED?this.status=n.PAUSED:this.status==n.HOLD_PLAYING&&(this.status=n.PLAYING,this.timeline.play())},i.prototype.setPosition=function(t){this.enterPreviewMode(),this.timeline.seek(t)},i}),N2D("ItemArea",["Item"],function(t,e){"use strict";function i(){this.type="area",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.parseAll=function(t){""==t.width?t.width="100%":t.width+="px",""==t.height?t.height="100%":t.height+="px",t.colora=N2Color.hex2rgbaCSS(t.color),t.color2a=N2Color.hex2rgbaCSS(t.color2),t.borderWidth=t.borderWidth+"px",t.borderColora=N2Color.hex2rgbaCSS(t.borderColor),t.borderRadius=t.borderRadius+"px"},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(e){var i=t('<div class="n2-ow" style="-webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;'+e.css+'" />').css({width:e.width,height:e.height,backgroundColor:e.colora,border:e.borderWidth+" solid "+e.borderColora,borderRadius:e.borderRadius});switch(e.gradient){case"horizontal":i.css("background","#"+e.color.substr(0,6)).css("background","-moz-linear-gradient(left, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background"," -webkit-linear-gradient(left, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","linear-gradient(to right, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+e.color.substr(0,6)+"', endColorstr='#"+e.color2.substr(0,6)+"',GradientType=1)");break;case"vertical":i.css("background","#"+e.color.substr(0,6)).css("background","-moz-linear-gradient(top, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background"," -webkit-linear-gradient(top, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","linear-gradient(to bottom, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+e.color.substr(0,6)+"', endColorstr='#"+e.color2.substr(0,6)+"',GradientType=0)");break;case"diagonal1":i.css("background","#"+e.color.substr(0,6)).css("background","-moz-linear-gradient(45deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background"," -webkit-linear-gradient(45deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","linear-gradient(45deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+e.color.substr(0,6)+"', endColorstr='#"+e.color2.substr(0,6)+"',GradientType=1)");break;case"diagonal2":i.css("background","#"+e.color.substr(0,6)).css("background","-moz-linear-gradient(-45deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background"," -webkit-linear-gradient(-45deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","linear-gradient(135deg, "+e.colora+" 0%,"+e.color2a+" 100%)").css("background","filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#"+e.color.substr(0,6)+"', endColorstr='#"+e.color2.substr(0,6)+"',GradientType=1)")}this.$item.append(i)},i}),N2D("ItemAudio",["Item"],function(t,e){"use strict";function i(){this.type="audio",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["audio_mp3"],this.generator.registerField("#item_videovideo_mp4")},i.prototype.getName=function(t){return t.audio_mp3},i.prototype._render=function(e){var i="#"+e.color2,n=N2Color.hex2rgbaCSS(e.color2+"33"),s=t('<div class="n2-ss-item-audio-bar n2-ow n2-ow-all" data-state="paused" data-volume="1"></div>');if(parseInt(e.show)){if(s.css("background-color",N2Color.hex2rgbaCSS(e.color)),parseInt(e.fullwidth)||s.css({display:"inline-flex",verticalAlign:"top"}),t('<div class="n2-ss-item-audio-play"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M20 15.99c0 .41-.21.772-.52.967l-6.867 4.87c-.003 0-.006.002-.01.004l-.003.004c-.158.1-.342.156-.54.156-.585 0-1.06-.504-1.06-1.125v-9.752c0-.622.475-1.126 1.06-1.126.198 0 .382.058.54.157l.004.002.01.006 6.865 4.868c.31.196.52.556.52.97z"/></svg></div>').appendTo(s),t('<div class="n2-ss-item-audio-pause"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M17 22V10h4v12h-4zm-6-12h4v12h-4V10z"/></svg></div>').appendTo(s),parseInt(e["show-progress"])){var o=t('<div class="n2-ss-item-audio-progress-container"></div>').appendTo(s),r=t('<div class="n2-ss-item-audio-progress" style="background-color:'+n+';"></div>').appendTo(o);t('<div class="n2-ss-item-audio-progress-playhead" style="width:50%;background-color:'+i+';"></div>').appendTo(r)}if(parseInt(e["show-time"])&&t('<div class="n2-ss-item-audio-time" style="color:'+i+';">01:35 / 03:10</div>').appendTo(s),parseInt(e["show-volume"])){t('<div class="n2-ss-item-audio-unmute"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M15 22h-1l-4-4H9c-.45 0-1-.527-1-1v-3c0-.474.55-1 1-1h1l4-4h1v13z"/></div>').appendTo(s),t('<div class="n2-ss-item-audio-mute"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M15 22h-1l-4-4H9c-.45 0-1-.527-1-1v-3c0-.474.55-1 1-1h1l4-4h1v13zm3.147-1.954l-.06.002c-.215 0-.423-.09-.577-.25l-.11-.116c-.286-.3-.32-.776-.078-1.117.612-.865.935-1.892.935-2.968 0-1.158-.367-2.244-1.06-3.14-.266-.342-.24-.837.055-1.148l.11-.115c.162-.172.38-.265.618-.25.23.012.446.126.592.313.963 1.236 1.472 2.737 1.472 4.34 0 1.49-.45 2.912-1.3 4.106-.143.2-.36.324-.597.342zm3.38 2.65c-.15.183-.363.293-.59.303H20.9c-.215 0-.423-.09-.577-.25l-.107-.114c-.3-.314-.32-.817-.048-1.158 1.32-1.644 2.045-3.733 2.045-5.88 0-2.236-.778-4.387-2.19-6.058-.285-.34-.27-.853.034-1.174l.107-.112c.16-.168.365-.26.603-.252.225.006.438.11.587.287C23.06 10.303 24 12.9 24 15.596c0 2.595-.878 5.116-2.474 7.1z"/></svg></div>').appendTo(s);var a=t('<div class="n2-ss-item-audio-volume-container"></div>').appendTo(s),l=t('<div class="n2-ss-item-audio-volume" style="background-color:'+n+';"></div>').appendTo(a);t('<div class="n2-ss-item-audio-volumehead" style="background-color:'+i+';"></div>').appendTo(l)}}else s.css("color",i).html("Audio layer");this.$item.append(s)},i}),N2D("ItemButton",["Item"],function(t,e){"use strict";function i(){this.type="button",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["content","class"],this.addedFont("link","font"),this.addedStyle("button","style"),this.generator.registerFields(["#item_buttoncontent","#linkitem_buttonlink-1","#item_buttonclass"])},i.prototype.getName=function(t){return t.content},i.prototype.parseAll=function(t){var e=t.link.split("|*|");t.url=e[0],t.target=e[1],delete t.link,t.classes="",parseInt(t.fullwidth)&&(t.classes+=" n2-ss-fullwidth"),parseInt(t.nowrap)&&(t.classes+=" n2-ss-nowrap"),N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype._render=function(e){var i=t('<div class="n2-ss-button-container n2-ow '+e.fontclass+" "+e.classes+'" />'),n=t('<a href="#" onclick="return false;" class="'+e.styleclass+" "+e["class"]+' n2-ow"></a>').appendTo(i),s=t("<span><span>"+e.content+"</span></span>").appendTo(n);if(e.icon){var o=N2Classes.Icons.render(e.icon);if(o){n.attr("data-iconplacement",e.iconplacement);var r=t('<i class="n2i '+o["class"]+'" style="font-size:'+e.iconsize+'%;">'+o.ligature+"</i>");"right"==e.iconplacement?r.css("marginLeft",e.iconspacing/100+"em").appendTo(s):r.css("marginRight",e.iconspacing/100+"em").prependTo(s)}}this.$item.append(i)},i}),N2D("ItemCaption",["Item"],function(t,e){"use strict";function i(){this.type="caption",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["content","description","image"],this.addedFont("paragraph","fonttitle"),this.addedFont("paragraph","font"),this.generator.registerFields(["#item_captionimage","#item_captioncontent","#linkitem_captionlink-1"])},i.prototype.getName=function(t){return t.image.split("/").pop()},i.prototype.parseAll=function(e){e.uid=t.fn.uid();var i=e.link.split("|*|");e.url=i[0],e.target=i[1],delete e.link,e.colora=N2Color.hex2rgbaCSS(e.color),e.colorhex=e.color.substr(0,6);var n=e.animation.split("|*|");e.mode=n[0],e.direction=n[1],e.scale=parseInt(n[2]),N2Classes.Item.prototype.parseAll.apply(this,arguments),e.image!=this.values.image&&"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(e.image),e.image=nextend.imageHelper.fixed(e.image)},i.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},i.prototype._render=function(e){var i=t('<div id="'+e.uid+'" class="n2-ss-item-caption n2-ow"></div>').append(t('<div class="n2-ss-img-wrapper n2-ow"/>').append('<img src="'+e.image+'" class="n2-ow"/>')),n=t('<div class="n2-ss-item-caption-content n2-ow" data-verticalalign="'+e.verticalalign+'"/>').css({background:e.colora}).appendTo(i);e.content&&n.append('<div class="'+e.fonttitleclass+' n2-div-h4 n2-ow">'+e.content+"</div>"),e.description&&n.append('<p class="'+e.fontclass+' n2-ow">'+e.description+"</p>"),this.$item.append(i),new N2Classes.FrontendItemCaption(this.fragmentEditor.editor.frontend,e.uid,e.mode,e.direction,e.scale)},i}),N2D("ItemCirclecounter",["Item"],function(t,e){"use strict";function i(){this.type="circlecounter",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getName=function(t){return"Circle Counter"},i.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_circlecounterlabel")},i.prototype._render=function(e){e.value=parseInt(e.value),e.min=Math.min(0,e.value),e.strokewidth=parseInt(e.strokewidth),e.size=Math.max(parseInt(e.size),e.strokewidth+1),e.startvalue=Math.max(parseInt(e.startvalue),e.min),e.total=Math.max(Math.max(parseInt(e.total),e.startvalue),e.value);var i=(Math.min(e.startvalue,e.total)-e.min)/(e.total-e.min),n=(Math.min(e.value,e.total)-e.min)/(e.total-e.min),s=t('<div class="n2-ss-item-circlecounter-counting-div '+e.fontclass+' n2-ow"></div>'),o=e.size/2,r=(e.size-e.strokewidth)/2,a=Math.PI*r*2,l=(1-i)*a,d='<svg class="svg" viewBox="0 0 '+e.size+" "+e.size+'" version="1.1" preserveAspectRatio="xMinYMin meet">';d+='<circle class="fl-bar-bg" r="'+r+'" cx="'+o+'" cy="'+o+'" stroke="#'+e.color.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(e.color)+'" stroke-width="'+e.strokewidth+'" stroke-dashoffset="0" stroke-dasharray="'+a+'" fill="transparent"></circle>',d+='<circle class="fl-bar" r="'+r+'" cx="'+o+'" cy="'+o+'" stroke="#'+e.color2.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(e.color2)+'" stroke-width="'+e.strokewidth+'" stroke-dasharray="'+a+'" stroke-dashoffset="'+l+'" transform="rotate(-90 '+o+" "+o+')" fill="transparent"></circle>',d+="</svg>";var h=t('<div class="n2-ow n2-ss-item-circlecounter-svg-container">'+d+"</div>").css({width:e.size}),p=t('<div class="n2-ow n2-ss-item-circlecounter-svg-overlay"></div>').appendTo(h);s.appendTo(p);h.find("circle").eq(1);if(this.$item.append(h),e.label){var c=t('<div class="'+e.fontlabelclass+' n2-ow">'+e.label+"</div>");switch(e.labelplacement){case"before":c.insertBefore(h);break;case"innerbefore":c.insertBefore(s);break;case"innerafter":c.insertAfter(s);break;default:c.insertAfter(h)}}e.animationduration>0?new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,h,{name:"circlecounter",c:a,counting:".n2-ss-item-circlecounter-counting-div",display:"circle:eq(1)",displayMode:"circle",delay:e.animationdelay,duration:e.animationduration,fromPercent:i,min:e.min,post:e.post,pre:e.pre,toPercent:n,total:e.total}):this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),this.fragmentEditor.layerAnimationManager.refreshDuration()},i}),N2D("ItemCounter",["Item"],function(t,e){"use strict";function i(){this.type="counter",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getName=function(t){return"Counter"},i.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_counterlabel")},i.prototype._render=function(e){e.value=parseInt(e.value),e.min=Math.min(0,e.value),e.startvalue=Math.max(parseInt(e.startvalue),e.min),e.total=Math.max(Math.max(100,e.startvalue),e.value);var i=(Math.min(e.startvalue,e.total)-e.min)/(e.total-e.min),n=(Math.min(e.value,e.total)-e.min)/(e.total-e.min),s=t('<div><div class="n2-ss-item-counter-counting-div '+e.fontclass+' n2-ow">'+e.pre+100*n+e.post+"</div></div>");if(this.$item.append(s),e.label){var o=t('<div class="'+e.fontlabelclass+' n2-ow">'+e.label+"</div>");switch(e.labelplacement){case"before":o.insertBefore(s);break;default:o.insertAfter(s)}}e.animationduration>0?new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,s,{name:"counter",counting:".n2-ss-item-counter-counting-div",displayMode:!1,delay:e.animationdelay,duration:e.animationduration,fromPercent:i,min:e.min,post:e.post,pre:e.pre,toPercent:n,total:e.total}):this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),this.fragmentEditor.layerAnimationManager.refreshDuration()},i}),N2D("ItemHeading",["Item"],function(t,e){"use strict";function i(){this.type="heading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{link:"#|*|_self",font:"",style:""}},i.prototype.added=function(){this.needFill=["heading","class"],this.addedFont("hover","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_headingheading","#linkitem_headinglink-1","#item_headingclass"])},i.prototype.getName=function(t){return t.heading},i.prototype.parseAll=function(e){e.uid=t.fn.uid();var i=e.link.split("|*|");e.url=i[0],e.target=i[1],delete e.link,parseInt(e.fullwidth)?e.display="block":e.display="inline-block",e.extrastyle=parseInt(e.nowrap)?"white-space: nowrap;":"",e.heading=t("<div>"+e.heading+"</div>").text().replace(/\n/g,"<br />"),"undefined"==typeof e["split-text-animation-in"]&&(e["split-text-animation-in"]="",e["split-text-delay-in"]=0,e["split-text-animation-out"]="",e["split-text-delay-out"]=0,e["split-text-transform-origin"]="50|*|50|*|0",e["split-text-backface-visibility"]=1),e.splitTextIn=e["split-text-animation-in"],e.splitTextDelayIn=e["split-text-delay-in"]/1e3,e.splitTextOut=e["split-text-animation-out"],e.splitTextDelayOut=e["split-text-delay-out"]/1e3,e.splitTextTransformOrigin=e["split-text-transform-origin"].split("|*|").join("% ")+"%",e.splitTextBackfaceVisibility=parseInt(e["split-text-backface-visibility"])?"visible":"hidden",N2Classes.Item.prototype.parseAll.apply(this,arguments),"#"==e.url||""==e.url?(e.afontclass="",e.astyleclass=""):(e.afontclass=e.fontclass,e.fontclass="",e.astyleclass=e.styleclass,e.styleclass="")},i.prototype._render=function(e){var i=t('<div class="n2-ow" />'),n=t('<div id="'+e.uid+'" style="'+e.extrastyle+'"></div>').addClass("n2-ow "+e.fontclass+" "+e.styleclass+" "+e["class"]).css({display:e.display}).appendTo(i);"#"==e.url||""==e.url?n.html(e.heading):n.append(t('<a style="display:'+e.display+';" href="#" class="'+e.afontclass+" "+e.astyleclass+' n2-ow" onclick="return false;">'+e.heading+"</a>")),this.$item.append(i),e.splitTextIn||e.splitTextOut?new N2Classes.HeadingItemSplitTextAdmin(this.fragmentEditor.editor.frontend,e.uid,e.splitTextTransformOrigin,e.splitTextBackfaceVisibility,e.splitTextIn,e.splitTextDelayIn,e.splitTextOut,e.splitTextDelayOut):this.$item.closest(".n2-ss-layer").triggerHandler("deleteSplitText"),this.fragmentEditor.layerAnimationManager.refreshDuration()},i}),N2D("ItemHighlightedHeading",["Item"],function(t,e){"use strict";function i(){this.type="highlightedHeading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.svg={},i.needSize=!1,i.prototype.getDefault=function(){return{font:"",style:"","font-highlight":"","style-highlight":""}},i.prototype.added=function(){this.needFill=["before-text","highlighted-text","after-text"],this.addedFont("highlight","font"),this.addedStyle("highlight","style"),this.generator.registerFields(["#item_highlightedHeadingbefore-text","#item_highlightedHeadinghighlighted-text","#item_highlightedHeadingafter-text","#linkitem_highlightedHeadinglink-1"])},i.prototype.getName=function(t){return t["highlighted-text"]},i.prototype.parseAll=function(e){e.uid=t.fn.uid();var i=e.link.split("|*|");e.url=i[0],e.target=i[1],delete e.link,e.display="inline-block",e.priority=2,e["class"]="",N2Classes.Item.prototype.parseAll.apply(this,arguments),e.afontclass="",e.astyleclass=""},i.prototype._render=function(n){var s=t('<div id="'+n.uid+'" class="n2-ss-highlighted-heading-wrapper  '+n.fontclass+" "+n.styleclass+'" />'),o=n["before-text"],r=n["highlighted-text"],a=n["after-text"],l="";if(""!==o&&(l+='<div class="n2-ss-highlighted-heading-before">'+o+"</div>"),""!==r){var d="";if(i.svg[n.type]!==e){d=i.svg[n.type];var h="div#n2-ss-0 #"+n.uid+" svg path{stroke: #"+n.color.substr(0,6)+";stroke-opacity: "+N2Color.hex2alpha(n.color)+";stroke-width: "+n.width+"px;}";l+="<style>"+h+"</style>"}l+="#"===n.url||""===n.url?"<div ":'<a href="#" ',l+='class="n2-highlighted n2-ss-highlighted-heading-highlighted n2-ow" data-animate="'+n.animate+'" data-delay="'+n.delay+'" data-duration="'+n.duration+'" data-loop="'+n.loop+'" data-loop-delay="'+n["loop-delay"]+'" data-front="'+n.front+'"><div class="n2-ss-highlighted-heading-highlighted-text">'+r+"</div>"+d,l+="#"===n.url||""===n.url?"</div>":"</a>"}""!==a&&(l+='<div class="n2-ss-highlighted-heading-after">'+a+"</div>"),s.html(l),this.$item.append(s),1===+n.animate?new N2Classes.HighlightedHeadingItemAdmin(s.find(".n2-ss-highlighted-heading-highlighted").get(0),this.fragmentEditor.editor.frontend):this.$item.closest(".n2-ss-layer").triggerHandler("deleteHeadingHighlight"),this.fragmentEditor.layerAnimationManager.refreshDuration()},i}),N2D("ItemHtml",["Item"],function(t,e){"use strict";function i(){this.type="html",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["html"],this.generator.registerField("#item_htmlhtml")},i.prototype._render=function(e){var i=t('<div class="n2-notow">').css("text-align",e.textalign).html(e.html);e.css.trim()&&i.append('<style type="text/css">'+e.css+"</style>"),this.$item.append(i)},i}),N2D("ItemIcon",["Item"],function(t,e){"use strict";function i(){this.type="icon",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.addedStyle("box","style")},i.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,t.opacity=N2Color.hex2alpha(t.color),t.color=t.color.substr(0,6);var i=t.icon.replace(/data\-style/g,"style").replace(/\{style\}/g,"fill:#"+t.color+";fill-opacity:"+t.opacity);t.image=N2Classes.Base64.encode(i),N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype._render=function(e){var i=t('<div class="'+e.styleclass+' n2-ow" />').append(t('<img class="n2-ow" src="data:image/svg+xml;base64,'+e.image+'" />').css({display:"inline-block",width:e.width,height:e.height}));this.$item.append(i)},i}),N2D("ItemIcon2",["Item"],function(t,e){"use strict";function i(){this.type="icon2",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.addedStyle("box","style")},i.prototype.parseAll=function(e){e.uid=t.fn.uid();var i=N2Classes.Icons.render(e.icon);i?(e.ligature=i.ligature,e.iconclass=i["class"]):(e.ligature=n2_("Icon not found"),e.iconclass=""),N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype.getName=function(t){return"Icon"},i.prototype._render=function(e){var i=t('<i class="n2i '+e.styleclass+" "+e.uid+" "+e.iconclass+'">'+e.ligature+"</i>").css("fontSize",e.size/16*100+"%"),n=window.nextend.pre+" ."+e.uid+"{color:"+N2Color.hex2rgbaCSS(e.color)+";}";N2Color.hex2alpha(e.colorhover)>0&&(n+=window.nextend.pre+" ."+e.uid+":HOVER{color:"+N2Color.hex2rgbaCSS(e.colorhover)+";}"),i.append("<style>"+n+"</style>"),this.$item.append(i)},i}),N2D("ItemIframe",["Item"],function(t,e){"use strict";function i(){this.type="iframe",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["url"],this.generator.registerField("#item_iframeurl")},i.prototype.getName=function(t){return t.url},i.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype._render=function(e){var i=t('<iframe sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin" src="'+e.url+'" class="n2-ow" width="'+e.width+'" height="'+e.height+'" style="border:0;min-height:50px;"></iframe>');this.$item.append(i)},i}),N2D("ItemImage",["Item"],function(t,e){"use strict";function i(){this.type="image",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{size:"auto|*|auto",link:"#|*|_self",style:""}},i.prototype.added=function(){this.needFill=["image","cssclass"],this.addedStyle("box","style"),this.generator.registerFields(["#item_imageimage","#item_imagealt","#item_imagetitle","#linkitem_imagelink-1","#item_imagecssclass"])},i.prototype.getName=function(t){return t.image.split("/").pop()},i.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size;var i=t.link.split("|*|");t.url=i[0],t.target=i[1],delete t.link,N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image!=this.values.image?(t.image=nextend.imageHelper.fixed(t.image),"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(t.image)):t.image=nextend.imageHelper.fixed(t.image)},i.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},i.prototype._render=function(e){var i=t('<div class="'+e.styleclass+' n2-ss-img-wrapper n2-ow" style="overflow:hidden"></div>'),n=i;"#"!=e.url&&""!=e.url&&(n=t('<a href="#" class="n2-ow" onclick="return false;" style="display: block;background: none !important;"></a>').appendTo(i)),t('<img class="n2-ow '+e.cssclass+'" src="'+e.image+'"/>').css({display:"inline-block",maxWidth:"100%",width:e.width,height:e.height}).appendTo(n),this.$item.append(i)},i}),N2D("ItemImagearea",["Item"],function(t,e){"use strict";function i(){this.type="imagearea",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["image"],this.generator.registerFields(["#item_imageareaimage","#linkitem_imagearealink-1"])},i.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image=nextend.imageHelper.fixed(t.image)},i.prototype.fitLayer=function(){
return!0},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({display:"inline-block",verticalAlign:"top",width:"100%",height:"100%",background:"url("+e.image+") no-repeat",backgroundSize:e.fillmode,backgroundPosition:e.positionx+"% "+e.positiony+"%"});this.$item.append(i)},i}),N2D("ItemImagebox",["Item"],function(t,e){"use strict";function i(){this.type="imagebox",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getName=function(t){return"Image box"},i.prototype.added=function(){this.needFill=["image","heading","description"],this.addedFont("hover","fonttitle"),this.addedFont("paragraph","fontdescription"),this.addedStyle("box","style"),this.generator.registerFields(["#item_imageboximage","#item_imageboximagealt","#item_imageboxheading","#item_imageboxdescription","#linkitem_imageboxlink-1"])},i.prototype._render=function(e){var i=t('<div class="n2-ss-item-imagebox-container n2-ow-all" data-layout="'+e.layout+'" data-csstextalign="'+e.inneralign+'"></div>').addClass(e.styleclass),n=t('<div class="n2-ss-item-imagebox-image n2-ow"></div>').appendTo(i),s=t('<div class="n2-ss-item-imagebox-content n2-ow"></div>').css("padding",e.padding.split("|*|").join("px ")+"px").appendTo(i);if("left"!=e.layout&&"right"!=e.layout||i.attr("data-verticalalign",e.verticalalign),e.icon){var o=N2Classes.Icons.render(e.icon);t('<i class="n2i '+o["class"]+'">'+o.ligature+"</i>").css({fontSize:e.iconsize/16*100+"%",color:N2Color.hex2rgbaCSS(e.iconcolor)}).appendTo(n)}else e.image?("top"==e.layout||"bottom"==e.layout?n.css({width:e.imagewidth+"%"}):n.css({maxWidth:e.imagewidth+"%"}),t('<img src="'+nextend.imageHelper.fixed(e.image)+'" />').appendTo(n)):n.remove();e.heading&&t('<div class="n2-ow '+e.fonttitleclass+'">'+e.heading+"</div>").appendTo(s),e.description&&t('<div class="n2-ow '+e.fontdescriptionclass+'">'+e.description+"</div>").appendTo(s),this.$item.append(i)},i}),N2D("ItemInput",["Item"],function(t,e){"use strict";function i(){this.type="input",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{font:"",style:""}},i.prototype.added=function(){this.needFill=["placeholder","buttonlabel","class"],this.addedStyle("heading","style"),this.addedFont("paragraph","inputfont"),this.addedStyle("heading","inputstyle"),this.addedFont("hover","buttonfont"),this.addedStyle("heading","buttonstyle"),this.generator.registerFields(["#item_inputname","#item_inputplaceholder","#item_inputbuttonlabel","#item_inputaction","#item_inputparameters","#item_inputclass"])},i.prototype.getName=function(t){return t.placeholder},i.prototype._render=function(e){var i=t('<div class="n2-ss-item-input-form '+e.styleclass+" "+e["class"]+' n2-ow"></div>');i.append('<div class="n2-input n2-ow '+e.inputfontclass+" "+e.inputstyleclass+'">'+e.placeholder+"</div>"),""!=e.buttonlabel.trim()&&i.append('<div class="n2-form-button n2-ow '+e.buttonfontclass+" "+e.buttonstyleclass+'">'+e.buttonlabel+"</div>"),this.$item.append(i)},i}),N2D("ItemList",["Item"],function(t,e){"use strict";function i(){this.type="list",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["content"],this.addedFont("list","font"),this.addedStyle("heading","liststyle"),this.addedStyle("heading","itemstyle"),this.generator.registerField("#item_listcontent")},i.prototype.getName=function(t){return t.content},i.prototype._render=function(e){for(var i=t('<ol class="'+e.liststyleclass+" "+e.fontclass+' n2-ow" style="list-style-type: '+e.type+'"></ol>'),n=e.content.split("\n"),s=0;s<n.length;s++)i.append('<li class="'+e.itemstyleclass+'">'+n[s]+"</li>");this.$item.append(i)},i}),N2D("ItemProgressbar",["Item"],function(t,e){"use strict";function i(){this.type="progressbar",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getName=function(t){return"Progress bar"},i.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_progressbarlabel")},i.prototype._render=function(e){e.value=parseInt(e.value),e.min=Math.min(0,e.value),e.startvalue=Math.max(parseInt(e.startvalue),e.min),e.total=Math.max(Math.max(parseInt(e.total),e.startvalue),e.value);var i=(Math.min(e.startvalue,e.total)-e.min)/(e.total-e.min),n=(Math.min(e.value,e.total)-e.min)/(e.total-e.min),s=t('<div class="n2-ow n2-ss-item-progressbar-container"></div>'),o=t('<div class="n2-ow n2-ss-item-progressbar"></div>').css({backgroundColor:N2Color.hex2rgbaCSS(e.color)}).appendTo(s),r=t('<div class="n2-ow n2-ss-item-progressbar-inner"></div>').css({backgroundColor:N2Color.hex2rgbaCSS(e.color2),width:100*i+"%"}).appendTo(o),a=t('<div class="n2-ss-item-progressbar-counting '+e.fontclass+' n2-ow"></div>').appendTo(r);if(e.label){var l=t('<div class="n2-ss-item-progressbar-label n2-ow '+e.fontlabelclass+'">'+e.label+"</div>");switch(e.labelplacement){case"before":l.prependTo(s);break;case"over":l.insertBefore(a);break;default:l.appendTo(s)}}this.$item.append(s),e.animationduration>0?new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,s,{name:"progressbar",counting:".n2-ss-item-progressbar-counting",display:".n2-ss-item-progressbar-inner",displayMode:"width",delay:e.animationdelay,duration:e.animationduration,fromPercent:i,min:e.min,post:e.post,pre:e.pre,toPercent:n,total:e.total}):this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),this.fragmentEditor.layerAnimationManager.refreshDuration()},i}),N2D("ItemText",["Item"],function(t,e){"use strict";function i(){this.type="text",N2Classes.Item.prototype.constructor.apply(this,arguments)}function n(t){var e=!1,i=!1,n="table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary";return t=t.replace(/\r\n|\r/g,"\n")+"\n",-1===t.indexOf("\n")?t:(-1!==t.indexOf("<object")&&(t=t.replace(/<object[\s\S]+?<\/object>/g,function(t){return t.replace(/\n+/g,"")})),t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/g," ")}),-1===t.indexOf("<pre")&&-1===t.indexOf("<script")||(e=!0,t=t.replace(/<(pre|script)[^>]*>[\s\S]*?<\/\1>/g,function(t){return t.replace(/\n/g,"<wp-line-break>")})),-1!==t.indexOf("<figcaption")&&(t=t.replace(/\s*(<figcaption[^>]*>)/g,"$1"),t=t.replace(/<\/figcaption>\s*/g,"</figcaption>")),-1!==t.indexOf("[caption")&&(i=!0,t=t.replace(/\[caption[\s\S]+?\[\/caption\]/g,function(t){return t=t.replace(/<br([^>]*)>/g,"<wp-temp-br$1>"),t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/," ")}),t.replace(/\s*\n\s*/g,"<wp-temp-br />")})),t+="\n\n",t=t.replace(/<br \/>\s*<br \/>/gi,"\n\n"),t=t.replace(new RegExp("(<(?:"+n+")(?: [^>]*)?>)","gi"),"\n\n$1"),t=t.replace(new RegExp("(</(?:"+n+")>)","gi"),"$1\n\n"),t=t.replace(/<hr( [^>]*)?>/gi,"<hr$1>\n\n"),t=t.replace(/\s*<option/gi,"<option"),t=t.replace(/<\/option>\s*/gi,"</option>"),t=t.replace(/\n\s*\n+/g,"\n\n"),t=t.replace(/([\s\S]+?)\n\n/g,"<p>$1</p>\n"),t=t.replace(/<p>\s*?<\/p>/gi,""),t=t.replace(new RegExp("<p>\\s*(</?(?:"+n+")(?: [^>]*)?>)\\s*</p>","gi"),"$1"),t=t.replace(/<p>(<li.+?)<\/p>/gi,"$1"),t=t.replace(/<p>\s*<blockquote([^>]*)>/gi,"<blockquote$1><p>"),t=t.replace(/<\/blockquote>\s*<\/p>/gi,"</p></blockquote>"),t=t.replace(new RegExp("<p>\\s*(</?(?:"+n+")(?: [^>]*)?>)","gi"),"$1"),t=t.replace(new RegExp("(</?(?:"+n+")(?: [^>]*)?>)\\s*</p>","gi"),"$1"),t=t.replace(/(<br[^>]*>)\s*\n/gi,"$1"),t=t.replace(/\s*\n/g,"<br />\n"),t=t.replace(new RegExp("(</?(?:"+n+")[^>]*>)\\s*<br />","gi"),"$1"),t=t.replace(/<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)>)/gi,"$1"),t=t.replace(/(?:<p>|<br ?\/?>)*\s*\[caption([^\[]+)\[\/caption\]\s*(?:<\/p>|<br ?\/?>)*/gi,"[caption$1[/caption]"),t=t.replace(/(<(?:div|th|td|form|fieldset|dd)[^>]*>)(.*?)<\/p>/g,function(t,e,i){return i.match(/<p( [^>]*)?>/)?t:e+"<p>"+i+"</p>"}),e&&(t=t.replace(/<wp-line-break>/g,"\n")),i&&(t=t.replace(/<wp-temp-br([^>]*)>/g,"<br$1>")),t)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{contentmobile:"",contenttablet:"",font:"",style:""}},i.prototype.added=function(){this.needFill=["content","contenttablet","contentmobile"],this.addedFont("paragraph","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_textcontent","#item_textcontenttablet","#item_textcontentmobile"])},i.prototype.getName=function(t){return t.content},i.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.p=n(t.content),t.ptablet=n(t.contenttablet),t.pmobile=n(t.contentmobile)},i.prototype._render=function(e){var i=t('<div class="n2-ss-desktop n2-ow n2-ow-all">'+e.p+"</div>").appendTo(this.$item);""==e.contenttablet?i.addClass("n2-ss-tablet"):i=t('<div class="n2-ss-tablet n2-ow n2-ow-all">'+e.ptablet+"</div>").appendTo(this.$item),""==e.contentmobile?i.addClass("n2-ss-mobile"):t('<div class="n2-ss-mobile n2-ow n2-ow-all">'+e.pmobile+"</div>").appendTo(this.$item),this.$item.find("p").addClass(e.fontclass+" "+e.styleclass)},i}),N2D("ItemTransition",["Item"],function(t,e){"use strict";function i(){this.type="transition",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["image","image2"],this.generator.registerFields(["#item_transitionimage","#item_transitionimage2","#item_transitionalt","#item_transitionalt2","#linkitem_transitionlink-1"])},i.prototype.getName=function(t){return t.image.split("/").pop()},i.prototype.parseAll=function(e){e.uid=t.fn.uid();var i=e.link.split("|*|");e.url=i[0],e.target=i[1],delete e.link,N2Classes.Item.prototype.parseAll.apply(this,arguments);var n=e.image;e.image=nextend.imageHelper.fixed(e.image),e.image2=nextend.imageHelper.fixed(e.image2),n!=this.values.image&&"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(e.image)},i.prototype._render=function(e){var i=t('<div id="'+e.uid+'" class="n2-ss-item-transition n2-ow"></div>'),n=i;""!=e.url&&"#"!=e.url&&(n=t('<a href="#" onclick="return false;" class="n2-ow"></a>').appendTo(i));var s=t('<div class="n2-ss-item-transition-inner n2-ss-img-wrapper n2-ow"></div>').appendTo(n);t('<img src="'+e.image+'" class="n2-ss-item-transition-image1 n2-ow" />').appendTo(s),t('<img src="'+e.image2+'" class="n2-ss-item-transition-image2 n2-ow" />').appendTo(s),this.$item.append(i),new N2Classes.FrontendItemTransition(this.fragmentEditor.editor.frontend,e.uid,e.animation)},i.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},i}),N2D("ItemVideo",["Item"],function(t,e){"use strict";function i(){this.type="video",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["video_mp4"],this.generator.registerField("#item_videovideo_mp4")},i.prototype.getName=function(t){return t.video_mp4},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+nextend.imageHelper.fixed("$system$/images/placeholder/video.png")+") no-repeat 50% 50%",backgroundSize:"cover"});this.$item.append(i)},i}),N2D("ItemVimeo",["Item"],function(t,e){"use strict";function i(){this.type="vimeo",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["vimeourl"],this.generator.registerField("#item_vimeovimeourl")},i.prototype.getName=function(t){return t.vimeourl},i.prototype.parseAll=function(e){var i=this.values.vimeourl!=e.vimeourl;if(N2Classes.Item.prototype.parseAll.apply(this,arguments),""==e.image&&(e.image="$system$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),i&&""!=e.vimeourl){var n=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,s=e.vimeourl.match(n),o=!1;s?o=s[3]:e.vimeourl.match(/^[0-9]+$/)&&(o=e.vimeourl),o?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+encodeURI(o)+".json").done(t.proxy(function(e){t("#item_vimeoimage").val(e[0].thumbnail_large).trigger("change")},this)).fail(function(t){N2Classes.Notification.error(t.responseText)}):N2Classes.Notification.error("The provided URL does not match any known Vimeo url or code!")}},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+e.image+") no-repeat 50% 50%",backgroundSize:"cover"});t('<div class="n2-ss-layer-player n2-ss-layer-player-cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},i.prototype.fitLayer=function(){return!0},i}),N2D("ItemYoutube",["Item"],function(t,e){"use strict";function i(){this.type="youtube",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["youtubeurl","image","start"],this.generator.registerFields(["#item_youtubeyoutubeurl","#item_youtubeimage","#item_youtubestart"])},i.prototype.getName=function(t){return t.youtubeurl},i.prototype.parseAll=function(e){var i=this.values.youtubeurl!==e.youtubeurl;if(N2Classes.Item.prototype.parseAll.apply(this,arguments),""===e.image&&(e.image="$system$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),i){var n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,s=e.youtubeurl.match(n);s?N2Classes.AjaxHelper.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+encodeURI(s[2])+"&part=snippet&key=AIzaSyC3AolfvPAPlJs-2FgyPJdEEKS6nbPHdSM").done(t.proxy(function(e){if(e.items.length){var i=e.items[0].snippet.thumbnails,n=i.maxres||i.standard||i.high||i.medium||i["default"],o=n.url;"{video_url}"==this.values.youtubeurl&&(o=o.replace(s[2],"{video_id}")),t("#item_youtubeimage").val(o).trigger("change")}},this)).fail(function(t){N2Classes.Notification.error(t.error.errors[0].message)}):N2Classes.Notification.error("The provided URL does not match any known YouTube url or code!")}},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+e.image+") no-repeat 50% 50%",backgroundSize:"cover"});parseInt(e.playbutton)&&t('<div class="n2-ss-layer-player n2-ss-layer-player-cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},i}),N2D("smartslider-backend");